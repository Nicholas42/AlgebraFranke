\documentclass[a4paper,parskip=half,numbers=enddot, DIV=12]{scrreprt}
%\usepackage[utf8]{inputenc}

\usepackage{../header}
\usepackage{../frankenumbering}
\usepackage{../shortcuts}

\usepackage{csquotes}
%\usepackage{tikz-cd}%I cannot draw diagrams without it - Felix. %well, I can - Ferdinand
\usepackage[backend=biber,style=alphabetic]{biblatex}
\setcounter{biburlnumpenalty}{7000}
\setcounter{biburllcpenalty}{7000}
\setcounter{biburlucpenalty}{8000}
\addbibresource{../literatur.bib}

% Title Page
\title{Homological Methods in Commutative Algebra}
\author{Ferdinand Wagner}
\date{Sommersemester 2018}

\displaywidowpenalty=8000
%\postdisplaypenalty=8000
\widowpenalty=8000
\clubpenalty=8000

\begin{document}
\pagenumbering{Alph}
\maketitle
\pagenumbering{roman}

\thispagestyle{plain}
This text consists of notes on the lecture Homological Methods in Commutative Algebra, taught at the University of Bonn by Professor Jens Franke in the summer term (Sommersemester) 2018. The dual lecture Cohomological Methods in Mmutative Algebra was given in the winter term (Wintersemester) 2017/18.

Please report bugs, typos etc. through the \emph{Issues} feature of github.

\tableofcontents

\addchap{Introduction}
\pagenumbering{arabic}

Professor Franke started the lecture giving an idea of what the $\Tor$ and $\Ext$ functors do. Let $R$ be a commutative ring with $1$. For an exact sequence of $R$-modules
\begin{align*}
	0\morphism M'\morphism M\morphism M''\morphism 0
\end{align*}
and $T$ another $R$-module, the sequence 
\begin{align}\lbl{eq:TensorSequence}
	M'\otimes_RT\morphism M\otimes_RT\morphism M''\otimes_RT\morphism 0
\end{align}
is exact but usually can't be extended by $0$ on the left end. The same is true for
\begin{align}\lbl{eq:HomSequence}
	0\morphism\Hom_R(T,M')\morphism\Hom_R(T,M)\morphism\Hom_R(T,M'')
\end{align}
and
\begin{align}\lbl{eq:HomSequence2}
	0\morphism\Hom_R(M'',T)\morphism\Hom_R(M,T)\morphism\Hom_R(M',T)\;,
\end{align}
but again, they can't be extended by $0$ on the right in general.
\begin{example*}
	Take $R=\IZ$ and consider the exact sequence $0\morphism\IZ\morphism[\cdot2]\IZ\morphism\IZ/2\IZ\morphism0$. 
	\begin{alphanumerate}
		\item Let $T=\IZ/2\IZ$ in \eqreff{eq:TensorSequence}. Then $\IZ\otimes_\IZ\IZ/2\IZ\cong\IZ/2\IZ$ and $\IZ/2\IZ\morphism[\cdot 2]\IZ/2\IZ$ is the zero morphism, showing that injectivity on the left end fails in \eqreff{eq:TensorSequence}.
		\item Let $T=\IZ/2\IZ$ in \eqreff{eq:HomSequence}. We claim that surjectivity fails on the right end. Indeed, if it was surjective, then $\id_{\IZ/2\IZ}\in\Hom_\IZ(\IZ/2\IZ,\IZ/2\IZ)$ would have to have a lift
		\begin{diagram*}
			\node[ob] (Z2) at (0,0) {$\IZ/2\IZ$};			
			\node[ob] (Z22) at (1.75,0) {$\IZ/2\IZ$};
			\node[ob] (Z) at (1.75,1.5) {$\IZ$};
			\draw[transform canvas={yshift=1pt}] (Z2) -- (Z22);
			\draw[transform canvas={yshift=-1pt}] (Z2) -- (Z22);
			\draw[->>] (Z) -- (Z22);
			\draw[->, dashed] (Z2) -- (Z);
		\end{diagram*}
		which it hasn't as $\IZ$ is $2$-torsion free and thus every morphism $\IZ/2\IZ\morphism\IZ$ must be $0$.
		\item Let $T=\IZ$ in \eqreff{eq:HomSequence2}. We claim that that surjectivity fails on the right end, or more specifically, that $\id_{\IZ}\in\Hom_\IZ(\IZ,\IZ)$ has no preimage. Indeed, if $f\in\Hom_\IZ(\IZ,\IZ)$ is a preimage of $\id_\IZ$, i.e. the composition $\IZ\morphism[\cdot2]\IZ\morphism[f]\IZ$ equals $\id_\IZ$, then $f$ must be given by $f(n)=\frac{n}{2}$ on $2\IZ$, but this can't be extended to all of $\IZ$, contradiction!
	\end{alphanumerate}
\end{example*}
To handle this deficiency, one constructs \emph{derived functors} $\Tor$ and $\Ext$, which give rise to long exact sequences
\begin{multline*}
	\ldots\morphism\Tor_2^R(M'',T)\morphism \Tor_1^R(M',T)\morphism \Tor_1^R(M,T)\morphism \Tor_1^R(M'',T)\\
	\morphism M'\otimes_RT\morphism M\otimes_RT\morphism M''\otimes_RT\morphism 0\;,
\end{multline*}
as well as
\begin{multline*}
	0\morphism\Hom_R(T,M')\morphism\Hom_R(T,M)\morphism\Hom_R(T,M'')\\
	\morphism\Ext_R^1(T,M')\morphism\Ext_R^1(T,M)\morphism\Ext_R^1(T,M'')\morphism\Ext_R^2(T,M')\morphism\ldots
\end{multline*}
and
\begin{multline*}
0\morphism\Hom_R(M'',T)\morphism\Hom_R(M,T)\morphism\Hom_R(M',T)\\
\morphism\Ext_R^1(M'',T)\morphism\Ext_R^1(M,T)\morphism\Ext_R^1(M',T)\morphism\Ext_R^2(M'',T)\morphism\ldots\;.
\end{multline*}
extending the open ends of \eqreff{eq:TensorSequence}, \eqreff{eq:HomSequence}, and \eqreff{eq:HomSequence2} respectively.

A highlight of this lecture will be \emph{Serre's characterization of regularity}.
\begin{thm*}
	For a  Noetherian local ring $R$ with maximal ideal $\mm$ and residue field $k$, the following are equivalent.
	\begin{alphanumerate}
		\item $\dim_k\mm/\mm^2=\dim R$ (i.e., $R$ is regular).
		\item There is some vanishing bound for $\Tor_\bullet ^R(-,-)$.
		\item \ldots and $\dim R+1$ is such a vanishing bound.
		\item There is some vanishing bound for $\Ext_R^\bullet (-,-)$.
		\item \ldots and $\dim R+1$ is again such a vanishing bound.
	\end{alphanumerate}
\end{thm*}
From this, one can deduce the following
\begin{cor*}
	If $R$ is a regular Noetherian local ring and $\pp\in\Spec R$, then $R_\pp$ is regular as well.
\end{cor*}

We will also introduce the notion of \emph{Cohen--Macaulay rings} and prove that they are \emph{universally catenary} (which is quite a generalization of what we did in Algebra I, cf. \cite[Theorem~10]{alg1}).
\begin{thm*}
	If $R$ is a regular Noetherian local ring or, more generally, a Cohen--Macaulay ring, then it is \defemph{universally catenary}: If $A$ is an $R$-algebra of finite type and $X\subseteq Y\subseteq Z$ are irreducible closed subsets of $\Spec A$, then
	\begin{align*}
		\codim(X,Y)+\codim(Y,Z)=\codim(X,Z)\;.
	\end{align*}
\end{thm*}

\chapter{\texorpdfstring{$\Tor$}{Tor} and \texorpdfstring{$\Ext$}{Ext} of \texorpdfstring{$R$}{R}-modules}
From now on, unless otherwise stated, our rings are commutative with $1$.
\section{Injective and projective modules and properties of \texorpdfstring{$\Ext_R^\bullet $}{Ext}}
\subsection{Injective modules and Baer's criterion}
\begin{prop}[Baer's criterion]\lbl{prop:InjectiveModules}
	For an $R$-module $N$, the following are equivalent.
	\begin{alphanumerate}
		\item The functor $\Hom_R(-,N)$ is exact.
		\item For any embedding $M\monomorphism M'$ of $R$-modules, $\Hom_R(M',N)\morphism\Hom_R(M,N)$ is surjective.
		\item Property \itememph{b} holds for $R=M$. In other words, if $I\subseteq R$ is any ideal, then any morphism $I\morphism N$ of $R$-modules extends to a morphism $R\morphism N$.
	\end{alphanumerate}
\end{prop}
\begin{rem}
	\begin{alphanumerate}
		\item \lbl{rem:Injective}Since there is a bijection
		\begin{align*}
			\Hom_R(R,M)&\isomorphism M
		\end{align*}
		(coming from the fact that a morphism $R\morphism[\phi]M$ is uniquely determined by $\phi(1)$), Proposition~\reff{prop:InjectiveModules}\itememph{c} can be reformulated as that any morphism $I\morphism N$ for $I\subseteq R$ an ideal has the form $i\mapsto i\cdot m$ for some $m\in M$.
		\item Note that Proposition~\reff{prop:InjectiveModules}\itememph{c} is trivially satisfied when $I=0$.
		\item When $R=\IZ$, every ideal $I\subseteq \IZ$ has the form $n\IZ$ for some $n\in\IZ$ and a morphism $n\IZ\morphism[\phi]N$ is uniquely determined by $\phi(n)$. Thus, an extension $\hat\phi$ of $\phi$ to $\IZ$ exists iff there is an element $\nu\in N$ such that $n\cdot\nu=\phi(n)$ (in that case, put $\hat\phi(1)=\nu$). Hence, Proposition~\reff{prop:InjectiveModules}\itememph{c}  amounts to whether the abelian group $N$ is \emph{divisible}, that is, whether $N\morphism[n\cdot ]N$ is surjective for all $n\in\IZ$ (also cf.\ Definition~\reff{def:Divisible}).
	\end{alphanumerate}
\end{rem}
\begin{defi}
	\begin{alphanumerate}
		\item \lbl{def:injectiveModule}An $R$-module is called \defemph{injective} if it satisfies the equivalent conditions from Proposition~\reff{prop:InjectiveModules}.
		\item In an arbitrary category $\Aa$, an object $I$ is called \defemph{injective} if for every monomorphism $X\monomorphism Y$ and every morphism $X\morphism[\phi]I$ there is a (usually non-unique) lift
		\begin{diagram*}
			\node[ob] (X) at (0,0) {$X$};			
			\node[ob] (Y) at (1.75,0) {$Y$};
			\node[ob] (I) at (0,1.5) {$I$};
			\scriptsize
			\draw[right hook->] (X) -- (Y);
			\draw[->] (X) -- (I) node[pos=0.5, left] {$\phi$};
			\draw[->, dashed] (Y) -- (I) node[pos=0.5, above right] {$\exists\ \hat{\phi}$};
		\end{diagram*}
	\end{alphanumerate}
\end{defi}
\begin{rem*}
	Note that Definition~\reff{def:injectiveModule}\itememph{b} equivalently says that the induced map $\Hom_\Aa(Y,I)\morphism\Hom_\Aa(X,I)$ is surjective. That is, injective $R$-modules are injective objects in the category of $R$-modules.
\end{rem*}
\begin{proof}[Proof of Proposition~\reff{prop:InjectiveModules}]
	The implication \itememph{b} $\Rightarrow$ \itememph{c} is trivial. Let's prove \itememph{c} $\Rightarrow$ \itememph{b}. Let $M\morphism[f]N$ be a morphism of $R$-modules and consider
	\begin{align*}
		\MM=\left\{(Q,\phi)\st M\subseteq Q\subseteq M'\text{ and }\snake{\phi}\in\Hom_R(Q,N)\text{ such that }\phi|_M=f\right\}\;.
	\end{align*}
	$\MM$ becomes a partially ordered set via $(Q_1,\phi_1)\preceq (Q_2,\phi_2)\Leftrightarrow Q_1\subseteq Q_2$ and $\phi_2|_{Q_1}=\phi_1$. Then it's easy to see that Zorn's lemma is applicable, hence $\MM$ has a $\preceq$-maximal element $(Q_*,\phi_*)$. If \itememph{c} is satisfied and $Q_*\subsetneq M'$, there is an $m\in M'\setminus Q_*$. Let $I=\left\{r\in R\st rm\in Q_*\right\}$ and let $I\morphism[g]N$ be given by $g(r)=\phi_*(rm)$. By \itememph{c}, there is a morphism $R\morphism[\gamma]N$ extending $g$, i.e., a $\nu\in N$ such that $\phi_*(rm)=r\nu$ when $r\in I$ (using Remark~\reff{rem:Injective}\itememph{a}). Let $\snake{Q}=Q_*+Rm$ and $\snake{\phi}(m_*+rm)=\phi_*(m_*)+r\nu$ for $m_*\in Q_*$ and $r\in R$, then it's easy to see that $\snake{\phi}$ is well-defined and $(Q_*,\phi_*)\prec (\snake{Q},\snake{\phi})$, a contradiction.
	
	The equivalence \itememph{a} $\Leftrightarrow$ \itememph{b} is easy to see as for any short exact sequence $0\morphism X\morphism Y\morphism Z\morphism 0$, the sequence $0\morphism\Hom_R(Z,N)\morphism\Hom_R(Y,N)\morphism\Hom_R(X,N)$ is exact anyways and \itememph{b} implies exactness at the right end. 
\end{proof}
\begin{defi}\lbl{def:Divisible}
	If $R$ is a domain and $M$ an $R$-module, then $M$ is called \defemph{divisible} if $M\morphism[r\cdot]M$ is surjective for all $r\in R\setminus\{0\}$
\end{defi}
\begin{cor}
	\begin{alphanumerate}
		\item \lbl{cor:InjectivityAndDivisibility}If $R$ is a domain, the property from Proposition~\reff{prop:InjectiveModules}\itememph{c} for principal ideals $I$ is equivalent to divisibility of $N$.
		\item Any injective module $N$ is divisible in the following sense: If $r\in R$ is not a zero divisor, $N\morphism[r\cdot]N$ is surjective.
		\item In particular, if $N$ is injective and $S\subseteq R$ a multiplicative subset not containing zero divisors, then the morphism $N\morphism N_S$ to the localization of $N$ at $S$ is surjective.
	\end{alphanumerate}
\end{cor}
\begin{proof}
	Part \itememph{a} can be seen using the arguments from Remark~\reff{rem:Injective}\itememph{c}. For \itememph{b}, note that $R\morphism[r\cdot]R$ is injective when $r$ is no zero divisor, hence, for any $n\in N$, the morphism $\phi\in\Hom_R(R,N)$ given by $\phi(1)=n$ extends to $\hat{\phi}\in\Hom_R(R,N)$ such that $\phi=r\hat{\phi}$. Then $\hat{\phi}(1)$ is a preimage of $n$ under $N\morphism[r\cdot]N$. Part \itememph{c} follows from \itememph{b} and the universal property of localization.
\end{proof}
\begin{rem*}
	Note that $R=\IZ/p^2\IZ$, for $p\in\IZ$ a prime, is injective over itself, but $R\morphism[p\cdot ]R$ fails to be injective. Indeed, the only ideal of $R$ where Baer's criterion is in question is $(p)\subseteq R$. We need to show that any $R$-morphism $(p)\morphism R$ extends to an $R$-morphism $R\morphism R$. But any $(p)\morphism[\phi] R$ maps $p$ to the $p$-torsion part of $R$, i.e., to $(p)$ itself, hence is given by $\phi(p)=rp$ for some $r\in R$ and can be extended via $\hat{\phi}$ given by $\hat{\phi}(1)=r$. This shows that Corollary~\reff{cor:InjectivityAndDivisibility}\itememph{b} is somewhat sharp.
\end{rem*}
\begin{cor}\lbl{cor:PIDInjDiv}
	A module over a principal ideal domain is injective iff it is divisible.
\end{cor}
\begin{proof}
	Follows from Corollary~\reff{cor:InjectivityAndDivisibility}\itememph{a}.
\end{proof}
\begin{rem*}
	The same holds for Dedekind domains, see Corollary~\reff{cor:DedekindInjective}.
\end{rem*}
\begin{cor}\lbl{cor:PIDInjectiveResolution}
	If $R$ is a principal ideal domain, then any quotient of an injective module is injective again. The category of $R$-modules has \defemph{sufficiently many injective objects} in the sense that for any object $X$ there is a monomophism $X\monomorphism I$ with $I$ injective. Thus, any $R$-module $X$ has an \defemph{injective resolution}, i.e., an exact sequence
	\begin{align*}
	0\morphism X\morphism I^0\morphism I^1\morphism I^2\morphism\ldots
	\end{align*}
	with injective objects $I^0,I^1,I^2,\ldots$. In fact, any $R$-module, for $R$ a principal ideal domain, has an injective resolution $0\morphism X\morphism I^0\morphism I^1\morphism 0$ of length $1$.
\end{cor}
\begin{proof}
	The first assertion follows as the quotient of divisible modules is divisible again. Note that $K/R$ is divisible, $K$ being the quotient field of $R$, hence it is injective. If $M$ is any $R$-module and $m\in M\setminus\{0\}$. We have to distinguish to cases.
	
	\emph{Case 1.} Suppose $\Ann_R(m)$ is non-zero, i.e., $\Ann_R(m)=(\alpha)$ for some $\alpha\in R\setminus \{0\}$ (remember we have a principal ideal domain). Then we have a morphism from $Rm\subseteq M$ to $K/R$ given by $rm\mapsto \frac{r}{\alpha}\bmod R$ (note that modding out $R$ is necessary for this to be well-defined -- we couldn't just have used $K$). By injectivity of $K/R$, there is an extension $M\morphism[\phi_m]K/R$, satisfying $\phi_m(m)\neq 0$. Let $I_m= K/R$ be the target of $\phi_m$.
	
	\emph{Case 2.} If $\Ann_R(m)=0$, we get a morphism from $Rm\subseteq M$ to $K$ instead, sending $rm\mapsto r$ (this time, using $K$ doesn't cause problems thanks to $\Ann_R(m)=0$). By injectivity of $K$, this extends to a morphism $M\morphism[\phi_m]K$ such that $\phi_m(m)\neq0$. Let $I_m=K$ be the target of $\phi_m$.
	
	Now put $I=\prod_{m\in M\setminus\{0\}}I_m$. Then $I$ is divisible (since every $I_m$ is), hence injective, and $M\morphism I$, $\mu\mapsto\left(\phi_m(\mu)\right)_{m\in M\setminus\{0\}}$ is a monomorphism. As a quotient of $I^0=I$, $I^1=\coker\left(M\morphism I^0\right)$ is injective as well, hence $0\morphism M\morphism I^0\morphism I^1\morphism 0$ is an injective resolution of length $1$.
\end{proof}
\begin{prop}[a.k.a. ``Satz 2'']\lbl{prop:RModHasEnoughInjectives}
	For any ring $R$, the category of $R$-modules has sufficiently many injective objects.
\end{prop}
\begin{proof}
	This will follow from Lemma~\reff{lem:AdjointStuff}\itememph{b} and \itememph{c} below.
\end{proof}
\begin{rem*}
	This holds in vast more generality, and in particular, Proposition~\reff{prop:RModHasEnoughInjectives} follows immediately from the following theorem, which, however, we are not going to prove in this lecture.
	\begin{thm*}[Grothendieck]
		Any AB5 category with a generator has sufficiently many injective objects.
	\end{thm*}
\end{rem*}
\begin{lem}\lbl{lem:AdjointStuff}
	Let $R$ be any ring.
	\begin{alphanumerate}
		\item The forgetful functor from $R\cat{-Mod}$ to the category $\IZ\cat{-Mod}$ of abelian groups has a right-adjoint functor, namely $\Hom_\IZ(R,-)$. That is, there is a bijection
		\begin{align}\lbl{eq:ForgetHomAdjunction}
			\Hom_\IZ(M,A)\isomorphism\Hom_R(M,\Hom_\IZ(R,A))\tag{$*$}
		\end{align}
		for any $R$-module $M$ and any abelian group $A$. Here, we equip $\Hom_\IZ(R,A)$ with an $R$-module structure via $(r\cdot\phi)(x)=\phi(xr)$ for $\phi\in\Hom_\IZ(R,A)$ and $r,x\in R$.
		\item For any injective abelian group $I$, $\Hom_\IZ(R,I)$ is an injective $R$-module.
		\item Let $M$ be any $R$-module and $I$ an abelian group and $M\monomorphism[\phi]I$ a monomorphism of abelian groups, then the $R$-morphism $M\morphism\Hom_\IZ(R,I)$ obtained by applying \eqreff{eq:ForgetHomAdjunction} is injective.
	\end{alphanumerate}
\end{lem}
\begin{proof}
	Part \itememph{a}. The proof given in the lecture was rather computational, so I decided to include a more elegant one. It is easy to see that $\Hom_\IZ(R,-)$ is indeed a functor $\IZ\cat{-Mod}\morphism R\cat{-Mod}$. From the well-known tensor-hom adjunction we obtain a canonical bijection
	\begin{align*}
		\Hom_\IZ(M\otimes _RR,A)\isomorphism\Hom_R(M,\Hom_\IZ(R,A))\;.
	\end{align*}
	But $M$ is an $R$-module and so $M\otimes_RR\cong M$ canonically, proving \eqreff{eq:ForgetHomAdjunction}. 
	%The bijection-in-question \eqreff{eq:ForgetHomAdjunction} sends $\phi\in\Hom_\IZ(M,A)$ to $\psi\in\Hom_R(M,\Hom_\IZ(R,A))$ given by $(\psi(m))(r)=\phi(rm)$ and 
	
	Part \itememph{b}. Since the forgetful functor $R\cat{-Mod}\morphism\IZ\cat{-Mod}$ clearly preserves injectivity of morphisms (i.e., monomorphisms), this comes down to the following more general fact about adjoint pairs of functors.
	\begin{fact}\lbl{fact:AdjointInjProj}
		Let $\Aa\doublelrmorphism[L][R]\Bb$ be an adjoint pairs of functors. Suppose that $L$ preserves monomorphisms. Then $R$ preserves injective objects.
	\end{fact}
	\begin{proof}[Proof of Fact~\reff{fact:AdjointInjProj}]
		Let $I\in\Ob(\Bb)$ be injective and $X\monomorphism Y$ be a monomorphism in $\Aa$. By assumption, $LX\monomorphism  LY$ is a monomorphism in $\Bb$. In the diagram 
			\begin{diagram*}
				\node[ob] (Y) at (0,1.5) {$\Hom_\Aa(Y,RI)$};
				\node[ob] (LY) at (0,0) {$\Hom_\Bb(LY,I)$};
				\node[ob] (X) at (3.5,1.5) {$\Hom_\Aa(X,RI)$};
				\node[ob] (LX) at (3.5,0) {$\Hom_\Bb(LX,I)$};
				\scriptsize
				\draw[->] (Y) -- (LY) node[pos=0.5, sloped, above=-0.25ex] {$\sim$};
				\draw[->] (X) -- (LX) node[pos=0.5, sloped, above=-0.25ex] {$\sim$};
				\draw[->] (Y) -- (X);
				\draw[->] (LY) -- (LX);
			\end{diagram*}
		the lower horizontal arrow is surjective by injectivity of $I$, hence so is the upper horizontal arrow.
	\end{proof}
	Back to the proof of Lemma~\reff{lem:AdjointStuff} and let's prove \itememph{c}. Let $\phi\colon M\monomorphism I$ be a monomorphism of abelian groups. The corresponding morphism $\psi\colon M\morphism \Hom_\IZ(R,I)$ sends $m\in M$ to $\psi(m)\colon R\morphism I$ given by $\psi(m)(r)=\phi(rm)$. If $\psi(m)$ is the zero morphism for some $m\in M$, then $0=\psi(m)(1)=\phi(m)$, proving $m=0$ by injectivity of $\phi$. Then $\psi$ is also injective.
\end{proof}
The dual concept of \emph{projective modules} should be known, but for the sake of completeness I will include it nevertheless.
\begin{defi}
	\begin{alphanumerate}
		\item \lbl{def:projectiveModule}An $R$-module $P$ is called \defemph{projective} iff $\Hom_R(P,-)$ is exact.
		\item In an arbitrary category $\Aa$, an object $P$ is called \defemph{projective} if for every epimorphism $Y\epimorphism X$, the induced map $\Hom_\Aa(P,X)\morphism\Hom_\Aa(P,Y)$ is surjective, that is, for every morphism $P\morphism[\phi]X$ there is a (usually non-unique) lift
		\begin{diagram*}
			\node[ob] (P) at (0,0) {$P$};			
			\node[ob] (X) at (1.75,0) {$X$};
			\node[ob] (Y) at (1.75,1.5) {$Y$};
			\scriptsize
			\draw[->>] (Y) -- (X);
			\draw[->] (P) -- (X) node[pos=0.5, above] {$\phi$};
			\draw[->, dashed] (P) -- (Y) node[pos=0.5, above left] {$\exists\ \hat{\phi}$};
		\end{diagram*}
	\end{alphanumerate}
\end{defi}
Note that in the case of $R$-modules, Definition~\reff{def:projectiveModule}\itememph{a} and \itememph{b} are equivalent.

\subsection{First properties of the \texorpdfstring{$\Ext_R^\bullet$}{Ext} functor}
We will now use the $\Ext_R^\bullet(-,-)$ functor, which was constructed (for arbitrary abelian categories rather than just $R\cat{-Mod}$) in Subsection~\reff{subsec:ConstructionOfExt} as a \emph{right-derived functor} of $\Hom_R(-,-)$.
\begin{prop}\lbl{prop:PIDExt2}
	Let $R$ be a PID.
	\begin{alphanumerate}
		\item For any $R$-modules $M,N$ we have $\Ext_R^p(M,N)=0$ when $p>1$.
		\item Any submodule of a projective $R$-module is projective.
	\end{alphanumerate}
\end{prop}
\begin{proof}
	Part \itememph{a}. By Corollary~\reff{cor:PIDInjectiveResolution}, $N$ has an injective resolution of length $1$, hence $\Ext_R^p(M,N)$ vanishes for $p>1$.
	
	Part \itememph{b}. Let $P$ be projective and $Q\subseteq P$ a submodule. For any test module $T$ there is an exact sequence $\Ext_R^1(P,T)\morphism\Ext_R^1(Q,T)\morphism\Ext_R^2(P/Q,T)$ in which $\Ext_R^1(P,T)$ vanishes as $P$ is projective and $\Ext_R^2(P/Q,T)$ vanishes by \itememph{a}. Hence $\Ext_R^1(Q,T)=0$ and $\Ext_R^1(Q,-)$ is the zero functor, showing exactness of $\Hom_R(Q,-)$, i.e., projectivity of $Q$ by Definition~\reff{def:projectiveModule}\itememph{a}.
\end{proof}
\begin{rem*}
	\begin{alphanumerate}
		\item We will soon generalize this to Dedekind domains, cf. Corollary~\reff{cor:DedekindInjective}.
		\item Let $R$ be a PID again. For $a\in R\setminus \{0\}$, the identity $\id_{R/aR}$ does \emph{not} lift to a morphism $R/aR\morphism R$, showing that $R/aR$ is not projective. By the classification of finitely generated $R$-modules and the fact that any direct summand of a projective module is projective again (this is clear using the criterion that projective modules over any ring are precisely the direct summands of free modules, cf. Lemma~\reff{lem:projectiveDirectSummand}; but also follows from Proposition~\reff{prop:PIDExt2}\itememph{b} in our case), this shows that a finitely generated $R$-module is projective iff it is free.
		
		This can be seen to hold without the assumption of being finitely generated. Therefore, ``projective'' in Proposition~\reff{prop:PIDExt2}\itememph{b} may be replaced by ``free''.
	\end{alphanumerate}
\end{rem*}
\begin{example*}
	Let $R$ be any ring. If $a\in R$ is not a zero divisor. We can calculate $\Ext_R^\bullet(R/aR,M)$ for any $R$-module $M$ using the projective resolution $0\morphism R\morphism[ a\cdot]R\morphism R/aR\morphism 0$. We get
	\begin{align*}
		\Ext_R^k(R/aR,M)=H^k\left(\Hom_R(R\morphism[ a\cdot]R,M)\right)=\begin{cases}
			\ker(M\morphism[ a\cdot]M) & \text{if }k=0\\
			M/aM & \text{if }k=1\\
			0 & \text{else}
		\end{cases}\;.
	\end{align*}
\end{example*}
If $N$ is an injective $R$-module, then $\Ext_R^1(T,N)=0$ by Theorem~\reff{thm:DerivedFunctors}\itememph{b} for every test $R$-module $T$. Conversely, if $\Ext_R^1(-,N)=0$ is the zero functor, we see that $\Hom_R(-,N)$ is exact by the long exact $\Ext$ sequence, hence $N$ is injective by Definition~\reff{def:injectiveModule}\itememph{a}. The following proposition shows that this criterion can be sharpened.
\begin{prop}\lbl{prop:Ext1(R/I)}
	If $R$ is any ring, then an $R$-module $N$ is injective iff $\Ext_R^1(R/I,N)=0$ for every ideal $I\subseteq R$.
\end{prop}
\begin{proof}
	By Baer's criterion (Proposition~\reff{prop:InjectiveModules}), we only need to check exactness of $\Hom_R(-,N)$ on exact sequences of the form $0\morphism I\morphism R\morphism R/I\morphism 0$ for $I\subseteq R$ an ideal. By vanishing of $\Ext_R^1(R,N)$ (since $R$ is projective over itself), this is equivalent to $\Ext_R^1(R/I,N)=0$ by the long exact $\Ext$ sequence.
\end{proof}
\begin{rem*}
	As far as Professor Franke is aware, there is no similar criterion for projectivity, and by a famous result of Shelah the \emph{Whitehead problem} ``Is any abelian group $A$ with $\Ext_\IZ^1(A,\IZ)=0$ free'' is undecidable in ZFC set theory.
\end{rem*}
Our goal now is to establish some properties of $\Ext$ groups over a ring $R$, namely criteria for finitely generatedness and compatibility with localization.
\begin{fact}\lbl{fact:atimesExt}
	For $a\in R$ and any $R$-modules $M$ and $N$ the following coincide.
	\begin{alphanumerate}
		\item The multiplication $a\cdot $ on $\Ext_R^p(M,N)$ (this is an $R$-module after all).
		\item The endomorphism $\Ext_R^p(M,N)\morphism\Ext_R^k(M,N)$ induced by $M\morphism[ a\cdot]M$ and (contravariant) functoriality of $\Ext_R^p(-,N)$.
		\item The endomorphism $\Ext_R^k(M,N)\morphism\Ext_R^k(M,N)$ induced by $N\morphism[ a\cdot]N$ and (covariant) functoriality of $\Ext_R^p(M,-)$.
	\end{alphanumerate}
\end{fact}
\begin{proof}
	Let $N\monomorphism I^\bullet$ be an injective resolution. We obtain a commutative diagram
	\begin{diagram*}
		\node[ob] (A) at (0,1.5) {$0$};
		\node[ob] (B) at (1.5,1.5) {$N$};
		\node[ob] (C) at (3,1.5) {$I^0$};
		\node[ob] (D) at (4.5,1.5) {$I^1$};
		\node[ob] (E) at (6,1.5) {$\ldots$};
		\node[ob] (A') at (0,0) {$0$};
		\node[ob] (B') at (1.5,0) {$N$};
		\node[ob] (C') at (3,0) {$I^0$};
		\node[ob] (D') at (4.5,0) {$I^1$};
		\node[ob] (E') at (6,0) {$\ldots$};
		\scriptsize
		\draw[->] (A) -- (B);
		\draw[->] (B) -- (C);
		\draw[->] (C) -- (D);
		\draw[->] (D) -- (E);
		\draw[->] (A') -- (B');
		\draw[->] (B') -- (C');
		\draw[->] (C') -- (D');
		\draw[->] (D') -- (E');
		\draw[->] (B) -- (B') node[pos=0.5,left] {$\cdot a$};
		\draw[->] (C) -- (C') node[pos=0.5, left] {$\cdot a$};
		\draw[->] (D) -- (D') node[pos=0.5, left] {$\cdot a$};
	\end{diagram*}
	from which $\Ext_R^\bullet(-,N\morphism[ a\cdot]N)$ can be computed, showing that \itememph{c} coincides with \itememph{a}. For \itememph{b}, we do the same but with projective resolutions.
\end{proof}
\begin{fact}\lbl{fact:atimesExt2}
	If multiplication by $a$ annullates one of the modules $M$ or $N$, then it annullates $\Ext_R^\bullet(M,N)$.
\end{fact}
\begin{proof}
	Follows from Fact~\reff{fact:atimesExt}.
\end{proof}
\begin{fact}\lbl{fact:freeResolution}
	If $R$ is a Noetherian ring, then any finitely generated $R$-module $M$ has a projective resolution
	\begin{align*}
		0\lmorphism M\lmorphism P_0\lmorphism P_1\lmorphism P_2\lmorphism\ldots
	\end{align*}
	where the $P_i$ are finitely generated free $R$-modules.
\end{fact}
\begin{proof}
	We construct the $P_i$ inductively. Since $M$ is finitely generated, we have a surjective morphism $P_0=R^n\epimorphism M$ for some $n$. $R$ being Noetherian, its kernel is finitely generated and we can apply the same construction to it.
\end{proof}
\begin{rem*}
	\begin{alphanumerate}
		\item The interesting thing here is that the $P_i$ are finitely generated. If we drop this, any module over any ring has a free resolution.
		\item If $R$ is \emph{coherent} (any finitely generated ideal is finitely presented) and $M$ is finitely presented, Fact~\reff{fact:freeResolution} still holds. Recall that
	\end{alphanumerate}
\end{rem*}
\begin{defi}
	An $R$-module $M$ is \defemph{finitely presented} if it may be written as a cokernel of some morphism $R^m\morphism R^n$.
\end{defi}
\begin{fact}\lbl{fact:ExtFinGen}
	If $M$ and $N$ are finitely generated modules over the Noetherian ring $R$, the $R$-modules $\Ext_R^p(M,N)$ are all finitely generated.
\end{fact}
\begin{proof}
	Choose a free resolution $0\lmorphism M\lmorphism R^{n_0}\lmorphism R^{n_1}\lmorphism\ldots$ as in Fact~\reff{fact:freeResolution}, then $\Ext_R^k(M,N)$ can be calculated as $H^k\left(N^{n_0}\morphism N^{n_1}\morphism\ldots\right)$, which is finitely generated as the $N^{n_i}$ are finitely generated and we are all Noetherian and stuff.
\end{proof}
We will now examine when $\Ext_R^\bullet$ commutes with localization.

Let $\Aa\doublelrmorphism[L][\smash{R}]\Bb$ be an adjoint pair between abelian categories $\Aa,\Bb$. Then it's easy to see that $L$ preserves projective objects when $R$ is exact and $R$ preserves injectives when $L$ is exact. Actually, Fact~\reff{fact:AdjointInjProj} (and it's dual version) show this under fairly weaker assumptions. This may be applied to $\Aa=A\cat{-Mod}$ and $\Bb=A_S\cat{-Mod}$ where $A$ is some ring, $S\subseteq A$ a multiplicative subset, $A_S$ the localization of $A$ at $S$ and where $L$ is the functor $M\mapsto M_S$ for $M$ an $A$-module and $R$ is the forgetful functor. Note that both $L$ and $R$ are exact and we obtain
\begin{fact}\lbl{fact:InjProjLoc}
	Let $R$ be any ring. If $M$ is a projective $R$-module, then $M_S$ is a projective $R_S$-module. If $N$ is an injective $R_S$-module, then it is injective as an $R$-module as well.
\end{fact}
\begin{fact}
	For any ring $R$ and any multiplicative subset $S\subseteq R$, we have a canonical isomorphism
	\begin{align}\lbl{eq:ExtRStoExtR}
		\Ext_{R_S}^\bullet(M_S,N)\isomorphism\Ext_R^\bullet(M,N)
	\end{align}
	where $M$ is an $R$- and $N$ an $R_S$-module. It is uniquely determined by its compatibility with the long exact cohomology sequence and by the condition that in degree $0$ it coincides with the bijection $\Hom_{R_S}(M_S,N)\cong \Hom_R(M,N)$.
\end{fact}
\begin{proof}
	When $M$ is fixed, $\Ext_R^\bullet(M,-)$ is a cohomological functor on the category $R_S\cat{-Mod}$. By the universal property of derived functors (in Definition~\reff{def:homologicalfunctor}), the bijection $\Hom_{R_S}(M_S,N)\cong \Hom_R(M,N)$ uniquely extends to the morphism \eqreff{eq:ExtRStoExtR}. By Fact~\reff{fact:InjProjLoc}, $\Ext_R^\bullet(M,-)$ annullates injective $R_S$-modules in positive degrees, hence by Theorem~\reff{thm:DerivedFunctors}\itememph{b} it is a right-derived functor of $\Hom_{R_S}(M_S,-)$. Then \eqreff{eq:ExtRStoExtR} is an isomorphism by the universal property of right-derived functors.
\end{proof}
When $M$ and $N$ are $R$-modules, we have a canonical morphism
\begin{align*}
	\Hom_R(M,N)\morphism\Hom_{R_S}(M_S,N_S)
\end{align*}
sending $M\morphism[f]N$ to $M_S\morphism[f_S]N_S$. This is a morphism of $R$-modules in which the right-hand side is actually an $R_S$-module. By the universal property of localization this induces a unique morphism
\begin{align}\lbl{eq:HomRtoHomRS}
	\Hom_R(M,N)_S\morphism\Hom_{R_S}(M_S,N_S)\;.\tag{$*$}
\end{align}
In general, \eqreff{eq:HomRtoHomRS} fails to be injective or surjective. But when $M$ is finitely generated, it is injective, and when $M$ is finitely presented (e.g., when $M$ is finitely generated and $R$ Noetherian) it's an isomorphism. For instance, when $M\cong\coker(R^m\morphism R^n)$, then $M_S\cong \coker(R_S^m\morphism R_S^n)$ by exactness of localization and $\Hom_R(M,N)\cong \ker(N^n\morphism N^m)$ (and similar for $\Hom_{R_S}(M_S,N_S)$) by the universal property of cokernels. We obtain
\begin{align*}
	\Hom_R(M,N)_S\cong\ker(N^n\morphism N^m)_S\cong \ker(N_S^n\morphism N_S^m)\cong \Hom_{R_S}(M_S,N_S)
\end{align*}
which can be seen to coincide with \eqreff{eq:HomRtoHomRS}.

And now for the advertised compatibility with localization.
\begin{prop}\lbl{prop:ExtLocalization}
	Let $R$ be a Noetherian ring, $M$ a finitely generated $R$-module. Then for any $R$-module $N$ and any multiplicative subset $S\subseteq R$ there is a canonical isomorphism
	\begin{align}\lbl{eq:ExtCompatibleWithLoc}
		\Ext_R^\bullet(M,N)_S\isomorphism\Ext_{R_S}^\bullet (M_S,N_S)\;.
	\end{align}
	It is uniquely determined by its compatibility with the long exact $\Ext$ sequences for $N$ and by the condition that it is given by 
	\begin{align*}
		\Hom_R(M,N)_S\morphism[{\text{\eqreff{eq:HomRtoHomRS}}}]\Hom_{R_S}(M_S,N_S)
	\end{align*}
	in degree 0.
\end{prop}
\begin{proof}
	For every $R$-module $M$, the functor $\Ext_{R_S}^\bullet (M_S, (-)_S)$ composed with the forgetful functor $R_S\cat{-Mod}\morphism R\cat{-Mod}$ is a cohomological functor on $R\cat{-Mod}$, hence there is a unique morphism $\Ext_R^\bullet(M,-)\morphism\Ext_{R_S}^\bullet (M_S,(-)_S)$ extending $\Hom_R(M,N)\morphism\Hom_{R_S}(M_S,N_S)$, and by the universal property of localization this factors uniquely over $\Ext_R^\bullet(M,-)_S$. This shows the uniqueness part.
	
	For existence, choose a free resolution $0\lmorphism M\lmorphism R^{n_0}\morphism R^{n_1}\lmorphism\ldots$ as in Fact~\reff{fact:freeResolution}. By exactness of localization, $0\lmorphism M_S\lmorphism R_S^{n_0}\morphism R_S^{n_1}\lmorphism\ldots$ is a free resolution of $M_S$. Using these to compute $\Ext_R^\bullet(M,-)$ and $\Ext_{R_S}^\bullet(M_S,-)$ and the fact that localization commutes with cohomology (since it is exact), we obtain
	\begin{align*}
		\Ext_R^p(M,N)_S&\cong H^p\left(N^{n_0}\morphism N^{n_1}\morphism\ldots\right)_S\\
		&\cong H^p\left(N_S^{n_0}\morphism N_S^{n_1}\morphism\ldots\right)\\
		&\cong \Ext_{R_S}^p(M_S,N_S)\;,
	\end{align*}
	as required.
\end{proof}
\subsection{Projective and injective dimension}
Let $\Aa$ be an abelian category. To have $\Ext_\Aa^\bullet$ available, we need to assume that $\Aa$ has sufficiently many injective or projective objects or we use Yoneda-$\Ext_\Aa^\bullet$ from Remark~\reff{rem:YonedaExt}\itememph{b}.
\begin{defi}\lbl{def:idim/pdim}
	Let $X$ be an objects of $\Aa$. Its \defemph{injective/projective dimension} is defined as
	\begin{align*}
		\idim_\Aa(X)&=\sup\left\{p\st \Ext_\Aa^p(T,X)\neq 0\text{ for some object }T\in\Ob(\Aa)\right\}\\
		\pdim_\Aa(X)&=\sup\left\{p\st \Ext_\Aa^p(X,T)\neq 0\text{ for some object }T\in\Ob(\Aa)\right\}
	\end{align*}
	and we put $\sup\emptyset =-\infty$.
\end{defi}
\begin{fact}\lbl{fact:injDim}
	When $\Aa$ has sufficiently many injective objects and $X\neq 0$ we have
	\begin{align*}
		\idim_\Aa(X)&=\min\left\{\ell\st X\text{ has an injective resolution of length }\ell\right\}\\
	&=	\min\left\{\ell\st\begin{array}{c}
	\text{for any injective resolution }X\monomorphism I^\bullet\text{ the truncation}\\
	X\monomorphism\tau_{\leq\ell}I^\bullet\text{ is an injective resolution of }X
	\end{array}
	\right\}
	\end{align*}
	The left-hand side is $-\infty$ for $X=0$ and $+\infty$ if no such $\ell$ exists. 
\end{fact}
For a cochain complex $C^\bullet$ in $\Aa$ we used the \emph{soft truncation}\footnote{As opposed to the \emph{hard truncation} in which everything above degree $k$ is just cut off.} $\tau_{\leq k}C^\bullet$ given by 
\begin{align*}
	\tau_{\leq k}C^\ell=\begin{cases}
	C^\ell & \text{if }\ell<k\\
	Z^k=\ker(C^k\morphism C^{k+1}) & \text{if }\ell=k\\
	0 & \text{if }\ell>k
	\end{cases}\;.
\end{align*}
Another way to softly truncate would be $\snake{\tau}_{\leq k}C^\bullet$, given by
\begin{align*}
\snake{\tau}_{\leq k}C^\ell=\begin{cases}
C^\ell & \text{if }\ell\leq k\\
B^{k+1}=\coker(C^{k-1}\morphism C^k) & \text{if }\ell=k+1\\
0 & \text{if }\ell>k+1
\end{cases}\;.
\end{align*}
In the case where $C^\bullet$ is acyclic (e.g., an injective resolution), $\tau_{\leq k+1}C^\bullet$ and $\snake{\tau}_{\leq k}C^\bullet$ coincide.
\begin{proof}[Proof of Fact~\reff{fact:injDim}]
	Let $\idim_\Aa^{(1)}$, $\idim_\Aa^{(2)}$, and $\idim_\Aa^{(3)}$,  denote the three notions of injective dimension in the order in which they appear. Then $\idim_\Aa^{(1)}(X)\leq \idim_\Aa^{(2)}(X)\leq \idim_\Aa^{(3)}(X)$ is trivial.
	
	Let's show $\idim_\Aa^{(3)}(X)\leq \idim_\Aa^{(1)}(X)$. Let $X\monomorphism I^\bullet$ be any injective resolution of $X$. Denote $Z^k=\ker\left(I^k\morphism I^{k+1}\right)$. Then $Z^0=X$ and the short exact sequence $0\morphism Z^k\morphism I^k\morphism Z^{k+1}\morphism 0$ gives
	\begin{align*}
		0=\Ext_\Aa^p(T,I^k)\morphism \Ext_\Aa^p(T,Z^{k+1})\morphism\Ext_\Aa^{p+1}(T,Z^k)\morphism\Ext_\Aa^{p+1}(T,I^k)=0
	\end{align*}
	for any test object $T\in\Ob(\Aa)$. Hence $\Ext_\Aa^p(T,Z^{k+1})\cong \Ext_\Aa^{p+1}(T,Z^k)$. By induction, $\Ext_\Aa^p(T,Z^k)\cong \Ext_\Aa^{p+k}(T,Z^0)=\Ext_\Aa^{p+k}(T,X)$. In particular, $\Ext_\Aa^1(T,Z^\ell)\cong \Ext_\Aa^{\ell+1}(T,X)$. When $\Ext_\Aa^{\ell+1}(-,X)$ vanishes, this shows injectivity of $Z^\ell$ and thus $\idim_R^{(3)}(X)\leq \ell$.
\end{proof}
In particular, this proof shows that $\Ext_\Aa^{\ell+1}(-,X)=0$ implies $\Ext_\Aa^p(-,X)=0$ for all $p>\ell$. Dualizing the proof of Fact~\reff{fact:injDim}, we get the same for $\Ext_\Aa^p(X,-)$, as well as 
\begin{fact}\lbl{fact:projDim}
	When $\Aa$ has sufficiently many projective objects and $X\neq 0$ we have
	\begin{align*}
	\pdim_\Aa(X)&=\min\left\{\ell\st X\text{ has a projective resolution of length }\ell\right\}\\
	&=	\min\left\{\ell\st\begin{array}{c}
	\text{for any projective resolution }P_\bullet\epimorphism X\text{ the truncation}\\
	\snake{\tau}_{\leq\ell}P_\bullet\epimorphism X\text{ is a projective resolution of }X
	\end{array}
	\right\}\;,
	\end{align*}
	where the right-hand side is replaced by $-\infty$ if $X=0$ and $+\infty$ when no such $\ell$ exists.
\end{fact}
Our truncation conventions for chain complexes $C_\bullet$ are
\begin{align*}
\tau_{\leq k}C_\ell=\begin{cases}
C_\ell & \text{if }\ell\leq k\\
\ker\left(C_k\morphism C_{k-1}\right) & \text{if }\ell=k+1\\
0 & \text{if }\ell>k+1
\end{cases}\quad\text{and}\quad
\snake{\tau}_{\leq k}C_\ell=\begin{cases}
C_\ell & \text{if }\ell< k\\
\coker\left(C_{k+1}\morphism C_k\right) & \text{if }\ell=k\\
0 & \text{if }\ell>k
\end{cases}
\end{align*}

Recall Proposition~\reff{prop:Ext1(R/I)}. By the above proof of equality of various $\idim$s, we have
\begin{align}\lbl{eq:idim}
	\begin{split}
		\idim_R(X)&=\sup\left\{p\st\Ext_R^p(R/I,X)\neq 0\text{ for some ideal }I\subseteq I\right\}\\
		&=\sup\left\{p\st\Ext_R^p(T,X)\neq 0\text{ for some finitely generated }R\text{-module }T\right\}
	\end{split}
\end{align}
as it is sufficient to use such $T$ as test objects for injectivity in our proof of $\idim_R^{(3)}(X)\leq \idim_R^{(1)}(X)$, hence the proof remains valid when $\idim_R^{(3)}(X)$ is replaced by \eqreff{eq:idim}. Using Proposition~\reff{prop:ExtLocalization}, we obtain
\begin{cor}\lbl{cor:injDimLocal}
	For any module $M$ over a Noetherian ring,
	\begin{align*}
		\idim_R(M)&=\sup\left\{\idim_{R_\mm\vphantom{\pp}}(M_\mm)\st \mm\in\mSpec R\right\}\\
		&=\sup\left\{\idim_{R_\pp}(M_\pp)\st \pp\in\Spec R\right\}\;.
	\end{align*}
\end{cor}
\begin{proof}
	It's a well-known fact that an $R$-module $N$ vanishes iff $N_\mm=0$ for all $\mm\in\mSpec R$ iff $N_\pp=0$ for all $\pp\in\Spec R$. So $\Ext_R^p(R/I,M)$ (for $I\subseteq R$ an ideal) vanishes iff
	\begin{align*}
		0=\Ext_R^p(R/I,M)_\mm=\Ext_{R_\mm}^p((R/I)_\mm,M_\mm)=\Ext_{R_\mm}^p(R_\mm/I_\mm,M_\mm)
	\end{align*}
	for all $\mm\in\mSpec R$ by Proposition~\reff{prop:ExtLocalization}. Since every ideal $J\subseteq R_\mm$ is of the form $J=I_\mm$ for some ideal $I\subseteq R$, Proposition~\reff{prop:Ext1(R/I)} indeed implies $\idim_R(M)=\sup_\mm\idim_{R_\mm}(M_\mm)$. And $\idim_R(M)=\sup_\pp\idim_{R_\pp}(M_\pp)$ is just the same argument again. 
\end{proof}
\begin{cor}\lbl{cor:projDimLocal}
	For any finitely generated module $M$ over a Noetherian ring,
	\begin{align*}
	\pdim_R(M)&=\sup\left\{\pdim_{R_\mm\vphantom{\pp}}(M_\mm)\st \mm\in\mSpec R\right\}\\
	&=\sup\left\{\pdim_{R_\pp}(M_\pp)\st \pp\in\Spec R\right\}\;.
	\end{align*}
\end{cor}
\begin{proof}
	As in the proof of Corollary~\reff{cor:injDimLocal}, $\Ext_R^p(M,T)$ (for any test object $T$) vanishes iff
	\begin{align*}
		0=\Ext_R^p(M,T)_\mm=\Ext_{R_\mm}^p(M_\mm,T_\mm)
	\end{align*}
	for every $\mm\in\mSpec R$. Since every $R_\mm$-module has the form $T_\mm$ for some $R$-module $T$ (well, every $R_\mm$-module $N$ is an $R$-module as well, and $N_\mm=N$), $\pdim_R(M)=\sup_\mm\pdim_R(M_\mm)$. And $\pdim_R(M)=\sup_\pp\pdim_R(M_\pp)$ is completely analogous.
\end{proof}
If $R$ is a Dedekind domain, the $R_\mm$ are fields (when $R$ is a field) or discrete valuation rings (cf. \cite[Theorem~22]{alg2}), in particular, PIDs. Applying Proposition~\reff{prop:PIDExt2}, we obtain
\begin{cor}\lbl{cor:DedekindInjective}
	A module over a Dedekind domain $R$ is injective iff it is divisible. Any quotient of an injective module is therefore injective and $\idim_R(M)\leq 1$ for any $R$-module $M$. Hence also $\pdim_R(M)\leq 1$ and any submodule of a projective module is projective again, and any finitely generated torsion-free $R$-module is projective.
\end{cor}
\begin{proof}
	An $R$-module $M$ is injective iff $\idim_R(M)\leq 0$ (note that $0$ is also injective and $\idim_R(0)=-\infty$), so by Corollary~\reff{cor:injDimLocal}, $M$ is injective iff $M_\pp$ is injective for all $\pp\in \Spec R$. Note that $M_\pp$ is divisible iff $M_\pp\morphism[r\cdot]M_\pp$ is surjective for all $r\in R\setminus\{0\}$. Indeed, multiplication by $s^{-1}\in R_\pp$ for $s\in R\setminus \pp$ is automatically bijective, so it suffices to test divisibility on those $r\in R_\pp$ which are the image of some non-zero element of $R$.
	
	By a well-known lemma, a morphism $f\colon N\morphism N'$ of $R$-modules is surjective iff every localization $f_\pp\colon N_\pp\morphism N'_\pp$ is surjective (and this works for injectivity as well). Applying this to $N=N'=M$ in the case where $f$ is multiplication by $r\in R\setminus\{0\}$, we find that $M$ is divisible iff all its localizations $M_\pp$ are. Since the $R_\pp$ are PIDs, Corollary~\reff{cor:PIDInjDiv} proves our first assertion that $M$ is injective iff its divisible.
	
	Since quotients of divisible $R$-modules are divisible again, the second assertion follows immediately. If $M\monomorphism I^\bullet$ is an injective resolution of $M$, then so is $0\morphism M\morphism I^0\morphism I^0/M\morphism 0$ already, hence $\idim_R(M)\leq 1$.
	
	In particular, $\Ext_R^2(-,-)=0$, hence $\pdim_R(M)\leq 1$ holds as well by Definition~\reff{def:idim/pdim}. If $P$ is projective and $Q\subseteq P$ a submodule, we get an exact sequence 
	\begin{align*}
		0=\Ext_R^1(P,T)\morphism\Ext_R^1(Q,T)\morphism\Ext_R^2(P/Q,T)=0
	\end{align*}
	for any test module $T$ as part of the long exact $\Ext$ sequence. Hence $\Ext_R^1(Q,-)=0$, proving that $Q$ is projective as well. When $M$ is torsion-free and finitely generated, so are its localizations $M_\pp$. Since the $R_\pp$ are PIDs, the $M_\pp$ are projective (and even free), hence $\pdim_R(M)=\sup_\pp\pdim_{R_\pp}(M_\pp)\leq 0$ by Corollary~\reff{cor:projDimLocal} and $M$ is projective.
\end{proof}
\begin{rem*}
	The classification of finitely generated modules over a Dedekind domain is
	\begin{align*}
		M\cong R^{r-1}\oplus I\oplus \bigoplus_{\mm\in\mSpec R}\bigoplus_{k=1}^\infty (R/\mm^kR)^{e_{\mm,k}}\;,
	\end{align*}
	in which only finitely many $e_{\mm,k}$ are non-zero and $I$ is an ideal whose ideal class is uniquely determined by $M$, as is $r$.
\end{rem*}
	
There is a similar result about completion. If $M$ is an $R$-module and $I$ any ideal of $R$, we define a topology (hence a uniform structure) on $M$ with the $I^kM$ as a neighbourhood base of $0\in M$. Completing it gives a module 
\begin{align*}
	\roof{M}=\limit[k\in\IN] M/I^kM\;. 
\end{align*}
If $R$ is Noetherian, $M$ a finitely generated $R$-module and $N\subseteq M$ a submodule, then $N\cap I^kM\subseteq I^{k-c}N$ for $k\geq c$ and a suitable $c$ by the Artin--Rees lemma (cf. \cite[Proposition~3.4.1]{alg2}). It follows that the $I$-adic topology on $N$ is induced from the $I$-adic topology on $M$ and the morphism $\roof{N}\morphism\roof{M}$ corresponding to $N\monomorphism M$ stays injective. Since $\roof{\phantom{x}}$ also commutes with forming quotients, $M\mapsto\roof{M}$ is an exact functor on \emph{finitely generated} $R$-modules (a complete proof may be found in \cite[Lemma~7.15]{eisenbudCommAlg}). 

When $M$ is finitely generated, $\Ext_R^\bullet(M,-)$ may be calculated using a resolution $F_\bullet \morphism M$ of $M$ by finitely generated free modules $F_i\cong R^{n_i}$. Then the $\roof{F}_i$ stay free (of the same rank), so $\roof{F}_\bullet\morphism \roof{M}$ is still a free resolution, and moreover
\begin{align*}
	\Hom_R(F_i,N)^\complete \cong \Hom_R(R^{n_i},N)^\complete \cong (N^{n_i})^\complete \cong \roof{N}^{n_i}\cong \Hom_{\roof{R}}(\roof{F_i},\roof{N})\;.
\end{align*}
Together with exactness of $\roof{\phantom{x}}$ on finitely generated $R$-modules, we obtain
\begin{prop}\lbl{prop:ExtCompletion}
	Let $R$ be a Noetherian ring, $I\subseteq R$ any ideal and $M$ and $N$ finitely generated $R$-modules. Let $p\geq 0$. Then
	\begin{align*}
		\Ext_R^p(M,N)^\complete \cong \Ext_{\roof{R}}^p(\roof{M},\roof{N})
	\end{align*}
	holds for the $I$-adic completions.
\end{prop}
In particular, this implies $\Hom_R(M,N)^\complete \cong\Hom_{\roof{R}}(\roof{M},\roof{N})$ for finitely generated modules $M,N$ over a Noetherian ring $R$.
\begin{cor}\lbl{cor:projDimCompletion}
	Let $R$ be Noetherian. For any finitely generated $R$-module $M$, 
	\begin{align*}		
		\pdim_R(M)\geq\pdim_{\roof{R}}(\roof{M})\;.
	\end{align*}
	When $R$ is local and $I\subsetneq R$ a proper ideal, equality holds.
\end{cor}
\begin{rem*}
	Note that the additional assumptions are \emph{necessary}, though they were missing in the lecture. If $I=R$, the involved completions vanish and equality clearly fails. If $R$ is not required to be local, there are less (but not much) stupid counterexamples such as $R=\IZ$, $I=(2)$ and $M=\IZ/3\IZ$. Then $M=IM$ and the completion $\roof{M}$ vanishes, so the right-hand side becomes $-\infty$ whereas the left-hand side is $1$ (I guess).
\end{rem*}
To prove Corollary~\reff{cor:projDimCompletion}, we need a lemma which has been in the air for quite some time (and probably is well-known).
\begin{lem}\lbl{lem:projectiveDirectSummand}
	Let $R$ be any ring. An $R$-module $P$ is projective iff it is a direct summand of some free module $F$. When $P$ is finitely generated, we can choose $F$ finitely generated as well.
\end{lem}
\begin{proof}
	Suppose that $P$ is projective. Choose a surjective morphism $F\epimorphism[\pi]P$ where $F$ is a free module. If $P$ is finitely generated, we may choose $F$ finitely generated as well. Lifting $\id_P$ to a morphism $P\morphism[s]F$ by the lifting property from Definition~\reff{def:projectiveModule}\itememph{b} induces an isomorphism $\ker(\pi)\oplus P\isomorphism F$ via $(x,p)\mapsto (x,s(p))$.
	
	Now suppose $P\oplus Q=F$ for some free module $F$ and some $Q$. By Definition~\reff{def:projective}\itememph{b} it is sufficient to show that every short exact sequence $0\morphism N\morphism M\morphism P\morphism 0$ splits. Extending by $\id_Q$, we get a surjective map $M\oplus Q\epimorphism[\pi] P\oplus Q=F$. Since $F$ is clearly projective, $\pi$ admits a section $F\morphism[s]M\oplus Q$. Composing $P\monomorphism F\morphism[s]M\oplus Q\epimorphism M$ gives a section of $M\epimorphism P$, so the initial sequence $0\morphism N\morphism M\morphism P\morphism 0$ is indeed split exact.
\end{proof}
We use this to prove an analogue of \eqreff{eq:idim}.
\begin{cor}\lbl{cor:projExtFiniteStuff}
	Let $P$ be a finitely presented $R$-module (e.g., a finitely generated module over a Noetherian ring). Then $P$ is projective iff $\Ext_R^1(P,T)=0$ for all finitely generated $T$.
\end{cor}
\begin{proof}
	Suppose $\Ext_R^1(P,-)$ vanishes on finitely generated $R$-modules (the other direction is trivial). Let $0\morphism K\morphism F\morphism P\morphism 0$ be a short exact sequence in which $K$ and $F$ are finitely generated and $F$ is free. Then 
	\begin{align*}
		0\morphism\Hom_R(P,K)\morphism\Hom_R(P,F)\morphism\Hom_R(P,P)\morphism\Ext_R^1(P,K)=0
	\end{align*}
	is exact, so $\Hom_R(P,F)\morphism\Hom_R(P,P)$ is surjective. A preimage of $\id_P$ gives a split of $0\morphism K\morphism F\morphism P\morphism 0$, so $F\cong K\oplus P$ and $P$ is projective by Lemma~\reff{lem:projectiveDirectSummand}.
\end{proof}
\begin{proof}[Proof of Corollary~\reff{cor:projDimCompletion}]
	Let $F_\bullet M$ be a resolution by finitely generated free $R$-modules. If $\Ext_R^p(-,M)=0$, then the truncation $\snake{\tau}_{\leq p-1}F_\bullet$ is a projective resolution. In particular, $B_{p-1}=\coker(F_p\morphism F_{p-1})$ is projective and by Lemma~\reff{lem:projectiveDirectSummand} we find an $R$-module $Q$ and $n\in\IN$ such that $B_{p-1}\oplus Q\cong R^n$. Then $\roof{B}_{p-1}\oplus\roof{Q}=\roof{R}^n$ and $\roof{B}_{p-1}$ is a projective $\roof{R}$-module by Lemma~\reff{lem:projectiveDirectSummand} again (we used that completion commutes with finite direct sums -- both are special cases of limits and limits commute with limits by the dual of \cite[Corollary~A.1.1]{alggeo2}). Then $\snake{\tau}_{\leq p-1}\roof{F}_\bullet$ is a projective resolution of $\roof{M}$ of length $p-1$. By Fact~\reff{fact:projDim}, this shows $\pdim_R(M)\geq\pdim_{\roof{R}}(\roof{M})$.
	
	Now assume that $R$ is local and $\pdim_R(M)>p$. Then $\snake{\tau}_{\leq p}F_\bullet$ is no projective resolution of $M$ by Fact~\reff{fact:projDim}, and the reason for this must be that $B_p=\coker(F_{p+1}\morphism F_p)$ isn't projective. Then $\Ext_R^1(B_p,T)\neq 0$ for some $R$-module $T$, which we may choose finitely generated by Corollary~\reff{cor:projExtFiniteStuff}. We claim that then also $\Ext_R^1(B_p,T)^\complete \neq 0$. Indeed, $N=\Ext_R^1(B_p,T)$ is finitely generated by Fact~\reff{fact:ExtFinGen}. Let $\nu\in N\setminus IN$ (which exists by the Nakayama lemma and $N\neq 0$). Then the sequence of images of $\nu$ in $N/I^kN$ gives a non-zero element of $\roof{N}=\limit N/I^kN$. By Corollary~\reff{prop:ExtCompletion}, $\Ext_{\roof{R}}^1(\roof{B}_p,\roof{T})\neq 0$ and thus $\roof{B}_p$ is not projective. So $\snake{\tau}_{\leq p}\roof{F}_\bullet$ is no projective resolution of $\roof{M}$, proving $\pdim_{\roof{R}}(\roof{M})>p$ by Fact~\reff{fact:projDim}.
\end{proof}
\section{Torsion products and flat modules}
\begin{defi}
	Let the \defemph{$p\ordinalth$ torsion product} $\Tor_p^R(M,-)$ be the $p\ordinalth$ left-derived functor of $M\otimes_R -$ as a functor from the category of $R$-modules to itself. 
\end{defi}
That is, 
\begin{align}\lbl{eq:TorDef}
	\Tor_i^R(M,N)=H_i(M\otimes_RP_\bullet)
\end{align}
where $P_\bullet \epimorphism N$ is any projective resolution.
\begin{rem*}
	\begin{alphanumerate}
		\item Recall that $M\otimes_RN$ has the universal property
		\begin{align*}
			\Hom_R(M\otimes_RN,T)\cong \operatorname{Bil}_R(M,N;T)
		\end{align*}
		where $\operatorname{Bil}_R(M,N;T)$ denotes the $R$-module of $R$-bilinear maps $M\otimes N\morphism T$.
		\item By definition, for any short exact sequence $\Nn\colon 0\morphism N'\morphism N\morphism N''\morphism 0$ we have a long exact $\Tor$ sequence 
		\begin{multline}\lbl{eq:TorSeq1}
			\ldots\morphism\Tor_{p+1}^R(M,N'')\morphism[\partial]\Tor_p^R(M,N')\morphism\Tor_p^R(M,N)\\
			\morphism\Tor_p^R(M,N'')\morphism[\partial]\Tor_{p-1}^R(M,N')\morphism\ldots
		\end{multline}		
		If $\Mm\colon 0\morphism M'\morphism M\morphism M''\morphism 0$ is another short exact sequence of $R$-modules, then
		\begin{align}\lbl{eq:TorFuncSeq}
			0\morphism (M'\otimes_R -)\morphism (M\otimes _R-)\morphism (M''\otimes_R-)\morphism 0\tag{$*$}
		\end{align}
		is a sequence of functors from $R\cat{-Mod}$ to itself which is exact on free objects $F$. If $P$ is a projective $R$-module, it is a direct summand of some free module $F$ by Lemma~\reff{lem:projectiveDirectSummand}. Then the sequence \eqreff{eq:TorFuncSeq} for $P$ is a direct summand of \eqreff{eq:TorFuncSeq} for $F$ and thus exact as well. That is, \eqreff{eq:TorFuncSeq} is exact on projective objects, so Theorem~\reff{thm:LeftDerivedFunctors}\itememph{c} gives another connecting morphism $\partial\colon \Tor_{p+1}^R(M,N'')\morphism\Tor_p^R(M,N')$ such that
		\begin{multline}\lbl{eq:TorSeq2}
			\ldots\morphism\Tor_{p+1}^R(M'',N)\morphism[\partial]\Tor_p^R(M',N)\morphism\Tor_p^R(M,N)\\
			\morphism\Tor_p^R(M'',N)\morphism[\partial]\Tor_{p-1}^R(M',N)\morphism\ldots\;.
		\end{multline}
		is another long exact sequence.
	\end{alphanumerate}
\end{rem*}
\begin{fact}\lbl{fact:TorProj=0}
	If $i>0$ is positive and one of $M$ or $N$ is projective, then $\Tor_i^R(M,N)=0$.
\end{fact}
\begin{proof}
	If $N$ is projective, it can be taken as a projective resolution of itself and calculating $\Tor_\bullet^R(M,N)$ using \eqreff{eq:TorDef} gives $\Tor_i^R(M,N)=0$ for all $i>0$. 
	
	Now assume that $M$ is projective and let $P_\bullet \epimorphism N$ be any projective resolution. If $M=\bigoplus_{s\in S}R$ (for some indexing set $S$) is free, then $M\otimes_RP_\bullet=\bigoplus_{s\in S}P_\bullet$ is a complex acyclic in positive degrees (as direct sums of exact sequences stay exact), hence the vanishing of $\Tor_\bullet^R(M,N)$ in positive degrees. For general $M$, there is a free $R$-module $F$ with a surjection $F\morphism M$ which splits by projectivity of $M$, making $M$ a direct summand of $F$, hence $M\otimes_RP_\bullet$ a direct summand of $F\otimes_RP_\bullet$ and thus $\Tor_i^R(M,N)$ one of $\Tor_i^R(F,N)=0$ when $i>0$. 
\end{proof}
It follows that $\Tor_\bullet^R(-,N)$ for fixed $N$ has the properties characterizing derived functors (Theorem~\reff{thm:LeftDerivedFunctors}\itememph{b}). That is, $\Tor_\bullet^R(-,N)$ is also the left-derived functor of $-\otimes_RN$. As a consequence of the universal property of derived functors, we get
\begin{prop}\lbl{prop:TorMN=TorNM}
	There is a unique family of isomorphisms $\Tor_i^R(M,N)\isomorphism\Tor_i^R(N,M)$ which exchange \eqreff{eq:TorSeq1} and \eqreff{eq:TorSeq2} in degree $i=0$ coincide with the isomorphism $M\otimes_RN\isomorphism N\otimes_RM$ (sending $m\otimes n$ to $n\otimes m$). The composition
	\begin{align*}
		\Tor_i^R(M,N)\isomorphism \Tor_i^R(N,M)\isomorphism\Tor_i^R(M,N)
	\end{align*}
	is the identity.
\end{prop}
\begin{example}\lbl{ex:TorR/aR}
	Let $a$ be an element of $R$ which is not a zero divisor. Then $0\morphism R\morphism[a\cdot ]R\morphism R/aR\morphism 0$ is a projective resolution of $R/aR$ which may be used to calculate $\Tor_i^R(M,R/aR)$. We obtain
	\begin{align*}
		\Tor_i^R(M,R/aR)\cong\begin{cases}
			M/aM & \text{if }i=0\\
			\ker(M\morphism[a\cdot ]M) & \text{if }i=1\\
			0 & \text{else}
		\end{cases}\;.
	\end{align*}
\end{example}
In the same way as Fact~\reff{fact:atimesExt} for $\Ext$, we see that the following Fact~\reff{fact:atimesTor} holds.
\begin{fact}\lbl{fact:atimesTor}
	For $a\in R$ and any $R$-modules $M$ and $N$ the following coincide.
	\begin{alphanumerate}
		\item The multiplication $a\cdot $ on the $R$-module $\Tor_i^R(M,N)$.
		\item The endomorphism $\Tor_i^R(M,N)\morphism\Tor_i^R(M,N)$ induced by $M\morphism[a\cdot ]M$ and functoriality of $\Tor_R^k(-,N)$.
		\item The endomorphism $\Tor_i^R(M,N)\morphism\Tor_i^R(M,N)$ induced by $N\morphism[a\cdot ]N$ and functoriality of $\Tor_i^R(M,-)$.
	\end{alphanumerate}
\end{fact}
When the ring $R$ is Noetherian and $M$ is finitely generated, the torsion product may be calculated using a free resolution $0\lmorphism M\lmorphism R^{n_0}\lmorphism R^{n_1}\lmorphism\ldots$ by finitely generated $R$-modules. Using Proposition~\reff{prop:TorMN=TorNM} and \eqreff{eq:TorDef} we get
\begin{align*}
	\Tor_\bullet^R(M,N)=H_\bullet\left(N^{n_0}\lmorphism N^{n_1}\lmorphism\ldots\right)\;.
\end{align*}
When $N$ is also finitely generated, this clearly shows
\begin{fact}
	When $R$ is Noetherian  and $M,N$ finitely generated $R$-modules, then the $\Tor_i^R(M,N)$ are finitely generated $R$-modules as well.
\end{fact}
And we need compatibility with localization of course.
\begin{fact}\lbl{fact:TorLocal}
	Let $M$ and $N$ are modules over a ring $R$ and $S$ a multiplicative subset of $R$. Then there are unique isomorphisms
	\begin{align*}
		\Tor_\bullet^R(M,N)_S\cong \Tor_\bullet^R(M,N_S)\cong \Tor_\bullet^R(M_S,N)\cong \Tor_\bullet^R(M_S,N_S)\cong \Tor_\bullet^{R_S}(M_S,N_S)
	\end{align*}
	compatible with \eqreff{eq:TorSeq1} and \eqreff{eq:TorSeq2} and in degree $0$ equal to the isomorphisms
	\begin{align*}
		(M\otimes _RN)_S\cong M\otimes _RN_S\cong M_S\otimes _RN\cong M_S\otimes _RN_S\cong {M_S}\otimes _{R_S}N_S
	\end{align*}
\end{fact}
\begin{proof}
	The constructions on the right-hand side are homological functors of $M$ and $N$ which annullate free $R$-modules and hence also their direct summands, i.e., projective modules (Lemma~\reff{lem:projectiveDirectSummand}) in higher degrees as follows: Let $i>0$, then $\Tor_i^R(M,N_S)=0$ when $M$ is projective, $\Tor_i^R(M_S,N)=0$ when $N$ is projective, and $\Tor_i^{R_S}(M_S,N_S)=0$ when $M$ or $N$ are projective (indeed, localizing preserves the property of being a direct summand of some free module). In degree $0$ they agree up to the isomorphisms above. By Theorem~\reff{thm:LeftDerivedFunctors}\itememph{b} and the universal property of derived functors, we deduce the required canonical isomorphisms
	\begin{align*}
		\Tor_\bullet^R(M,N)_S\cong \Tor_\bullet^R(M,N_S)\cong \Tor_\bullet^R(M_S,N) \cong \Tor_\bullet^{R_S}(M_S,N_S)\;.
	\end{align*}
	It remains to prove $\Tor_\bullet^R(M,N)_S\cong \Tor_\bullet^R(M_S,N_S)$. But this can be obtained from the composition $\Tor_\bullet^R(M,N)_S\isomorphism \Tor_\bullet^R(M,N_S)\isomorphism \Tor_\bullet^R(M_S,N_S)$.
\end{proof}
By the tensor-hom adjunction, the functor $M\otimes_R-$ is left-adjoint to $\Hom_R(M,-)$, hence commutes with arbitrary colimits (by \cite[Corollary~A.1.1]{alggeo2}). That is, for any system $(N_\lambda)_{\lambda\in\Lambda}$ we have
\begin{align*}
	M\otimes_R\colimit[\lambda\in\Lambda]N_\lambda&\isomorphism \colimit[\lambda\in\Lambda]M\otimes_RN_\lambda\\
	m\otimes\left(\text{image of }n_\lambda\text{ in }\colimit N_\lambda\right)&\longmapsto \left(\text{image of }m\otimes n_\lambda\text{ in }\colimit M\otimes_RN_\lambda\right)\;.
\end{align*}
Also recall that \emph{filtered} colimits are exact\footnote{To see they commute with kernels you can use that filtered colimits taken in $R\cat{-Mod}$ are the same as being taken in $\cat{Set}$; commutativity with cokernels is automatically true by \cite[Corollary~A.1.1]{alggeo2}.}, hence commute with taking homology. We thus obtain
\begin{fact}\lbl{fact:TorCommutesWithColims}
	Torsion products are compatible with filtered colimits. That is, for a filtered system $(N_\lambda)_{\lambda\in\Lambda}$ of $R$-modules we have an isomorphism
	\begin{align*}
		\Tor_\bullet^R\bigg(M,\colimit[\lambda\in\Lambda]N_\lambda\bigg)\lisomorphism \colimit[\lambda\in\Lambda]\Tor_\bullet^R(M,N_\lambda)\;.
	\end{align*}
\end{fact}
\begin{prop}\lbl{prop:TorVanishing}
	For an $R$-module $M$ the following conditions are equivalent.
	\begin{alphanumerate}
		\item The functor $M\otimes _R-$ is exact.
		\item $\Tor_i^R(M,N)=0$ when $i>0$ and $N$ is any $R$-module.
		\item $\Tor_i^R(M,N)=0$ when $i>0$ and $N$ is finitely generated.
		\item $\Tor_1^R(M,N)=0$ for any $R$-module $N$.
		\item $\Tor_1^R(M,N)=0$ when $N$ is finitely generated.
	\end{alphanumerate}
\end{prop}
\begin{proof}
	The implication \itememph{a} $\Rightarrow$ \itememph{b} is clear from \eqreff{eq:TorDef}. Also \itememph{b} $\Rightarrow$ \itememph{c} $\Rightarrow$ \itememph{e} and \itememph{b} $\Rightarrow$ \itememph{d} $\Rightarrow$ \itememph{e} are trivial. To see \itememph{e} $\Rightarrow$ \itememph{d}, use that any $R$-module $N$ can be written as a filtered colimit over its finitely generated submodules and then apply Fact~\reff{fact:TorCommutesWithColims}. Finally, the implication \itememph{d} $\Rightarrow$ \itememph{a} is clear from the long exact $\Tor$ sequence \eqreff{eq:TorSeq1}. 
\end{proof}
\begin{defi}
	An $R$-module with these properties is called \defemph{flat}.
\end{defi}
For flatness, there is a criterion similar to Baer's (Proposition~\reff{prop:InjectiveModules}) for injectivity.
\begin{prop}\lbl{prop:flatConditions}
	If $R$ is a ring and $M$ and $R$-module, the following are equivalent.
	\begin{alphanumerate}
		\item $M$ is flat.
		\item For any ideal $I\subseteq R$ we have $\Tor_1^R(M,R/I)=0$.
		\item For any ideal $I\subseteq R$, the morphism $I\otimes_RM\morphism I\cdot M$ sending $i\otimes m$ to $i\cdot m$ is an isomorphism.
		\item For any ideal $I\subseteq R$, the morphism $I\otimes_RM\morphism I\cdot M$ sending $i\otimes m$ to $i\cdot m$ is injective.
	\end{alphanumerate}
	When $R$ is Noetherian, each of \itememph{b}, \itememph{c} and \itememph{d} may be weakened to $I$ being a prime ideal.
\end{prop}
\begin{proof}
	The implication \itememph{a} $\Rightarrow$ \itememph{b} is trivial, as is \itememph{c} $\Leftrightarrow$ \itememph{d}, since the $i\cdot m$ generate $I\cdot M$, so the morphism in question is automatically surjective.
	
	For \itememph{b} $\Leftrightarrow$ \itememph{d} use the diagram
	\begin{diagram*}
		\node[ob] (IoM) at (0,0)  {$I\otimes_RM$};
		\node[ob] (TorRIM) [left=0.575 of IoM] {$\Tor_1^R(R/I,M)$};
		\node[ob] (TorRM) [left=0.575 of TorRIM] {$0=\Tor_1^R(R,M)$};
		\node[ob] (RM) [right=0.575 of IoM] {$R\otimes_RM$};
		\node[ob] (IM) at (0,-1.5) {$I\cdot M$};
		\node[ob] (M) at (IM-|RM)  {$M$};
		%\path (IM) -- (M) node[pos=0.5] {$\subseteq$};
		\scriptsize
		\draw[->] (TorRM) -- (TorRIM);
		\draw[->] (TorRIM) -- (IoM) node[pos=0.5, above] {$\partial$};
		\draw[->] (IoM) -- (RM);
		\draw[->] (IoM) -- (IM) node[pos=0.5,left] {\itememph{d}};
		\draw[->] (RM) -- (M) node[pos=0.5,above=-0.25ex, sloped] {$\sim$};
		\draw[right hook->] (IM) -- (M);
	\end{diagram*}
	in which the top row is exact. This shows that $I\otimes_RM\morphism I\cdot M$ is injective iff $0=\Tor_1^R(R/I,M)$ and $\Tor_1^R(R/I,M)\cong\Tor_1^R(M,R/I)$ by Proposition~\reff{prop:TorMN=TorNM}, proving the desired equivalence.
	
	And finally \itememph{b} $\Rightarrow$ \itememph{a}. We show that Proposition~\reff{prop:TorVanishing}\itememph{e} is fulfilled using induction on the number $n$ of generators of $N$. If $n=0$, then $N=0$ and the assertion is trivial. Now assume $n>0$ and the assertion is valid for fewer than $n$ generators. Let $N'\subseteq N$ be the submodule generated by the first $n-1$ generators. Then $N''=N/N'$ is generated by the (image of the) remaining generator, hence isomorphic to $R/I$ for the ideal $I=\Ann_R(N'')$. We get
	\begin{align*}
		0=\Tor_1^R(M,N')\morphism\Tor_1^R(M,N)\morphism\Tor_1^R(M,N'')=0
	\end{align*}
	as part of the exact sequence \eqreff{eq:TorSeq2}, in which $\Tor_1^R(M,N')$ vanishes by the induction hypothesis and $\Tor_1^R(M,N'')$ by \itememph{b}. Hence $\Tor_1^R(M,N)$ vanishes as well.
	
	When $R$ is Noetherian, we can apply the same induction on a finite filtration $0=N_0\subsetneq N_1\subsetneq\ldots\subsetneq N_k=N$ having the property that $N_i/N_{i-1}\cong R/\pp_i$ for some $\pp_i\in\Spec R$ to show $\Tor_1^R(M,N_i)=0$ inductively. If you don't know the existence of such a filtration, Professor Franke suggests you spend 2 hours reading Matsumura's \href{http://www.math.unam.mx/javier/Matsumura.pdf}{\emph{Commutative Ring Theory}} \cite{matsumuraCRT} as a punishment, until you stumble upon that result\footnote{Alternatively (and providing a proof by Franke himself), have a look at \cite[Proposition~3.1.2\itememph{a}]{alg2}.} (and it seemed like he found that genuinely amusing).
\end{proof}
\begin{rem*}
	As the proof shows, \itememph{b} $\Leftrightarrow$ \itememph{c} $\Leftrightarrow$ \itememph{d} already holds when $I$ is fixed.
\end{rem*}
\begin{cor}\lbl{cor:DedekindFlat}
	A module $M$ over a Dedekind domain $R$ is flat iff it is torsion-free.
\end{cor}
\begin{proof}
	When $R$ is a PID, by Proposition~\reff{prop:flatConditions}\itememph{b} all we need to check is that $\Tor_1^R(M,R/aR)=0$ for all $a\in R$. By Example~\reff{ex:TorR/aR} this is equivalent to $M$ being torsion-free. When $R$ is an arbitrary Dedekind domain, we may check for flatness locally (by the upcoming Fact~\reff{fact:flatVeryLocal}\itememph{e}) and the $R_\pp$ are all PIDs for $\pp\in \Spec R$. So $M$ is flat iff all its localizations $M_\pp$ are torsion-free, and just like in the proof of Corollary~\reff{cor:DedekindInjective} this holds iff $M$ is torsion-free.
\end{proof}
\begin{rem*}
	In particular, the proof shows that flat modules over arbitrary rings are always torsion-free.
\end{rem*}
\begin{example}\lbl{ex:projFlat}
	Every projective module is flat (Fact~\reff{fact:TorProj=0} and Proposition~\reff{prop:flatConditions}\itememph{b}).
\end{example}
\begin{fact}\lbl{fact:flatVeryLocal}
	For a module $M$ over an arbitrary ring $R$ the following conditions are equivalent.
	\begin{alphanumerate}
		\item $M$ is flat.
		\item For any multiplicative subset $S\subseteq R$, $M_S$ is a flat $R$-module.
		\item For any multiplicative subset $S\subseteq R$, $M_S$ is a flat $R_S$-module.
		\item For every maximal ideal $\mm$, $M_\mm$ is a flat $R$-module.
		\item For every maximal ideal $\mm$, $M_\mm$ is a flat $R_\mm$-module.
	\end{alphanumerate}
\end{fact}
\begin{proof}
	The implications \itememph{a} $\Rightarrow$ \itememph{b}, \itememph{c} follow from Proposition~\reff{prop:flatConditions}\itememph{b} and Fact~\reff{fact:TorLocal}. Moreover the implications \itememph{b} $\Rightarrow$ \itememph{d} as well as \itememph{c} $\Rightarrow$ \itememph{e} are trivial.
	
	Now if any of \itememph{d} or \itememph{e} holds and $I\subseteq R$ is an ideal, then
	\begin{align*}
		\Tor_1^R(M,R/I)_\mm\cong \Tor_1^R(M_\mm,R/I)\cong \Tor_1^{R_\mm}(M_\mm,R_\mm/I_\mm)=0
	\end{align*}
	for every maximal ideal $\mm$ of $R$ by Fact~\reff{fact:TorLocal}. It's a well-known fact that an $R$-module $N$ vanishes iff all its localizations $N_\mm$ at maximal ideals vanish. Hence $\Tor_1^R(M,R/I)=0$, showing that $M$ is flat (i.e., \itememph{a} holds) by Proposition~\reff{prop:flatConditions}\itememph{b}.
\end{proof}
\begin{example}
	Over a Dedekind domain $R$ with quotient field $K$, the modules $K$, any completion of $R$ and $\prod_{i=1}^{\infty}R$ are flat (indeed, they're torsion-free and we have Corollary~\reff{cor:DedekindFlat}), but usually not projective.
\end{example}
\begin{example}
	If $S\subseteq R$ is a multiplicative subset, $R_S$ is a flat $R$-module. Indeed, this follows from Fact~\reff{fact:flatVeryLocal}\itememph{b} since $R$ is flat over itself. $R_S$ being flat also follows from the localization functor being exact.
\end{example}
\begin{example}\lbl{ex:CompletionFlat}
	The completion $\roof{R}$ of a Noetherian ring $R$ with respect to any ideal $I$ is a flat $R$-module. When $M$ is a finitely generated flat $R$-module, its completion $\roof{M}$ is a flat $\roof{R}$-module.
\end{example}
\begin{proof}
	For finitely generated $R$-modules $M$ we have an isomorphism $M\otimes_R\roof{R}\isomorphism \roof{M}$. Indeed, this is true when $M=R$ and both sides commute with taking cokernels and finite direct sums, since completion is exact on finitely generated $R$-modules (cf.\ \cite[Lemma~7.15]{eisenbudCommAlg}). Thus $-\otimes_R\roof{R}$ is an exact functor on finitely generated $R$-modules. Applying this to any finitely generated free resolution of $R/I$ shows $\Tor_1^R(\roof{R},R/I)=0$ for any ideal $I\subseteq R$, so $\roof{R}$ is flat by Proposition~\reff{prop:flatConditions}\itememph{b}.
	
	Now let $M$ be a finitely generated flat $R$-module. Since $\roof{M}\cong M\otimes_R\roof{R}$, the functor $-\otimes_{\roof{R}}\roof{M}$ is exact because both tensoring by $M$ and $\roof{R}$ is exact. Thus $\roof{M}$ stays flat.\footnote{And more generally, tensor products of flat modules are clearly flat again.}
\end{proof}
\begin{example}\lbl{ex:productOfFlatsIsFlat}
	The product of arbitrarily many flat modules over a Noetherian ring is flat again.
\end{example}
\begin{proof}
	Let $(M_j)_{j\in J}$ be a family of $R$-modules. Let $I$ be any ideal of $R$ and $0\lmorphism R/I\lmorphism R^{n_0}\lmorphism R^{n_1}\lmorphism\ldots$ any free resolution by finitely generated free modules, then
	\begin{align*}
		\Tor_p^R\bigg(\prod_{j\in J}M_j,R/I\bigg)&\cong H_p\bigg(\prod_{j\in J}M_j^{n_0}\lmorphism\prod_{j\in J}M_j^{n_1}\lmorphism\ldots \bigg)\\
		&\cong \prod_{j\in J} H_p\left(M_j^{n_0}\lmorphism M_j^{n_0}\lmorphism\ldots\right)
	\end{align*}
	and the right-hand side vanishes by Proposition~\reff{prop:TorVanishing} when $p>0$ and the $M_j$ are flat. Hence $\prod_{j\in J}M_j$ is flat by Proposition~\reff{prop:flatConditions}\itememph{b}.
\end{proof}
\begin{example}\lbl{ex:coprodOfFlatsIsFlat}
	The coproduct of arbitrarily many flat modules over any ring is flat. Indeed, for arbitrary indexing sets $J$ the $\bigoplus_{j\in J}-$ functor is exact and commutes with tensor products, hence with $\Tor$.
\end{example}
\begin{fact}\lbl{fact:flatDim}
	For any $R$-module $M$, the following are equivalent.
	\begin{alphanumerate}
		\item $\Tor_p^R(M,T)=0$ when $p>d$ for any $R$-module $T$.
		\item $\Tor_{d+1}^R(M,T)=0$ for any $R$-module $T$.
		\item $\Tor_p^R(M,T)=0$ when $p>d$ for any finitely generated $R$-module $T$.
		\item $\Tor_{d+1}^R(M,T)=0$ for any finitely generated $R$-module $T$.		
		\item $\Tor_p^R(M,R/I)=0$ when $p>d$ for any ideal $I\subseteq R$.
		\item $\Tor_{d+1}^R(M,R/I)=0$ for any ideal $I\subseteq R$.
	\end{alphanumerate}
	Moreover, when $R$ is Noetherian, it is enough to have \itememph{e} or \itememph{f} for prime ideals.
\end{fact}
\begin{proof}
	Clearly, it is enough to show that \itememph{f} $\Rightarrow$ \itememph{a}. Suppose that \itememph{f} holds (resp.\ the even weaker prime ideal condition when $R$ is Noetherian). We can use the inductive argument from the proof of Proposition~\reff{prop:flatConditions} to show $\Tor_{d+1}(M,T)=0$ for every finitely generated $R$-module $T$. Since every $R$-module $T$ is the direct colimit of its finitely generated submodules, Fact~\reff{fact:TorCommutesWithColims} allows us to drop the finitely generatedness of $T$, i.e., we obtain \itememph{b}.
	
	Now assume that for some $p>d$, vanishing of $\Tor_p^R(M,-)$ has been shown. Let $T$ be any $R$-module. Choose an epimorphism $F\epimorphism[\pi]T$ for some free $R$-module $F$. From the long exact $\Tor$ sequence associated to $0\morphism \ker(\pi)\morphism F\morphism T\morphism 0$ we obtain
	\begin{align*}
		0=\Tor_{p+1}^R(M,F)\morphism\Tor_{p+1}^R(M,T)\morphism\Tor_p^R(M,\ker (\pi))=0\;,
	\end{align*}
	hence $\Tor_{p+1}^R(M,T)=0$. This shows \itememph{a}.
\end{proof}
\begin{defi}\lbl{def:flatDim}
	The largest natural number $d$ such that the equivalent properties from Fact~\reff{fact:flatDim} fail\footnote{\emph{Yes}, we want them to fail. The reason we define \emph{flat dimension} that way (in particular \emph{not} in the way the lecture did), is to be consistent with projective and injective dimension. Otherwise, stuff like Corollary~\reff{cor:pdim=fdim} fails for $M=0$.} (or $+\infty$ if no such $d$ exists, or $-\infty$ if $M=0$) is called the \defemph{flat dimension} of $M$ and denoted $\fdim_R(M)$.
\end{defi}
\begin{fact}\lbl{fact:flatDimLocal}
	Let $M$ be a module over an arbitrary ring $R$. Then
	\begin{alphanumerate}
		\item $\fdim_R(M)\leq \pdim_R(M)$.
		\item $\fdim_R(M)=\sup\left\{\fdim_{R_\mm}M_\mm\st\mm\in\mSpec R\right\}=\sup\left\{\fdim_RM_\mm\st \mm\in\mSpec R\right\}$.
		\item $\fdim_R(M)=\sup\left\{\fdim_{R_\pp}M_\pp\st \pp\in\Spec R\right\}=\sup\left\{\fdim_RM_\pp\st \pp\in\Spec R\right\}$.
	\end{alphanumerate}
\end{fact}
\begin{proof}
	If $\pdim_R(M)=\ell$, then $M$ has a projective resolution of length $\ell$ by Fact~\reff{fact:projDim}. Using this resolution to compute $\Tor_\bullet^R(M,-)$ we see that $\Tor_p^R(M,-)=0$ for $p>\ell$, hence $\fdim_R(M)\leq \ell$. This shows \itememph{a}.
	
	To show \itememph{b} and \itememph{c}, use Fact~\reff{fact:TorLocal} and do the same as in the proof of Corollary~\reff{cor:projDimLocal}.
\end{proof}
\begin{rem*}
	Examples~\reff{ex:CompletionFlat}, \reff{ex:productOfFlatsIsFlat}, and \reff{ex:coprodOfFlatsIsFlat} remain true for the class of $R$-modules of flat dimension $\leq d$. In fact, we can basically copy the proofs (modulo using the upcoming Proposition~\reff{prop:TorCompletion}).
\end{rem*}
\begin{prop}\lbl{prop:flatResolution}
	For an $R$-module $M$, the following are equivalent.
	\begin{alphanumerate}
		\item $\fdim_R(M)\leq d$.
		\item $M$ has a \defemph{flat resolution} of length $d$, i.e., an exact sequence
		\begin{align}\lbl{eq:flatResolution}
			0\lmorphism M\lmorphism F_0\lmorphism \ldots\lmorphism F_d\lmorphism 0
		\end{align}
		with flat $F_i$. When $M$ is finitely generated and $R$ is Noetherian, we may assume that the $F_i$ are finitely generated as well.
		\item For any sequence like \eqreff{eq:flatResolution} in which $F_0,\ldots,F_{d-1}$ are flat, $F_d$ is flat as well.
	\end{alphanumerate}
\end{prop}
\begin{proof}
	Put $B_i=\Im(F_{i+1}\morphism F_i)=\ker(F_i\morphism F_{i-1})$ and $B_{-1}\coloneqq M$. From \eqreff{eq:flatResolution} we get short exact sequences $0\morphism B_i\morphism F_i\morphism B_{i-1}\morphism 0$ for $i=0,\ldots,d-1$. Thus
	\begin{align*}
		\Tor_{p+1}^R(F_i,T)\morphism \Tor_{p+1}^R(B_{i-1},T)\morphism \Tor_p^R(B_i,T)\morphism\Tor_p^R(F_i,T)
	\end{align*}
	is exact for any $R$-module $T$ by the long exact $\Tor$ sequence. If $F_1,\ldots,F_{d-1}$ in \eqreff{eq:flatResolution} are flat, the outer terms vanish by Proposition~\reff{prop:TorVanishing}, which shows $\Tor_{p+1}^R(B_{i-1},T)\cong \Tor_p^R(B_i,T)$. Since $F_d\cong B_{d-1}$, we get thus get $\Tor_p^R(F_d,T)\cong \Tor_{p+d}^R(M,T)$ for any test module $T$. In particular, $\Tor_1^R(F_d,-)=0$ iff $\Tor_{d+1}^R(M,-)=0$.
	
	Note that a resolution like \eqreff{eq:flatResolution} in which $F_0,\ldots,F_{d-1}$ are flat always exists (e.g., soft-truncate any free resolution of $M$). In view of Fact~\reff{fact:flatDim}\itememph{b} and Proposition~\reff{prop:TorVanishing}\itememph{d}, equivalence of \itememph{a}, \itememph{b}, and \itememph{c} is easily deduced.
\end{proof}

Looking at the above proof again, we find
\begin{fact}
	If $0\morphism N\morphism F\morphism M\morphism 0$ is a short exact sequence of $R$-modules and $F$ flat, then 
	\begin{align*}
		\fdim_R(N)=\max\{\fdim_R(M)-1,0\}\;.
	\end{align*}
\end{fact}
And finally we prove that $\Tor$ -- for finitely generated modules over Noetherian rings -- is compatible with completions.
\begin{prop}\lbl{prop:TorCompletion}
	Let $\roof{\phantom{x}}$ denote the completion with respect to an arbitrary ideal $I$ in a Noetherian ring $R$. For all finitely generated $R$-modules $M,N$,
	\begin{align*}
		\Tor_i^{\roof{R}}(\roof{M},\roof{N})\cong \Tor_i^R(M,N)^\complete \;.
	\end{align*}
\end{prop}
\begin{proof}
	Choose a finitely generated free resolution $0\lmorphism N\lmorphism R^{n_0}\lmorphism R^{n_1}\lmorphism\ldots$ of $N$. Then $0\lmorphism \roof{N}\lmorphism \roof{R}^{n_0}\lmorphism \roof{R}^{n_1}\lmorphism\ldots$ is a free resolution of $\roof{N}$ by exactness of $\roof{\phantom{x}}$ on finitely generated $R$-modules. Thus
	\begin{align*}
		\Tor_i^{\roof{R}}(\roof{M},\roof{N})&\cong H_i\left(\roof{M}^{n_0}\lmorphism \roof{M}^{n_1}\lmorphism\ldots\right)\cong  H_i\left(M^{n_0}\lmorphism M^{n_1}\lmorphism\ldots\right)^\complete \cong \Tor_i^R(M,N)^\complete \;,
	\end{align*}
	since $\roof{\phantom{x}}$ commutes with (finitely generated) homology by exactness on finitely generated $R$-modules.
\end{proof}
\section{The case of finitely generated modules over Noetherian rings}
\begin{prop}\lbl{prop:FreeProjFlatTor}
	Let $P$ be a finitely generated module over a Noetherian local ring $R$ with maximal ideal $\mm$ and residue field $k=R/\mm$. Then the following are equivalent.
	\begin{alphanumerate}
		\item $P$ is free.
		\item $P$ is projective.
		\item $P$ is flat.
		\item $\Tor_1^R(P,k)=0$.
		\item $\Tor_1^{\roof{R}}(\roof{P},k)=0$, where $\roof{\phantom{x}}$ denotes the completion with respect to $\mm$.
	\end{alphanumerate}
\end{prop}
\begin{proof}
	The implications \itememph{a} $\Rightarrow$ \itememph{b} $\Rightarrow$ \itememph{c} $\Rightarrow$ \itememph{d} are pretty much clear (every free module is projective, and we have Example~\reff{ex:projFlat} and Proposition~\reff{prop:TorVanishing}\itememph{d}). To see \itememph{d} $\Leftrightarrow$ \itememph{e}, note that $\roof{R}$ is again a local ring with residue field $k$ (this is quite easy to see; also, cf.\ \cite[p.~192]{eisenbudCommAlg}). Recall that we have seen in the proof of Corollary~\reff{cor:projDimCompletion} that an $R$-module vanishes iff its completion (at any proper ideal $I\subsetneq R$) does, provided $R$ is local. Then Proposition~\reff{prop:TorCompletion} does the job.
	
	Let's show \itememph{d} $\Rightarrow$ \itememph{a}. Choose elements $p_1,\ldots,p_n\in P$ whose images in $P/\mm P\cong P\otimes_Rk$ form a basis of this $k$-vector space. By Nakayama's lemma, $p_1,\ldots,p_n$ also generate $P$. Sending the standard basis vectors $e_i$ to $p_i$ thus gives a surjection $R^n\epimorphism[\pi]P$ which becomes an isomorphism when tensored with $k$. From \itememph{d} and the long exact $\Tor$ sequence we obtain
	\begin{align*}
		0=\Tor_1^R(P,k)\morphism \ker(\pi)\otimes_Rk\morphism k^n\morphism P\otimes_Rk\morphism 0\;.
	\end{align*} 
	Since $k^n\morphism P\otimes_Rk$ is an isomorphism, this shows $\ker(\pi)\otimes_Rk=0$, hence $\ker(\pi)=0$ by Nakayama's lemma. We find that $\pi$ is already an isomorphism and $P\cong R^n$ is free.
\end{proof}
\begin{cor}\lbl{cor:pdim=fdim}
	For a finitely generated module $M$ over a Noetherian local ring $R$ with maximal ideal $\mm$ and residue field $k$, we have
	\begin{align*}
		\pdim_R(M)=\fdim_R(M)=\sup\left\{d\st \Tor_d^R(M,k)\neq 0\right\}\;.
	\end{align*}
\end{cor}
\begin{proof}
	The first equality is immediate from Fact~\reff{fact:projDim} and Proposition~\reff{prop:flatResolution}\itememph{b} since flat and projective is the same for finitely generated modules over Noetherian local rings by Proposition~\reff{prop:FreeProjFlatTor}. The second equality follows by looking over the proof of Proposition~\reff{prop:flatResolution} again, since in our situation it suffices to check $\Tor_1^R(F,k)=0$ to show flatness of some finitely generated $R$-module $F$ by Proposition~\reff{prop:FreeProjFlatTor}\itememph{d}.
\end{proof}
\begin{cor}\lbl{cor:fdim(k)}
	For any module $M$ over a Noetherian local ring $R$, $\fdim_R(M)\leq \fdim_R(k)$.
\end{cor}
\begin{proof}
	By Proposition~\reff{prop:TorMN=TorNM} and Fact~\reff{fact:flatDim}\itememph{d}, $\fdim_R(k)$ is smallest integer $d$ such that $0=\Tor_{d+1}^R(k,M)\cong \Tor_{d+1}^R(M,k)$ for all finitely generated $R$-modules $M$. Then $\fdim_R(M)\leq \fdim_R(k)$ for $M$ finitely generated follows immediately from Corollary~\reff{cor:pdim=fdim}. Now let $M$ be arbitrary, $p>\fdim_R(k)$ and $I\subseteq R$ be any ideal. We have $\Tor_p^R(R/I,M)=0$ since $R/I$ is finitely generated and thus $p>\fdim_R(R/I)$ by what we just proved. But $\Tor_p^R(R/I,M)\cong\Tor_p^R(M,R/I)$, so Fact~\reff{fact:flatDim}\itememph{e} shows $\fdim_R(M)<p$ as well.
\end{proof}
\begin{cor}
	If $M$ is a finitely generated module over a Noetherian ring $R$ (local or not), then $\pdim_R(M)=\fdim_R(M)$.
\end{cor}
\begin{proof}
	Follows from Fact~\reff{fact:flatDimLocal}, Corollary~\reff{cor:projDimLocal} and Corollary~\reff{cor:pdim=fdim}.
\end{proof}
\begin{prop}
	For a finitely generated module $M$ over a Noetherian ring $R$ the following are equivalent.
	\begin{alphanumerate}
		\item $M$ is projective.
		\item $M$ is flat.
		\item It is possible to cover $\Spec R$ by open subsets $\Spec R_{f}$ for $f\in R$ such that $M_f$ is a free $R_f$-module.
		\item The sheaf of modules $\snake{M}$ on $\Spec R$ (cf.\ \cite[Definition~1.4.1]{alggeo1}) is a vector bundle, i.e., a locally free $\Oo_{\Spec R}$-module.
		\item $M_\mm$ is free for any maximal ideal $\mm$ of $R$.
		\item $M_\pp$ is free for any $\pp\in\Spec R$.
	\end{alphanumerate}
\end{prop}
\begin{proof}
	By Corollary~\reff{cor:projDimLocal}, $M$ is projective iff $M_\mm$ is projective for all maximal ideals $\mm$ of $R$ iff $M_\pp$ is projective for all $\pp\in\Spec R$. The same holds for flatness by Fact~\reff{fact:flatDimLocal}\itememph{b} and \itememph{c}. By Proposition~\reff{prop:FreeProjFlatTor}, we see that \itememph{a}, \itememph{b}, \itememph{e}, and \itememph{f} are equivalent. Equivalence of \itememph{c} and \itememph{d} is pretty much the definition of vector bundles (using the fact that the $\Spec R_f\cong \Spec R\setminus V(f)$ form a topology base of $\Spec R$ and \cite[Proposition~1.4.1]{alggeo1}). The implication \itememph{c} $\Rightarrow$ \itememph{f} is trivial. 
	
	To derive \itememph{f} $\Rightarrow$ \itememph{c} one uses the Nakayama argument from \cite[Corollary~1.5.1]{alg2}, but Professor Franke decided to repeat it here, so we will include it again in Lemma~\reff{lem:locFree}.
\end{proof}
\begin{lem}\lbl{lem:locFree}
	Let $M$ be a finitely generated module over a Noetherian ring $R$ and $\pp\in\Spec R$ a prime ideal such that $M_\pp$ is a free $R_\pp$ module. Then there is an $f\in R\setminus\pp$ such that $M_f$ is already free over $R_f$.
\end{lem}
\begin{proof}
	Let $m_1,\ldots,m_k\in M$ whose images are free generators of $M_\pp$ over $R_\pp$ and let $g_1,\ldots,g_n\in M$ be generators of $M$ as an $R$-module. By assumption, there are $\rho_{i,j}\in R_\pp$ such that
	\begin{align}\lbl{eq:gjInR_p}
		g_j=\sum_{i=1}^k\rho_{i,j}m_i\quad\text{in }M_\pp\;.\tag{$*$}
	\end{align}
	Since there are only finitely many $\rho_{i,j}$, we may choose a common denominator $f$, such that $\rho_{i,j}=r_{i,j}\cdot f^{-1}$ with $r_{i,j}\in R$. Replacing $R$ by $R_f$ and $M$ by $M_f$ we thus may assume $\rho_{i,j}\in R$. Then \eqreff{eq:gjInR_p} shows that there are $f_j\in R\setminus \pp$ such that
	\begin{align*}
		f_j\bigg(g_j-\sum_{i=1}^k\rho_{i,j}m_i\bigg)=0\;.
	\end{align*}
	Putting $f=f_1\cdots f_k$, we see that \eqreff{eq:gjInR_p} already holds in $M_f$. So replacing $R$ by $R_f$ and $M$ by $M_f$ again, we may assume that the $m_i$ generate $M$ as an $R$-module.
	
	Let $N\subseteq R^k$ be the kernel of $R^k\epimorphism M$ sending the $i\ordinalth$ standard basis vector to $m_i$. We have a short exact sequence $0\morphism N\morphism R^k\morphism M\morphism 0$. Localizing at $\pp$ gives $0\morphism N_\pp\morphism R_\pp^k\morphism M_\pp\morphism 0$ which is still exact, since localization is an exact functor. Moreover, $R_\pp^k\epimorphism M_\pp$ is an isomorphism by choice of the $m_i$, hence $N_\pp=0$. So if $g_1,\ldots,g_n$ are generators of $N$ (and here we use Noetherianness), then $f_ig_i=0$ in $R$ for some $f_i\in R\setminus \pp$. Putting $f=f_1\cdots f_n$, we get $N_f=0$, hence $R_f^k\cong M_f$ and we are done.
\end{proof}
\begin{rem*}
	Somehow related is the \emph{Serre conjecture} (Serre, 1955) that every finitely generated projective module over a polynomial ring $k[X_1,\ldots,X_n]$ (with $k$ a field) is free. It was proved in 1976 independently by Quillen and Suslin.
\end{rem*}
Though it wasn't featured in the lecture, I would like to add some remarks on the \emph{global dimension} of a ring and vanishing bounds for $\Ext$ and $\Tor$.
\begin{defi}\lbl{def:gdim}
	Let $R$ be a ring. The \defemph{cohomological} or \defemph{global dimension} $\gdim(R)$ of the category of $R$-modules is defined as
	\begin{align*}
	\gdim(R)=\sup\left\{\pdim_R(M)\st M\text{ is an }R\text{-module}\right\}\;.
	\end{align*}
\end{defi}
Note that the usual notation suggests $\gdim(R)$ is a property of $R$, whereas Professor Franke explicitly formulated it as a property of the category of $R$-modules.
\begin{cor}
	Let $R$ be any ring. The following coincide.
	\begin{alphanumerate}
		\item The global dimension $\gdim(R)$.
		\item $\sup\left\{\idim_R(M)\st M\text{ is an }R\text{-module}\right\}$.
		\item $\sup\left\{\pdim_R(M)\st M\text{ is a finitely generated }R\text{-module}\right\}$.
		\item The smallest $p$ such that $\Ext_R^{p+1}(-,-)$ vanishes.
	\end{alphanumerate}
	When $R$ is Noetherian, we can add 
	\begin{alphanumerate}\setcounter{enumi}{4}
		\item The smallest $p$ such that $\Tor_{p+1}^R(-,-)$ vanishes.
		\item $\sup\left\{\fdim_R(M)\st M\text{ is an }R\text{-module}\right\}$.
		\item $\sup\left\{\fdim_R\KK(\mm)\st\mm\in\mSpec R\right\}$.
	\end{alphanumerate}
\end{cor}
\begin{proof}
	We get \itememph{a} $=$ \itememph{d} $=$ \itememph{b} (in this order) immediately from Definition~\reff{def:idim/pdim} and equation \eqreff{eq:idim} gives \itememph{b} $=$ \itememph{c}.
	
	Now let $R$ be Noetherian. That \itememph{e} $=$ \itememph{f} is again obvious from Definition~\reff{def:flatDim}. Now by Fact~\reff{fact:flatDimLocal}\itememph{b} and Corollary~\reff{cor:fdim(k)},
	\begin{align*}
	\fdim_R(M)=\sup\left\{\fdim_{R_\mm}(M_\mm)\st\mm\in\mSpec R\right\}\leq\sup\left\{\fdim_{R_\mm}\KK(\mm)\st\mm\in\mSpec R\right\}
	\end{align*}
	for every $R$-module $M$. Since $\fdim_{R_\mm}\KK(\mm)=\fdim_R\KK(\mm)$ (indeed, since $\mm$ is maximal, $\KK(\mm)_\pp\cong R_\pp/\mm_\pp=0$ when $\pp\neq\mm$ is a prime ideal, hence Fact~\reff{fact:flatDimLocal}\itememph{c} does it), we obtain that \itememph{f} $=$ \itememph{g}. Now from Fact~\reff{fact:flatDimLocal}\itememph{a} we know $\fdim_R(M)\leq \pdim_R(M)$ for every $R$-module $M$, and Corollary~\reff{cor:pdim=fdim} shows that equality holds when $M$ is finitely generated. Hence \itememph{f} $\leq$ \itememph{a} and \itememph{c} $\leq$ \itememph{f} and we are done.
\end{proof}
\chapter{Regular rings and Cohen--Macaulay rings}
\section{An application of the Koszul complex}
\begin{defi}\lbl{def:KoszulComplex}
	Let $R$ be a ring, $M$ be an $R$-module, $(x_1,\ldots,x_n)$ a sequence of elements of $R$. The (homological) \defemph{Koszul complex} $K_\bullet\big((x_1,\ldots,x_n),M\big)$ is a chain complex defined as follows. Let $[n]=\{1,\ldots,n\}$. For $p\geq0$, $K_p\big((x_1,\ldots,x_n),M\big)$ is the collection of maps $f\colon [n]^{n-p}\morphism M$ with the following properties:
	\begin{alphanumerate}
		\item $f(i_1,\ldots,i_{n-p})=0$ when $i_k=i_\ell$ for some integers $1\leq k<\ell\leq m$.
		\item $f\left(i_{\pi(1)},\ldots,i_{\pi(n-p)}\right)=\sgn(\pi)f(i_1,\ldots,i_{n-p})$ for every permutation $\pi\in\SS_{n-p}$.
	\end{alphanumerate}
	The differential $d_p\colon K_p\big((x_1,\ldots,x_n),M\big)\morphism K_{p-1}\big((x_1,\ldots,x_n),M\big)$ is given by 
	\begin{align*}
	d_pf=\sum_{j=0}^{n-p}(-1)^jd^jf\quad\text{where}\quad d^ jf\left(i_1,\ldots,i_{n-(p-1)}\right)=x_{i_{j+1}}f\left(i_1,\ldots,\hat{i}_{j+1},\ldots,i_{n-(p-1)}\right)\;.
	\end{align*}
	As usual, the hat $\hat{i}_{j+1}$ denotes the omission of $i_{j+1}$.
\end{defi}
In fact, the (homological) Koszul complex is just the (cohomological) one from \cite[Definition~2.1.3]{alggeo2} turned around. We also provided an alternative description there and proved (in \cite[Remark~2.1.1\itememph{a}]{alggeo2}) that this definition indeed gives a complex, i.e., that $d_{p-1}d_p=0$.

\begin{example}
	For small values of $n$, we have
	\begin{align*}
	K_\bullet\big(\emptyset,M\big)&=\Big(0\lmorphism M\lmorphism 0\lmorphism\ldots\Big)\\
	K_\bullet\big((x_1),M\big)&=\Big(0\lmorphism M\lmorphism[x_1\cdot] M\lmorphism 0\lmorphism\ldots\Big)\\
	K_\bullet\big((x_1,x_2),M\big)&=\Big(0\lmorphism M\xleftarrow{\left(\begin{smallmatrix}
		-x_2\\
		x_1
		\end{smallmatrix}\right)} M\oplus M\xleftarrow{(x_1,x_2)} M\lmorphism 0\lmorphism\ldots\Big)\;.
	\end{align*}
\end{example}

The study of $K_\bullet\big((x_1,\ldots,x_n),M\big)$ (in the easiest case) is by using \emph{cones} of morphisms of chain complexes. This notion is defined as follows.
\begin{defi}
	\begin{alphanumerate}
		\item For a chain complex $(C_\bullet,d_\bullet^C)$ and $k\in \IZ$, the \defemph{shifted complex} is given by $C[k]_i=C_{k+i}$ and with the sign convention that $d_i^{C[k]}=(-1)^kd_{i+k}^C$.
		\item Let $A_\bullet\morphism[f]B_\bullet$ be a morphism of chain complexes. Then the  \defemph{mapping cone} of $f$ is the complex $C_\bullet=\Cone(f)$ given by $C_i=B_i\oplus A_{i-1}$ and with differential 
		\begin{align*}
			d_i^C(b,a)=(d_i^Bb+f(a), -d_{i-1}^Aa)\;.
		\end{align*}
	\end{alphanumerate}
\end{defi}
 This is easily seen to be indeed a chain complex (cf.\ \cite[Remark~2.1.1\itememph{b}]{alggeo2} for a proof in the dual case). Moreover, there is a short exact sequence
\begin{align}\lbl{eq:ConeSeq}
	0\morphism B_\bullet\morphism \Cone(f)\morphism A[-1]_\bullet\morphism 0\;.
\end{align}
The connecting morphism of the resulting long exact homology sequence is easily checked to be given by $f$ and we obtain the so-called \emph{cone sequence}
\begin{align*}
	\ldots\morphism H_i(A_\bullet)\morphism[f] H_i(B_\bullet)\morphism H_i(\Cone(f))\morphism H_{i-1}(A_\bullet)\morphism\ldots\;.
\end{align*}
We can apply this to the Koszul complex as follows: As in \cite[Remark~2.1.3\itememph{c}]{alggeo2}, from
\begin{align*}
	\phi\colon K_\bullet\big((x_1,\ldots,x_{n-1}),M\big)\morphism[x_n\cdot]K_\bullet\big((x_1,\ldots,x_{n-1}),M\big)
\end{align*}
we get an isomorphism
\begin{align}\lbl{eq:KoszulCone}
	\begin{split}
		K_\bullet\big((x_1,\ldots,x_n),M\big)&\isomorphism\Cone(\phi)\\
		f\in K_p\big((x_1,\ldots,x_n),M\big)&\longmapsto \left(f(n,-)|_{[n-1]^{n-p-1}}, -f|_{[n-1]^{n-p}}\right)
	\end{split}			
\end{align}
and thanks to considering the \emph{homological} Koszul complex, we don't get the shift occuring from the cohomological case. Since there has been quite some confusion in the lecture, let us justify that this is indeed the case. Denote $x=(x_1,\ldots,x_n)$ and $x'=(x_1,\ldots,x_{n-1})$ for short. Then $K_p(x,M)=K^{n-p}(x,M)$, where $K^\bullet(x,M)$ is the cohomological Koszul complex from \cite[Definition~2.1.3]{alggeo2}. The argument given there shows that
\begin{align*}
	K^{n-p}(x,M)\cong K^{n-p-1}(x',M)\oplus K^{n-p}(x',M)\;.
\end{align*}
Now $K^{n-p-1}(x',M)\cong K_p(x',M)$ and $K^{n-p}(x',M)\cong K_{p-1}(x',M)$ since $x'$ has length $n-1$ instead of $n$ (and that's where the shift vanishes), so
\begin{align*}
	K_p(x,M)\cong K_p(x',M)\oplus K_{p-1}(x',M)
\end{align*}
and the right-hand side gives $\Cone(\phi)$. No shift Sherlock!
\begin{defi}
	Let $R$ be a ring, $M$ an $R$-module. A sequence $(x_1,\ldots,x_n)$ of elements of $R$ is called \defemph{$M$-regular} if
	\begin{align*}
		M/(x_1M+\ldots+x_{i-1}M)\morphism[x_i\cdot ]M/(x_1M+\ldots+x_{i-1}M)
	\end{align*}
	is injective for all $i=1,\ldots,n$. An $R$-regular sequence is often just called \defemph{regular}.
\end{defi}
\begin{example}
	The sequence $(1,0)$ is always $R$-regular, whereas $(0,1)$ is only if $R=0$.
\end{example}
We now put $H_i\big((x_1,\ldots,x_n),M\big)=H_i\left(K_\bullet\big((x_1,\ldots,x_n),M\big)\right)$ for short.
\begin{prop}\lbl{prop:KoszulAndRegular}
	Let $R$ be a ring and $M$ an $R$-module.
	\begin{alphanumerate}
		\item If $x=(x_1,\ldots,x_n)$ is an $M$-regular sequence, then $H_i(x,M)=0$ for all $i>0$.
		\item If $R$ is a Noetherian local ring with maximal ideal $\mm$, $M$ finitely generated, and $x=(x_1,\ldots,x_n)$ a sequence of elements of $\mm$, then $H_i(x,M)=0$ for $i>0$ already implies that $x$ is $M$-regular.
	\end{alphanumerate}
\end{prop}
Since our definition of $H_i\big((x_1,\ldots,x_n),M\big)$ doesn't depend on the order of the $x_i$, Proposition~\reff{prop:KoszulAndRegular}\itememph{b} implies
\begin{cor}
	If $R$ is a Noetherian local ring and $M$ finitely generated, then every permutation of an $M$-regular sequence of elements of the maximal ideal $\mm$ of $R$ stays regular.
\end{cor}
\begin{proof}[Proof of Proposition~\reff{prop:KoszulAndRegular}]
	Part \itememph{a}. We prove by induction on $n$ that \itememph{a} holds and moreover that $H_0(x,M)=M/(x_1M+\ldots+x_nM)$. For $n=0$, this is obvious. Now let $n\geq 1$ and the assertions be valid for $n-1$. Put $x'=(x_1,\ldots,x_{n-1})$. From the cone sequence \eqreff{eq:ConeSeq} applied to \eqreff{eq:KoszulCone} and the induction hypothesis, we obtain an exact sequence
	\begin{align*}
		0\lmorphism H_0\big(x,M\big)\lmorphism M/(x_1M+\ldots+x_{n-1}M)\lmorphism[x_n\cdot]M/(x_1M+\ldots+x_{n-1}M)\;,
	\end{align*}
	proving $H_0\big(x,M\big)\cong M/(x_1M+\ldots+x_nM)$. Moreover, the cone sequence gives 
	\begin{align*}
		H_{i-1}(x',M)\lmorphism H_i(x,M)\lmorphism H_i(x',M)
	\end{align*}
	in which for $i\geq 2$ the outer terms vanish by the induction hypothesis, since $x'$ is clearly $M$-regular as well. Hence $H_i(x,M)=0$ for $i\geq 2$. For $i=1$ we get
	\begin{align*}
		M/(x_1M+\ldots+x_{n-1}M)\lmorphism[x_n\cdot]M/(x_1M+\ldots+x_{n-1}M)\lmorphism H_1\big(x,M\big)\lmorphism 0\;,
	\end{align*}
	and since $x$ is $M$-regular, the map on the left has vanishing kernel, showing $H_1\big(x,M\big)=0$ as well.
	
	Part \itememph{b}. Again, we do induction on $n$. The case $n=0$ being trivial, let $n\geq 1$ and the assertion be valid for $n-1$. Keeping the above notation, we first prove that $x'$ is regular. Indeed, otherwise $H_i(x',M)\neq 0$ for some $i>0$ by the induction hypothesis. But Nakayama's lemma shows that $H_i(x',M)\lmorphism[x_n\cdot]H_i(x',M)$ is not surjective (it is easy to check that in the Noetherian case the $H_\bullet(x,M)$ are finitely generated provided that $M$ is), hence the exact sequence
	\begin{align*}
		H_i(x,M)\lmorphism H_i(x',M)\lmorphism[x_n\cdot]H_i(x',M)
	\end{align*}
	shows that $H_i(x,M)\neq 0$. So it remains to show injectivity of $M/(x_1M+\ldots+x_{n-1}M)\lmorphism[x_n\cdot]M/(x_1M+\ldots+x_{n-1}M)$. However, this follows from
	\begin{align*}
		M/(x_1M+\ldots+x_{n-1}M)\lmorphism[x_n\cdot]M/(x_1M+\ldots+x_{n-1}M)\lmorphism H_1(x,M)=0\;.
	\end{align*}
	We are done.
\end{proof}
\begin{rem*}
	\begin{alphanumerate}
		\item We have $H_0(x,M)=M/(x_1M+\ldots+x_nM)$ regardless of whether $x=(x_1,\ldots,x_n)$ is $M$-regular; and the proof essentially shows this.
		\item Proposition~\reff{prop:KoszulAndRegular}\itememph{b} can be strengthened to $H_1\big(x,M\big)\neq 0$ when $M$ is finitely generated and $x$ is a sequence in $\mm$ of $R$ which is \emph{not} regular (and the proof is easily modified to show this).
	\end{alphanumerate}
\end{rem*}
\begin{fact}\lbl{fact:KoszulResolutions}
	Let $R$ be a ring, $x=(x_1,\ldots,x_n)$ an $R$-regular sequence and $I=x_1R+\ldots+x_nR$ the ideal of $R$ it generates.
	\begin{alphanumerate}
		\item $0\lmorphism R/I\lmorphism K_\bullet(x,R)$ is a free resolution of $R/I$.
		\item For every $R$-module $M$ and all $p\geq 0$, $\Tor_p^R(M,R/I)\cong H_p(x,M)$ and  $\Ext_R^p(R/I,M)\cong H_{n-p}(x,M)$.
		\item If $I\subsetneq R$ is a proper ideal, then $\pdim_R(R/I)=\fdim_R(R/I)= n$.
	\end{alphanumerate}
\end{fact}
\begin{proof}
	Part \itememph{a}. By Proposition~\reff{prop:KoszulAndRegular}\itememph{a} and $H_0(x,R)=R/I$, exactness of $0\lmorphism R/I\lmorphism K_\bullet(x,R)$ follows. Note that as described in \cite[Remark~2.1.2]{alggeo2}, $K_p(x,R)\cong \bigwedge^{n-p}R^n$, and this is a free $R$-module with a basis given by the $e_{i_1}\wedge \cdots\wedge e_{i_{n-p}}$ where $1\leq i_1<\ldots<i_{n-p}\leq n$ and $e_i$ denotes the $i\ordinalth$ standard basis vector of $R^n$.
	
	Part \itememph{b}. Moreover, we show in \cite[Remark~2.1.2]{alggeo2} (up to turning the complex around) that $K_p(x,M)\cong \bigwedge^{n-p}R^n\otimes_RM$, hence $K_\bullet(x,M)\cong K_\bullet(x,R)\otimes_RM$ and the assertion about $\Tor_i^R(M,R/I)$ follows immediately. 
	
	The assertion about $\Ext_R^i(R/I,M)$ then seems reasonable when we take into account that $\bigwedge^{n-p}R^n\cong \bigwedge^pR^n$, but the technical details still manage to be disgusting. Yet we will sketch what happens. The $R$-module 
	\begin{align*}
		\Hom_R\big(K_p(x,R),M\big)\cong \Hom_R\left(\bigwedge^{n-p}R^n,M\right)
	\end{align*}
	is generated by the morphisms $\delta_I(m)$ for $I\subseteq [n]$ an ordered subset such that $\#I=n-p$ and $m\in M$, where $\delta_I(m)$ sends $\bigwedge_{i\in I}e_i$ to $m$ and the other basis vectors to $0$. Identify $\bigwedge^n R^n\cong R$ by sending $e_1\wedge\cdots\wedge e_n$ to $1$. Now construct a morphism 
	\begin{align*}
		\Hom_R\left(\bigwedge^{n-p}R^n,M\right)\morphism \bigwedge^pR^n\otimes_R M
	\end{align*}
	by sending $\delta_I(m)$ to $\epsilon\cdot \bigwedge_{j\notin I}e_j\otimes m$, where $\epsilon=(-1)^{n-p-1}\bigwedge_{i\in I}e_i\wedge\bigwedge_{j\notin I}e_j$, which can be viewed as an element (in fact, $\pm 1$) of $R$. One can show (easy) that this is an isomorphism and (ugly -- and hopefully true; I did my best to get the signs right) that this is in fact compatible with the Koszul differential.
	
	Part \itememph{c}. From \itememph{b} and the fact that $K_\bullet(x,M)$ is only supported in homological degrees $0\leq p\leq n$ it is clear that $\pdim_R(R/I)\leq n$ and $\fdim_R(R/I)\leq n$. But for $M=R/I$, the Koszul differentials vanish, so
	\begin{align*}
		\Tor_n^R(R/I,R/I)\cong\Ext_R^n(R/I,R/I)\cong R/I\neq 0\;, 
	\end{align*}
	provided that $I$ is a proper ideal.
\end{proof}
\section{Regular rings}
Let $R$ be a Noetherian local ring of dimension $d>0$ with maximal ideal $\mm$ and residue field $k=R/\mm$. Then
\begin{align*}
	\dim_k(\mm^i/\mm^{i+1})\sim \epsilon i^{d-1}
\end{align*}
with some $\epsilon>0$, by Hilbert polynomial theory.

Indeed, for sufficiently large $i$, $\length_R(R/\mm^i)$ is given by a polynomial $Q=Q_{R,\mm}$ in $i$, the \emph{Samuel polynomial} of $R$ with respect to $\mm$, cf.\ \cite[Definition~3.4.3]{alg2}, whose degree equals $d$ by \cite[Theorem~20]{alg2}. Hence
\begin{align*}
	\dim_k(\mm^i/\mm^{i+1})=\length_R(\mm^i/\mm^{i+1})=\length_R(R/\mm^{i+1})-\length_R(R/\mm^i)=Q(i+1)-Q(i)
\end{align*}
for $i\gge 0$ (we use that $\mm^i/\mm^{i+1}$ already has $\mm$-torsion, so its length as an $R$-module equals its length as an $R/\mm$-module, i.e., its dimension as a $k$-vector space), showing that $\dim_k(\mm^i/\mm^{i+1})$ is given by a polynomial of degree $d-1$.

As in \cite[Proposition~1.3.1]{alg2} one shows $\dim_k(\mm/\mm^2)\geq d$. Recall that $R$ is called \defemph{regular} when equality holds. In this case, $\mm$ can be generated by $d$ elements $x_1,\ldots,x_d$ and we have seen in \cite[Corollary~3.4.9]{alg2} that the $x_i$ generate the \emph{associated graded ring}
\begin{align*}
	\gr(R,\mm)=\bigoplus_{i=0}^\infty\mm^i/\mm^{i+1}
\end{align*}
as a polynomial algebra over $k$. Moreover, this can be shown to imply that $R$ is a domain.
\begin{prop}\lbl{prop:RegularRingRegularSequence}
	Let $R$ be a Noetherian local ring of dimension $d$ and $x_1,\ldots,x_d$ generators of its maximal ideal $\mm$.
	\begin{alphanumerate}
		\item The sequence $x=(x_1,\ldots,x_d)$ is a regular sequence.
		\item The Koszul complex $K_\bullet(x,R)$ is a free resolution of length $d$ for the residue field $k=R/\mm$.
		\item The cohomological dimension (cf.\ Definition~\reff{def:gdim}) $\gdim(R)$ of the category of $R$-modules equals $d$.
	\end{alphanumerate}
\end{prop}
\begin{proof}
	Assertion \itememph{b} follows from \itememph{a} and Fact~\reff{fact:KoszulResolutions}\itememph{a}. Also, \itememph{c} follows from Fact~\reff{fact:KoszulResolutions} and Corollary~\reff{cor:fdim(k)}. It remains to show \itememph{a}. Because regular local rings are domains, $(x_1)$ is a regular sequence. Moreover, the images of $x_2,\ldots,x_d$ generate the maximal ideal of $R/x_1R$. As $\gr(R/x_1R,\mm/x_1R)\cong \gr(R,\mm)/x_1\gr(R,\mm)$, we find that $\gr(R/x_1R,\mm/x_1R)$ is a polynomial ring in free generators $x_2,\ldots,x_d$ (resp.\ their images modulo $\mm^2$). Therefore the degree $d(R,\mm)$ of the Samuel polynomial of $R/x_1R$ and $\mm$ equals $d-1$, hence $R/x_1R$ has dimension $d-1$ by \cite[Theorem~20]{alg2}. Because its maximal ideal $\mm/x_1R$ can be generated by the $d-1$ elements $x_2,\ldots,x_d$, we see that $R/x_1R$ is regular. The regularity of $x=(x_1,\ldots,x_d)$ now follows by induction on $d$.
\end{proof}
And -- finally -- we are ready to prove Serre's famous characterization of regularity.
\begin{thm}[Serre]\lbl{thm:SerreRegularity}
	For a Noetherian local ring with maximal ideal $\mm$ and residue field $k=R/\mm$ the following are equivalent.
	\begin{alphanumerate}
		\item $R$ is regular.
		\item The cohomological dimension of the category of $R$-modules is finite.
		\item The cohomological dimension of the category of $R$-modules equals $\dim R$.
		\item $d=\fdim_R(k)$ is finite.
	\end{alphanumerate}
\end{thm}
\begin{proof}
	By Proposition~\reff{prop:RegularRingRegularSequence}\itememph{c} we get \itememph{a} $\Rightarrow$ \itememph{c}. Moreover, \itememph{c} $\Rightarrow$ \itememph{b} $\Rightarrow$ \itememph{d} is trivial, so it remains to derive \itememph{a} from \itememph{d}.
	
	For this, we do induction on $d=\fdim_R(k)$. If $d=0$, then $k$ is flat and by Proposition~\reff{prop:FreeProjFlatTor}, $k$ is a free $R$-module. But then $k=R$ is clearly regular of dimension $0$. Now let $d>0$ and the assertion be shown for smaller $d$. We will make use of \emph{associated primes}, which are briefly introduced in Appendix~\reff{sec:AssociatedPrimes}. 
	\begin{claim}
		We have $\mm\notin\Ass_R(R)$.
	\end{claim}
	Otherwise, $R/\mm\cong k$ is a submodule of $R$ (cf.\ the proof of Proposition~\reff{prop:AssExactSeqs}). Then there is a short exact sequence $0\morphism k\morphism R\morphism Q\morphism 0$, thus
	\begin{align*}
		0=\Tor_{p+1}^R(T,R)\morphism\Tor_{p+1}^R(T,Q)\morphism\Tor_p^R(T,k)\morphism\Tor_p^R(T,R)=0
	\end{align*}
	for any test module $T$, proving that $\fdim_R(Q)=\fdim (k)+1$. But $\fdim_R(Q)\leq\fdim_R(k)$ by Corollary~\reff{cor:fdim(k)}, contradiction! This proves the claim.
	
	Moreover, $\mm\supsetneq\mm^2$ as otherwise $\mm=0$ by the Nakayama lemma and thus $R=k$ and $d=0$. Thus, by finiteness of $\Ass_R(R)$ (Corollary~\reff{cor:AssFinite}) and prime avoidance (cf.\ \cite[Lemma~2.5.1]{alg1}), it is possible to choose an $x\in\mm\setminus \left(\mm^2\cup\bigcup_{\pp\in\Ass_R(R)}\pp\right)$. Then $R\morphism[x\cdot]R$ is injective by Proposition~\reff{prop:AssProperties}. 
	
	We use the fact that if $0\lmorphism M\lmorphism F_\bullet$ is a free resolution of some $R$-module $M$ such that $(x)$ is an $M$-regular sequence, then $0\lmorphism M/xM\lmorphism F_\bullet/xF_\bullet$ is a free resolution of the $R/xR$-module $M/xM$ (pretty easy to see). Therefore, using that projective and free is the same over the local ring $R$ by Proposition~\reff{prop:FreeProjFlatTor},
	\begin{align}\lbl{eq:pdimOfM/xMandM}
		\pdim_{R/xR}(M/xM)\leq \pdim_R(M)\tag{$*$}\;.
	\end{align}
	We apply this to $M=\mm$. By the short exact sequence $0\morphism\mm\morphism R\morphism k\morphism 0$ we have $\Tor_p^R(\mm,T)\cong\Tor_{p+1}(k,T)$ for every test module $T$, so $\pdim_R(\mm)=\fdim_R(\mm)=d-1$ (the first equality comes from Corollary~\reff{cor:pdim=fdim}), and thus by \eqreff{eq:pdimOfM/xMandM},
	\begin{align}\lbl{eq:pdimIneq2}
		\pdim_{R/xR}(\mm/x\mm)<d\;.\tag{\$}
	\end{align}
	If $x=x_1,x_2,\ldots,x_e$ are elements of $\mm$ whose images form a basis of $\mm/\mm^2$ as a $k$-vector space, then we get a splitting of the short exact sequence $0\morphism k\morphism[x\cdot ]\mm/x\mm\morphism\mm/xR\morphism 0$
	by sending an element $\mu\mod x\mm$ of $\mm/x\mm$ to the coefficient $c_1$ of $x=x_1$ in the (unique) expression
	\begin{align*}
		\mu\equiv\sum_{i=1}^ec_ix_i\bmod\mm^2
	\end{align*}
	as a linear combination of the above basis of $\mm/\mm^2$. Thus, $k$ as an $R/xR$-module is a direct summand of $\mm/x\mm$ and by \eqreff{eq:pdimIneq2} (and Corollary~\reff{cor:pdim=fdim} again) we get
	\begin{align*}
		\fdim_{R/xR}(k)= \pdim_{R/xR}(k)\leq \pdim_{R/xR}(\mm/x\mm)<d\;.
	\end{align*}
	By the induction assumption, $R/xR$ is a regular local ring of dimension $\delta<d$. We claim that
	\begin{claim}\lbl{claim:delta<dim(R)}
		We even have $\delta<\dim R$.
	\end{claim}
	Believing this for the moment, we see that there are $\xi_1,\ldots,\xi_\delta\in\mm$ whose images generate the maximal ideal $\mm/xR$ of $R/xR$. Then $\xi_1,\ldots,\xi_\delta,x$ are generators of $\mm$ as an ideal of $R$. Thus $\dim R\leq \delta+1$ and from $\delta<\dim R$ it follows that equality must hold. Thus $R$ is a regular local ring of dimension $d$.
	
	It remains to prove Claim~\reff{claim:delta<dim(R)}. Let $\qq_0\subsetneq\ldots\subsetneq\qq_\delta$ be a sequence of prime ideals in $R/xR$ with preimages $\pp_0,\ldots,\pp_\delta$ in $R$. Then $x\in\pp_i$ for all $i$. If $\pp_0$ contains another prime ideal of $R$, then $\dim R>\delta$ as claimed. Otherwise, $\pp_0$ is a minimal prime ideal of $R$. But the minimal prime ideals of any Noetherian ring are always associated prime ideals of it (Proposition~\reff{prop:AssProperties}\itememph{b}) and $x$ was chosen not to be contained in any associated prime ideal of $R$.
\end{proof}
\begin{cor}[Serre]\lbl{cor:Rpregular}
	Let $R$ be a regular local ring and $\pp\in\Spec R$. Then $R_\pp$ is also regular.
\end{cor}
\begin{proof}
	As $\KK(\pp)$ is the localization of $R/\pp$ at $\pp$, its projective dimension as an $R_\pp$-module is bounded by the projective dimension of $R/\pp$ as an $R$-module by Corollary~\reff{cor:projDimLocal}. Hence $\pdim_{R_\pp}\KK(\pp)=\fdim_{R_\pp}\KK(\pp)$ is finite and $R_\pp$ is regular by Theorem~\reff{thm:SerreRegularity}.
\end{proof}
\begin{defi}
	\begin{alphanumerate}
		\item A Noetherian ring $R$ is called \defemph{regular} if it satisfies the following equivalent conditions.
		\begin{alphanumerate}
			\item[\itememph{\alpha}] For any $\pp\in\Spec R$, $R_\pp$ is a regular local ring.
			\item[\itememph{\beta}] For any $\mm\in\mSpec R$, $R_\mm$ is a regular local ring.
		\end{alphanumerate}
		\item The ring $R$ is called \defemph{regular in $I$}, where $I\subseteq R$ is an ideal, if it satisfies the equivalent conditions.
		\begin{alphanumerate}
			\item[\itememph{\alpha}] For any $\pp\in\Spec R$ containing $I$, $R_\pp$ is a regular local ring.
			\item[\itememph{\beta}] For any $\mm\in\mSpec R$ containing $I$, $R_\mm$ is a regular local ring.
		\end{alphanumerate}
	\end{alphanumerate}
\end{defi}
\begin{prop}\lbl{prop:completionRegular}
	Let $A$ be a Noetherian ring regular in its ideal $I$, then its completion $\roof{A}$ with respect to $I$ is regular.
\end{prop}
\begin{proof}
	For $x\in I\roof{A}$ and any $a\in A$, the series $(1-ax)^{-1}=\sum_{i=0}^{\infty}a^ix^i$ converges in $\roof{A}$, hence $I\roof{A}$ is contained in the Jacobson radical $\rad(\roof{A})$ by \cite[Proposition~1.2.2]{alg2}, i.e., any maximal ideal of $\roof{A}$ contains $I\roof{A}$.  
	\begin{lem}\lbl{lem:maximalIdealsCompletion}
		Let $\nn$ be any maximal ideal of $\roof{A}$. Then $\nn=\roof{\mm}$ for some maximal ideal $\mm$ of $A$ which contains $I$.
	\end{lem}
	\begin{proof}
		Since $\nn$ contains $I\roof{A}$ by what we proved before, $\nn/I\roof{A}\subseteq \roof{A}/I\roof{A}\cong A/I$ is a proper ideal. Let $\mm\subseteq A$ be preimage of $\nn/I\roof{A}$. Clearly, $\mm$ is a proper ideal containing $I$. Then $\roof{\mm}=\mm\roof{A}\subseteq \roof{A}$ is a proper ideal (no $\mm/I^n$ contains $1$) and it is easy to see that $\roof{\mm}$ contains $\nn$, so $\nn=\roof{\mm}$. It remains to show that $\mm$ is maximal. But (using exactness of $I$-adic completions) $\roof{A}/\roof{\mm}\cong (A/\mm)^\complete $ is a field, and since $\mm\supseteq I$, the $I$-adic completion of $A/\mm$ is just $A/\mm$ as $I\cdot A/\mm=0$. Hence $\mm$ is maximal.
	\end{proof}
	Before we proceed with the proof of Proposition~\reff{prop:completionRegular}, let us state a nice consequence.
	\begin{cor}\lbl{cor:localCompletion}
		If $A$ is local, so is its $I$-adic completion $\roof{A}$.
	\end{cor}
	\begin{proof}
		Let $\mm$ be the maximal ideal of $A$. By Lemma~\reff{lem:maximalIdealsCompletion}, $\roof{\mm}$ is the only maximal ideal of $\roof{A}$.
	\end{proof}
	
	Using Lemma~\reff{lem:maximalIdealsCompletion}, we see that $\gr(\roof{A}_{\roof{\mm}},\roof{\mm})\cong\gr(\roof{A},\roof{\mm})\cong \gr(A,\mm)\cong\gr(A_\mm,\mm)$ implying that $\roof{A}_{\roof{\mm}}$ and $A_\mm$ have the Samuel polynomial. Using \cite[Theorem~20]{alg2} (for which we need Noetherianness of $\roof{A}$ -- this is proved, e.g., in \cite[Theorem~7.1a]{eisenbudCommAlg}) this shows $\dim \dim \roof{A}_{\roof{\mm}}=A_\mm=d$. If $\mm$ is generated by $x_1,\ldots,x_d$ over $A_\mm$, then so is $\roof{\mm}\cong\mm\roof{A}$ by their images, showing that $\roof{A}_{\roof{\mm}}$ is regular.
\end{proof}
\begin{prop}\lbl{prop:polynomialRegular}
	If $A$ is a regular Noetherian ring, then so are the polynomial ring $A[X_1,\ldots,X_n]$ as well as the ring of formal power series $A\llbracket X_1,\ldots,X_n\rrbracket$.
\end{prop}
\begin{proof}
	Since $A\llbracket X_1,\ldots,X_n\rrbracket$ is the completion of $A[X_1,\ldots,X_n]$ with respect to the ideal $(X_1,\ldots,X_n)$, it's enough to show regularity of $A[X_1,\ldots,X_n]$ by Proposition~\reff{prop:completionRegular}. Clearly, we may reduce this inductively to the polynomial ring $A[T]$ in only one variable. 
	
	Let $\pp\in\mSpec A[T]$ be a maximal ideal and $\mm=\pp\cap A$. We may assume that $A$ is local with maximal ideal $\mm$ -- otherwise we localize the multiplicative subset $A\setminus \mm$ to replace $A$ by $A_\mm$. Since $A_\mm$ is regular by assumption and $A[T]_\pp\cong A_\mm[T]_\pp$ (of which regularity is to be shown), the situation didn't change. Let $x_1,\ldots,x_d$ be generators of $\mm$. Since $A$ is regular local, we may assume $d=\dim A$. Let $k=A/\mm$ be the residue field of $A$. We have $\pp\supsetneq \mm A[T]$ since otherwise $A[T]/\pp\cong k[T]$ wouldn't be a field, but $\pp$ was chosen maximal. %If $\pp=\mm A[T]$, then $x_1,\ldots,x_d$ generate $\pp$ as well and we obtain $d\geq \hoehe(\mm A[T])\geq\hoehe(\mm)=d$ by Krull's height theorem (cf.\ \cite[Theorem~12]{alg2}), hence equality holds and we see that $A[T]$ is regular.	If $\pp\supsetneq \mm A[T]$, t
	
	We claim that then $\hoehe(\pp)>\dim A$. Indeed, for every prime ideal $\qq\in\Spec A$, $\qq A[T]$ is prime in $A[T]$ since $A[T]/\qq A[T]\cong (A/\qq)[T]$ is a polynomial ring over a domain, hence a domain itself. Thus, for any chain $\qq_0\subsetneq \ldots\subsetneq \qq_d=\mm$ of prime ideals in $A$, we get the chain $\qq_0 A[T]\subsetneq \ldots\subsetneq \qq_d A[T]\subsetneq \pp$.
	
	Now note that $\KK(\pp)=A[T]/\pp$ is an extension of $k$ of finite type, hence a finite extension. Let $Q\in A[T]$ be a polynomial such that $Q\bmod \pp$ is a minimal polynomial of $T\mod\pp$, then $Q,x_1,\ldots,x_d$ generate $\pp$ and thus $\hoehe(\pp)\leq d+1$ by Krull's height theorem (cf.\ \cite[Theorem~12]{alg2}). Since $\hoehe(\pp)>d$, equality holds and regularity follows.
\end{proof}
\begin{prop}[Hilbert's szyzygy theorem]
	Finitely generated modules over regular Noetherian rings always have a finite free resolution.
\end{prop}
\section{Regular sequences and depth}
Throughout the section, let $R$ be a Noetherian local ring with maximal ideal $\mm$ and residue field $k$.
\begin{prop}\lbl{prop:SmallExtVanishing}
	Let $M$ be a finitely generated $R$-module. For a natural number $n$, the following conditions are equivalent.
	\begin{alphanumerate}
		\item There is a finitely generated $R$-module $T$ such that $\supp T=\{\mm\}$ and $\Ext_R^p(T,M)=0$ when $p<n$.
		\item $\Ext_R^p(k,M)=0$ when $p<n$.
		\item For every finitely generated $R$-module $T$ with $\supp T=\{\mm\}$ we have $\Ext_R^p(T,M)=0$ when $p<n$.
	\end{alphanumerate}
\end{prop}
\begin{proof}
	The implications \itememph{c} $\Rightarrow$ \itememph{b} $\Rightarrow$ \itememph{a} are obvious. We use induction on $n$ to show the remaining implications. In the case $n=0$, there's nothing to show. Now assume $n\geq 1$ and that the assertion holds for $n-1$. We show \itememph{a} $\Rightarrow$ \itememph{b} first. There is a surjection $T\morphism k$. Indeed, $T$ has a filtration with quotients of the form $R/\pp$ for $\pp\in\Spec R$. But $\supp T=\{\mm\}$, hence $\pp$ must be $\mm$ (which is easily seen from \cite[Fact~3.1.2 and Lemma~3.4.1]{alg2} -- alternatively, one could quotient out $\mm/\pp$ from $R/\pp$ to obtain $T\morphism k$). Hence there is a short exact sequence $0\morphism T_1\morphism T\morphism k\morphism 0$ and this yields
	\begin{align*}
		\Ext_R^{p-1}(T_1,M)\morphism\Ext_R^p(k,M)\morphism\Ext_R^p(T,M)\;.
	\end{align*}
	For $p<n$, the term on the left vanishes by \itememph{a} and the term on the right by \itememph{c} and our induction assumption. Therefore $\Ext_R^p(k,M)=0$ as well.
	
	And last we show \itememph{b} $\Rightarrow$ \itememph{c}. If $0\morphism T'\morphism T\morphism T''\morphism 0$ and $\Ext_R^p(T',M)=0=\Ext_R^p(T'',M)$, then $\Ext_R^p(T,M)=0$ as it is sandwiched to death between $\Ext_R^p(T',M)$ and $\Ext_R^p(T'',M)$ in the long exact $\Ext$ sequence. Using induction on the length $\ell$ of a filtration of the form $0=T_0\subseteq\ldots\subseteq T_\ell=T$ such that $T_i/T_{i-1}\cong R/\pp_i$ for prime ideals $\pp_i\in\Spec R$ (and we have seen that $\supp T=\{\mm\}$ allows only $\mm=\pp_i$) we obtain $\Ext_R^p(T,M)=0$ for $p<n$ and all finitely generated $R$-modules $T$.
\end{proof}
\begin{defi}
	The largest number $n$ as in Proposition~\reff{prop:SmallExtVanishing} is called the \defemph{depth} (or sometimes \defemph{homological codimension} -- this is Serre's terminology) of the module and denoted $\depth_R(M)$.
\end{defi}
From Proposition~\reff{prop:SmallExtVanishing} and additivity of $\Ext_R^p(k,-)$, we immediately obtain
\begin{fact}\lbl{fact:depthMinAdditive}
	If $M$ and $N$ are finitely generated $R$-modules, we have 
	\begin{align*}
		\depth_R(M\oplus N)=\min\{\depth_R(M),\depth_R(N)\}\;.
	\end{align*}
\end{fact}
\begin{rem}
	The condition $\supp M=\{\mm\}$ is equivalent to $\dim (T)=0$ (as in \cite[Definition~3.4.1]{alg2} we put $\dim(T)\coloneqq\dim(\supp T)$ for $R$-modules $T$). Under this condition, we have $\Ext_R^p(T,M)=0$ when $p<\depth_R(M)$.
\end{rem}
\begin{thm}[Auslander--Buchsbaum]
	Let $R$ be a Noetherian local ring and $M\neq 0$ a finitely generated $R$-module with $\pdim_R(M)<\infty$. Then
	\begin{align}\lbl{eq:AuslanderBuchsbaum}
		\pdim_R(M)+\depth_R(M)=\depth_R(R)
	\end{align}
\end{thm}
\begin{proof}
	We use induction on $d=\pdim_R(M)$. When $d=0$, then $M$ is free by Proposition~\reff{prop:FreeProjFlatTor}, hence $\depth_R(M)=\depth_R(R)$ by Fact~\reff{fact:depthMinAdditive}. Now let $d\geq 1$ and assume that the assumption is proved for smaller $d$. Let $x_1,\ldots,x_s$ be elements of $M$ whose images form a basis of $M/\mm M$ (hence also generate $M$ by Nakayama). Let $P=R^s\epimorphism[p] M$ be the surjection sending the $i\ordinalth$ standard basis vector to $x_i$. We obtain a short exact sequence
	\begin{align}\lbl{eq:exactSeq1}
		0\morphism M'\morphism[i] P\morphism[p] M\morphism 0\;.\tag{$*$}
	\end{align}
	Then $i(M')\subseteq \mm P$ by our choice of the $x_i$. Since $P$ is free, its $\Ext_R^\bullet(P,-)$ vanishes and the long exact $\Ext$ sequence shows $\Ext_R^{p+1}(M,-)\cong \Ext_R^p(M',-)$, thus 
	\begin{align}\lbl{eq:depthInduction}
		\pdim_R(M')=\pdim_R(M)-1=d-1\;.\tag{\$}
	\end{align}
	If $d=1$, this means that $M'$ is free, say, $M'\cong R^\ell$ and $i$ is given by an $(s\times \ell)$-matrix with coefficients from $\mm$ (since $i(M')\subseteq \mm P$), hence the induced morphism $\Ext_R^p(k,M')\morphism\Ext_R^p(k,P)$ vanishes and the long exact $\Ext$ sequence
	\begin{align*}
		\Ext_R^p(k,M')\morphism[0]\Ext_R^p(k,P)\morphism\Ext_R^p(k,M)\morphism\Ext_R^{p+1}(k,M')\morphism[0]\Ext_R^{p+1}(k,P)
	\end{align*}
	shows that $\depth_R(M)=\min\{\depth_R(P),\depth_R(M')-1\}$. But $M'\neq 0$ (as $d>0$) and $M'$ is free, hence $\depth_R(M')=\depth_R(R)=\depth_R(P)$ as we have seen before, and we must have $\depth_R(M)=\depth_R(M')-1$, establishing \eqreff{eq:AuslanderBuchsbaum} in this case.
	
	Let now $d>1$ and $c=\depth_R(M')$. By the induction assumption and \eqreff{eq:depthInduction}, we have $d-1+c=\depth_R(R)$, hence $\depth_R(R)\geq c+1$. It follows that
	\begin{align*}
		0=\Ext_R^p(k,P)\morphism\Ext_R^p(k,M)\morphism\Ext_R^{p+1}(k,M')\morphism\Ext_R^{p+1}(k,P)=0
	\end{align*}
	for $p<c$. The morphism in the middle must be an isomorphism, hence $\depth_R(M)=c-1$, showing \eqreff{eq:AuslanderBuchsbaum} for $M$.
\end{proof}
Next, we will investigate the connection between depth and regular sequences. In particular, we will show that $\depth_R(M)$ equals the length of a maximal $M$-regular sequence consisting of elements from $\mm$ (and in fact, any two such maximal sequences have the same length).
\begin{lem}\lbl{lem:depthAss}
	For a finitely generated $R$-module $M$ the following conditions are equivalent.
	\begin{alphanumerate}
		\item $\mm\notin\Ass_R(M)$.
		\item $\depth_R(M)>0$.
		\item There is an $x\in \mm$ such that $M\morphism[x\cdot ]M$ is injective.
	\end{alphanumerate}
\end{lem}
\begin{proof}
	By Proposition~\reff{prop:SmallExtVanishing}\itememph{b}, we see that \itememph{b} holds iff $0=\Ext_R^0(k,M)=\Hom_R(k,M)$. Since $k$ is a field, any non-zero morphism $k\morphism M$ is injective. That is, there is a non-zero $k\morphism M$ iff there is an embedding $k\monomorphism M$ which is the case iff $\mm\in\Ass_R(M)$. We conclude \itememph{a} $\Leftrightarrow$ \itememph{b}. The equivalence \itememph{a} $\Leftrightarrow$ \itememph{c} is just Proposition~\reff{prop:AssProperties}\itememph{a} and we are done.
\end{proof}
\begin{lem}\lbl{lem:depthM/xM}
	Let $x\in \mm$ be $M$-regular, then $\depth_R(M)=\depth_R(M/xM)+1$\;.
\end{lem}
\begin{proof}
	The long exact $\Ext$ sequence associated to $0\morphism M\morphism[x\cdot ]M\morphism M/xM\morphism 0$ gives
	\begin{align*}
		\Ext_R^p(k,M)\morphism[x\cdot]\Ext_R^p(k,M)\morphism\Ext_R^p(k,M/xM)\morphism\Ext_R^{p+1}(k,M)\morphism[x\cdot]\Ext_R^{p+1}(k,M)\;.
	\end{align*}
	Since $x\in\mm$, the outer arrows are $0$, hence $\Ext_R^p(k,M/xM)\morphism\Ext_R^{p+1}(k,M)$ is an isomorphism and the claim follows.
\end{proof}
\begin{cor}\lbl{cor:depthM/xM}
	If $(x_1,\ldots,x_n)$ is an $M$-regular sequence of elements of $\mm$, then
	\begin{align*}
		\depth_R(M)=\depth_R\big(M/(x_1M+\ldots+x_nM)\big)+n\;.
	\end{align*}
\end{cor}
\begin{proof}
	Use Lemma~\reff{lem:depthM/xM} and induction on $n$.
\end{proof}
We are now ready to prove the desired correspondence. In particular, Proposition~\reff{prop:DepthRegularSequence}\itememph{b} implies that any two maximal $M$-regular sequences in $\mm$ have the same length.
\begin{prop}\lbl{prop:DepthRegularSequence}
	Let $M\neq 0$ be a finitely generated $R$-module, then the following conditions are equivalent.
	\begin{alphanumerate}
		\item $\depth_R(M)\geq n$.
		\item Let $0\leq j\leq n$ and $(x_1,\ldots,x_j)$ be an $M$-regular sequence of elements of $\mm$. Then there are $x_{j+1},\ldots,x_n\in\mm$ such that $(x_1,\ldots,x_n)$ is $M$-regular.
		\item There is an $M$-regular sequence $(x_1,\ldots,x_n)$ consisting of elements from $\mm$.
	\end{alphanumerate}
\end{prop}
\begin{proof}
	The implication \itememph{b} $\Rightarrow$ \itememph{c}  is trivial and \itememph{c} $\Rightarrow$ \itememph{a} follows from Corollary~\reff{cor:depthM/xM}. Let's prove \itememph{a} $\Rightarrow$ \itememph{b}. If $j<n$, Corollary~\reff{cor:depthM/xM} gives
	\begin{align*}
		\depth_R\big(M/(x_1M+\ldots+x_jM)\big)=\depth_R(M)-j\geq n-j>0\;,
	\end{align*}
	hence we find $x_{j+1}\in\mm$ such that $M/(x_1M+\ldots+x_jM)\xrightarrow{x_{j+1}\cdot} M/(x_1M+\ldots+x_jM)$ is injective by Lemma~\reff{lem:depthAss}. Thus $(x_1,\ldots,x_{j+1})$ is $M$-regular. Now iterate.
\end{proof}
Let $I\subseteq \mm$ be an ideal and $\roof{\phantom{x}}$ the completion with respect to $I$. We have seen in Proposition~\reff{prop:ExtCompletion} that $\Ext_{\roof{R}}^p(k,\roof{M})\cong \Ext_R^p(k,M)^\complete \cong \Ext_R^p(k,M)$ (the last isomorphism comes from the fact that $\Ext_R^p(k,M)$ already has $I$-torsion, cf.\ Fact~\reff{fact:atimesExt2}). Hence, by Proposition~\reff{prop:SmallExtVanishing}\itememph{b},
\begin{prop}\lbl{prop:depthCompletion}
	We have $\depth_{\roof{R}}(\roof{M})=\depth_R(M)$.
\end{prop}
\begin{prop}[F.\ Ischebeck]\lbl{prop:Ischebeck}
	Suppose that $M$ and $T$ are finitely generated $R$-modules and $p<\depth_R(M)-\dim(T)$. Then $\Ext_R^p(T,M)=0$.
\end{prop}
\begin{proof}
	We use induction on $d=\dim(T)$. When $d=0$, this is precisely our definition of depth. Now let $d\geq 1$ and the assertion be shown for smaller $d$. We have a filtration $0=T_0\subseteq\ldots\subseteq T_n=T$ with $T_i/T_{i-1}\cong R/\pp_i$ for $\pp_i\in\Spec R$. By \cite[Fact~3.4.1]{alg2}, the $\pp_i$ satisfy $\dim(R/\pp_i)\leq \dim(T)=d$. By an inductive argument on the length $n$ of such a filtration (similar to the proof of Proposition~\reff{prop:SmallExtVanishing}) it is sufficient to consider the case $T=R/\pp$ with $\dim(R/\pp)\leq d$. If $x\in\mm\setminus \pp$, then we have a short exact sequence 
	\begin{align*}
		0\morphism R/\pp\morphism[x\cdot ]R/\pp\morphism R/(\pp+xR)\morphism 0\;, 
	\end{align*}
	in which $\dim(R/(\pp+xR))<\dim(R/\pp)$. Looking at the long exact $\Ext$ sequence
	\begin{align*}
		\ldots\morphism\Ext_R^p(R/\pp,M)\morphism[x\cdot]\Ext_R^p(R/\pp,M)\morphism\Ext_R^{p+1}(R/(\pp+xR),M)\morphism\ldots\;,
	\end{align*}
	we see that $\Ext_R^p(R/\pp,M)\morphism[x\cdot]\Ext_R^p(R/\pp,M)$ is surjective when $p+1<\depth_R(M)-\dim(R/(\pp+xR))$ (that's the induction assumption), hence for $p<\depth_R(M)-\dim(T)$. By Nakayama's lemma, $\Ext_R^p(T,M)=0$ for such $p$.
\end{proof}
\begin{cor}
	Let $M$ be a finitely generated module over $R$.
	\begin{alphanumerate}
		\item \lbl{cor:dimRp>depthM}If $\pp\in\Ass_R(M)$, then $\dim(R/\pp)\geq\depth_R(M)$.
		\item If $(x_1,\ldots,x_r)$ is an $M$-regular sequence in $\mm$ and $\pp\in\Ass_R(M/(x_1M+\ldots+x_rM))$, then $\dim(R/\pp)\geq \depth_R(M)-r$.
	\end{alphanumerate}
\end{cor}
\begin{proof}
	For \itememph{a}, note that if $\pp\in\Ass_R(M)$, then $\Ext_R^0(R/\pp,M)=\Hom_R(R/\pp,M)\neq 0$. But then $\depth_R(M)>\dim (R/\pp)$ would contradict Proposition~\reff{prop:Ischebeck}. Part \itememph{b} follows from \itememph{a} and Corollary~\reff{cor:depthM/xM}.
\end{proof}
\section{Cohen--Macaulay rings}
\begin{fact}
	For any finitely generated module $M$ over the Noetherian local ring $R$ we have $\dim(M)\geq\depth_R(M)$. In particular, $\dim(R)\geq\depth_R(R)$.
\end{fact}
\begin{proof}
	Indeed, from Fact~\reff{fact:dimsuppM} we get $\dim(M)=\max\left\{\dim(R/\pp)\st \pp\in\Ass_R(M)\right\}$ and the assertion follows from Corollary~\reff{cor:dimRp>depthM}.
\end{proof}
\begin{defi}\lbl{def:localCM}
	A Noetherian local ring is \defemph{Cohen--Macaulay} (\defemph{CM} for short) if equality occurs in $\dim(R)\geq\depth_R(R)$.
\end{defi}
Recall that $I\subseteq R$ is an \emph{ideal of definition} if $\sqrt{I}=\mm$ (cf.\ \cite[Definition~3.4.2]{alg2}). 
\begin{defi}
	A \defemph{parameter sequence} of $R$ is a sequence of $\dim R$ elements generating an ideal of definition. In this case, the generated ideal is called \defemph{parameter ideal} of $R$.
\end{defi}
Though $\mm$ might not be generated by $\dim R$ elements if $R$ is not regular, parameter sequences (and thus parameter ideals) always exist by \cite[Theorem~20]{alg2}.

By Proposition~\reff{prop:DepthRegularSequence}, the maximal length of a regular sequence in $\mm$ is $\depth_R(R)\leq\dim(R)$. Thus, $R$ is CM if a regular parameter sequence may be found. The converse is also true. Indeed, let $d=\dim R$, let $(x_1,\ldots,x_d)$ be a regular sequence in $\mm$ and $\pp\in V(x_1,\ldots,x_d)$ any prime ideal. Then the $x_i$ form a regular sequence in the maximal ideal of $R_\pp$, hence $\dim R_\pp\geq\depth_{R_\pp}(R_\pp)\geq d=\dim R$. This only leaves $\pp=\mm$ and thus $\sqrt{(x_1,\ldots,x_d)_R}=\mm$.
\begin{example}
	Regular local rings are CM. Indeed, if $(x_1,\ldots,x_d)$ are generators of the maximal ideal $\mm$ of $R$, then they form a regular sequence by Proposition~\reff{prop:RegularRingRegularSequence}, which is also a parameter sequence.
\end{example}
And now we are ready for the second highlight of the lecture: Universal catenarity of CM rings. This will come in several steps.
\begin{prop}\lbl{prop:CMcatenary}
	If $R$ is a local CM ring and $\pp\in\Spec R$, then $R_\pp$ is CM and
	\begin{align*}
		\dim R_\pp=\dim R-\dim (R/\pp)\;.
	\end{align*}
\end{prop}
\begin{proof}
	In our Noetherian finitely generated situation, $\Ext$ commutes with localization (Proposition~\reff{prop:ExtLocalization}). Hence $\Ext_{R_\pp}^p(\KK(\pp),R_\pp)=\Ext_R^p(R/\pp,R)_\pp$ and in particular,
	\begin{align*}
		\Ext_{R_\pp}^p(\KK(\pp),R_\pp)=0\quad\text{when }p<\depth_R(R)-\dim(R/\pp)\;.
	\end{align*}
	As $R$ is Cohen--Macaulay, we have
	\begin{align}\lbl{eq:dimRp}
		\dim R_\pp\geq\depth_R(R_\pp)\geq \dim R-\dim(R/\pp)\geq\hoehe(\pp)=\dim R_\pp\;,\tag{$*$}
	\end{align}
	where $\hoehe(\pp)=R_\pp$ is one of the basic properties of localization and $\hoehe(\pp)+\dim V(\pp)\leq \dim R$ is one of the easy inequalities for Krull dimension. Hence we have equality in \eqreff{eq:dimRp} and all assertions follow.
\end{proof}
\begin{cor}\lbl{cor:CMcatenary}
	A local CM ring $R$ is catenary and all irreducible components of $\Spec R$ are of dimension $\dim R$.
\end{cor}
\begin{proof}
	From Proposition~\reff{prop:CMcatenary} it is clear that irreducible components of $\Spec R$ (corresponding to minimal, i.e., height $0$ prime ideals) have dimension $\dim R$. To show catenarity, we need to prove that for all irreducible subsets $X\subseteq Y\subseteq Z$ of $\Spec R$ we have
	\begin{align}\lbl{eq:catenarity}
		\codim(X,Y)+\codim(Y,Z)=\codim(X,Z)\;.\tag{\$}
	\end{align}
	Let $\pp\subseteq \qq$ be prime ideals of $R$. Then $\codim(V(\qq),V(\pp))=\dim(R_\qq/\pp R_\qq)$ is easily seen from some standard arguments. Since $R_\qq$ is CM again by Proposition~\reff{prop:CMcatenary}, we obtain
	\begin{align*}
		\codim\left(V(\qq),V(\pp)\right)=\dim R_\qq-\dim (R_\qq)_\pp=\dim R_\qq-\dim R_\pp\;.
	\end{align*}
	From this, \eqreff{eq:catenarity} is obvious.
\end{proof}
\begin{defi}
	\begin{alphanumerate}
		\item A Noetherian ring $R$ is called \defemph{Cohen--Macaulay} if all $R_\pp$ for $\pp\in\Spec R$ are Cohen--Macaulay in the sense of Definition~\reff{def:localCM}. Equivalently, we only need to ask for $R_\mm$ being Cohen--Macaulay for all maximal ideals $\mm$ of $R$.
		\item A locally Noetherian prescheme $X$ is \defemph{Cohen--Macaulay} if the local rings $\Oo_{X,x}$ are Cohen--Macaulay for all $x\in X$. This is the case iff $\Oo_X(U)$ is Cohen--Macaulay when $U\subseteq X$ is affine. If $X$ is quasi-compact, it suffices that $\Oo_{X,x}$ is Cohen--Macaulay when $x\in X$ is closed.
		\item (Serre) A locally Noetherian prescheme $X$ is $\boldsymbol{S_k}$ if $\depth_{\Oo_{X,x}}(\Oo_{X,x})\geq \min\left\{k,\dim\Oo_{X,x}\right\}$ for all $x\in X$. It is $\boldsymbol{R_k}$ if $\Oo_{X,x}$ is regular whenever $\dim\Oo_{X,x}\leq k$.
	\end{alphanumerate}
\end{defi}
\begin{proof}
	The equivalence of the conditions in \itememph{a} is clear since localizations of CM rings are CM again by Proposition~\reff{prop:CMcatenary}, and same for the first two conditions of \itememph{b}. Let's talk about the third one. When $X$ is quasi-compact, every closed subset contains a closed point by \cite[Proposition~2.1.1]{alggeo1}. In particular, for $x\in X$, $\ov{\{x\}}$ contains a closed point $y$. Since $x$ corresponds to a prime ideal of $\Oo_{X,y}$ by \cite[Proposition~2.1.3]{alggeo1}, $\Oo_{X,x}$ is a localization of $\Oo_{X,y}$ and thus CM as well.
\end{proof}
\begin{rem*}
	Actually, quasi-compactness isn't needed for \itememph{b}, since \cite[\stackstag{02IL}]{stacks-project} shows that any closed subset of a locally Noetherian prescheme contains a closed point as well. If you try to understand the proof, \cite[Proposition~2.1.3]{alggeo1} might be helpful. Also note that the $R=\Oo_{X_0,y}$ constructed there is a domain (which \cite[\stackstag{02IG}]{stacks-project} needs) since $X_0$ is (by construction) reduced and irreducible, i.e., integral, and we can apply \cite[Proposition~2.1.4]{alggeo1}.
\end{rem*}
\begin{rem*}
	\begin{alphanumerate}
		\item By a result of Serre, $X$ is reduced iff it is $R_0$ and $S_1$ and $X$ is normal iff it is $R_1$ and $S_2$.
		\item See SGA 2 for applications to \emph{local cohomology}.
	\end{alphanumerate}
\end{rem*}
\begin{prop}\lbl{prop:CMcompletion}
	If $R$ is CM, then so is its $I$-adic completion $\roof{R}$ for any proper ideal $I\subseteq R$.
\end{prop}
\begin{proof}
	By Lemma~\reff{lem:maximalIdealsCompletion}, any maximal ideal of $\roof{R}$ is of the form $\roof{\mm}$ for some maximal ideal $\mm$ of $R$. We have also seen in the proof of Proposition~\reff{prop:completionRegular} that $\dim R_\mm=\dim \roof{R}_{\roof{\mm}}$, so it remains to check $\depth_{R_\mm}(R_\mm)=\depth_{\roof{R}_{\roof{\mm}}}(\roof{R}_{\roof{\mm}})$. Unfortunately, this \emph{doesn't} follow immediately from Proposition~\reff{prop:depthCompletion}. The problem here is that $\roof{R}_{\roof{\mm}}$ and $(R_\mm)^\complete $ usually don't coincide (though one can show they do when $I=\mm$).
	
	However, we can still use the idea given there. Note that $R_\mm$ and $\roof{R}_{\roof{\mm}}$ are both local rings with the same residue field $k$. By Proposition~\reff{prop:ExtLocalization}, $\Ext_{R_\mm}^p(k,R_\mm)\cong \Ext_R^p(k,R)_\mm\cong\Ext_R^p(k,R)$. The last isomorphism is due to the fact that $\Ext_R^p(k,R)$ has $\mm$-torsion by Fact~\reff{fact:atimesExt2}, i.e., it is a $k=R/\mm$-vector space. So localization at $\mm$ doesn't change anything and the same holds true for $I$-adic completions. Thus the same argument gives $\Ext_{\roof{R}_{\roof{\mm}}}(k,\roof{R}_{\roof{\mm}})\cong \Ext_R^p(k,R)$ and we are done.
\end{proof}
\begin{prop}\lbl{prop:polynomialCM}
	If $R$ is Cohen--Macaulay, then so are $R[X_1,\ldots,X_n]$ and $R\llbracket X_1,\ldots,X_n\rrbracket$.
\end{prop}
\begin{proof}
	As $R\llbracket X_1,\ldots,X_n\rrbracket$ is the completion of $R[X_1,\ldots,X_n]$ with respect to the ideal generated by $X_1,\ldots,X_n$, by Proposition~\reff{prop:CMcompletion} it is sufficient to show the first assertion. Moreover, using induction we may reduce to the case of the polynomial ring $R[T]$ in only one variable. 
	
	Now let $\pp$ be a maximal ideal of $R[T]$. Let $\mm=\pp\cap R$. Localizing the multiplicative subset $R\setminus \mm$ and replacing $R$ by $R_\mm$ we may assume that $R$ is local with maximal ideal $\mm$. Since $R[T]_\pp\cong R_\mm[T]_\pp$ (of which CMness is to be shown), the situation didn't change. Since $R/\mm[T]$ is not a field, $\pp$ (which was chosen maximal) must properly contain $\mm R[T]$. Then $\pp=\mm R[T]+(Q)$ where $Q\in R[T]$ is a monic polynomial such that $Q\bmod \mm$ is a minimal polynomial over the residue field $k=R/\mm$ of $T\bmod \pp$ viewed as an element of $\KK(\pp)$ (compare the argument in the proof of Proposition~\reff{prop:polynomialRegular}). Let $d=\dim R$ and $(x_1,\ldots,x_d)$ a regular parameter sequence in $\mm$. We claim that $(x_1,\ldots,x_d,Q)$ is $R[T]$-regular. Indeed, $R[T]$-regularity of $(x_1,\ldots,x_d)$ is easy to see. Now
	\begin{align*}
		R[T]/\big(x_1R[T]+\ldots+x_dR[T]\big)\cong\big(R/(x_1R+\ldots+x_dR)\big)[T]
	\end{align*}
	is a polynomial ring and $Q$ has leading coefficient $1$, so multiplication by $Q$ is injective. Also $(x_1,\ldots,x_d,Q)$ clearly generates an ideal of definition in $R[T]_\pp$, hence
	\begin{align*}
		\hoehe(\pp)\geq d+1\geq \dim R[T]_\pp
	\end{align*}
	where the first inequality comes from $\hoehe(\pp)> \dim R$ (which is shown as in the proof of Proposition~\reff{prop:polynomialRegular}) and the second is \cite[Theorem~12]{alg2}. We see that equality holds and thus $R[T]_\pp$ has a regular parameter sequence in $\pp R[T]_\pp$, whence it is CM.
	%If $\pp=\mm R[T]$ then any $R$-regular sequence of $\dim R$ elements of $\mm$ is an $R[T]$-regular sequence in $\pp$. But $\hoehe(\pp)=\dim R$ in this case as $\dim R[T]\leq \dim R+1$ by Hilbert polynomial theory. If $\pp\supsetneq \mm[T]$, 
\end{proof}
We have everything together to prove
\begin{thm}
	Cohen--Macaulay rings are universally catenary.
\end{thm}
\begin{proof}
	Since equation~\eqreff{eq:catenarity} is easily seen to be a local property, Corollary~\reff{cor:CMcatenary} shows that all CM rings (local or not) are catenary. After Proposition~\reff{prop:polynomialCM}, all that remains to check is that quotients of catenary rings are catenary again, i.e., \eqreff{eq:catenarity} holds for $R/I$ if it holds for $R$ when $I\subseteq R$ is any ideal. This is easy to see. 
\end{proof}
\begin{cor}\lbl{cor:unmixed}
	If $R$ is CM, it is \defemph{unmixed} (i.e., has no embedded associated primes).
\end{cor}
\begin{rem*}
	Note that in the lecture Professor Franke also claimed that $R$ is \emph{equidimensional}, i.e., all irreducible components have the same dimension. However, \cite[p.\ 458]{eisenbudCommAlg} claims that this is false in general and proves it only for local CM rings, which we did in Corollary~\reff{cor:CMcatenary} as well.
\end{rem*}
\begin{proof}[Proof of Corollary~\reff{cor:unmixed}]
	By Proposition~\reff{prop:AssLocalization}, a proper inclusion of associated primes will still be there after localizing at a maximal ideal containing both. So we may assume that $R$ is local. Let $\pp\in\Ass_R(R)$ be an associated prime, then $\dim(R/\pp)\geq\depth_R(R)=\dim R$ by Corollary~\reff{cor:dimRp>depthM}\itememph{a}, hence $\hoehe(\pp)=\dim R-\dim (R/\pp)=0$ by catenarity. 
\end{proof}
\section{Gorenstein rings and local complete intersection rings}
To finish the final lecture, Professor Franke teases us with another two classes of rings lying between regular local and CM rings. Unfortunately, we didn't have the time to go into any detail.
\begin{thm}\lbl{thm:Gorenstein}
	For a Noetherian local ring $R$ with maximal ideal $\mm$ and residue field $k$, the following conditions are equivalent.
	\begin{alphanumerate}
		\item $\idim_R(R)<\infty$.
		\item $\idim_R(R)=\dim R$.
		\item $\Ext_R^p(k,R)$ vanishes for $p\gge 0$.
		\item $\Ext_R^p(k,R)$ vanishes for $p>\dim R$.
		\item $\Ext_R^{\dim R}(k,R)\cong k$.
		\item $R$ has a parameter ideal which is \defemph{irreducible} in the sense of Lasker (i.e., not the intersection of two larger ideals).
		\item Any parameter ideal is irreducible in the sense of Lasker.
	\end{alphanumerate}
\end{thm}
\begin{proof}
	Cf.\ \cite[Theorem~18.1]{matsumuraCRT}
\end{proof}
\begin{defi}
	A Noetherian local ring with the equivalent properties from Theorem~\reff{thm:Gorenstein} is called \defemph{Gorenstein} ring.
\end{defi}
\begin{example*}
	\begin{alphanumerate}
		\item Regular local rings are Gorenstein. Indeed, from Theorem~\reff{thm:SerreRegularity}\itememph{c} it is clear that they fulfill Theorem~\reff{thm:Gorenstein}\itememph{d}.
		\item $R/(p^n)$ is Gorenstein when $R$ is a PID. The same holds for $R/\pp^n$ when $R$ is a Dedekind domain and $\pp\in\Spec R$.
		\item The ring $A=k[X,Y]/(X^{2018},Y^{2018})$ is Gorenstein. Indeed, it is zero-dimensional, so $(0)$ is a parameter ideal. Also, $(0)$ can't be written as the intersection of two non-zero ideals as it is easy to see that any non-zero ideal must contain $X^{2017}Y^{2017}$. Thus Theorem~\reff{thm:Gorenstein}\itememph{f} applies.
		
		However, $B=k[X,Y]/(X^2,XY,Y^2)$ is not Gorenstein. Indeed, $(0)$ is a parameter ideal again that can be written as $(0)=(X)\cap (Y)$. But $B$ is CM, as is any zero-dimensional Noetherian ring (since then equality is trivial in Definition~\reff{def:localCM}).
		
		It is also easy to give examples of universally catenary rings which are not CM. Indeed, it suffices to take an algebra of finite type over a field $k$ (or a CM ring) which is not equidimensional -- e.g., the coordinate ring of a variety with irreducible components of different dimension such as $k[X,Y,Z]/(XY,XZ)$.
	\end{alphanumerate}
\end{example*}
At this point, Professor Franke tried to define the notion of \defemph{local complete intersection} rings, but it's probably best you look this up in \cite[\S 21]{matsumuraCRT}. One has a chain of proper inclusions
\begin{align*}
	\left\{\begin{array}{c}
		\text{regular}\\
		\text{local rings}
	\end{array}\right\}\subsetneq 
	\left\{\begin{array}{c}
	\text{local complete}\\
	\text{intersections}
	\end{array}\right\}\subsetneq
	\left\{\begin{array}{c}
	\text{Gorenstein}\\
	\text{rings}
	\end{array}\right\}\subsetneq
	\left\{\begin{array}{c}
	\text{Cohen--Macaulay}\\
	\text{rings}
	\end{array}\right\}\;,
\end{align*}
and all of them are universally catenary.


\appendix
\chapter{Appendix}
\setcounter{thm}{0}
\renewcommand*{\thethm}{\Alph{thm}}

\section{An excursion in derived functors}
\subsection{Construction of derived functors}
\begin{defi}\lbl{def:homologicalfunctor}
	Let $\Aa$ and $\Bb$ be abelian categories (cf. \cite[Definition~A.1.4]{alggeo2}). A \defemph{homological $\partial$-functor} $F_\bullet \colon\Aa\morphism\Bb$ is a sequence $(F_n)_{n\geq 0}$  of additive functors $F_i\colon\Aa\morphism\Bb$ together with a natural transformation $\partial=\partial_F\colon F_{i+1}(A'')\morphism F_i(A')$ on the category of short exact sequences on $\Aa$, such that the sequence
	\begin{multline*}
		\ldots\morphism F_{i+1}(A'')\morphism[\partial]F_i(A')\morphism F_i(A)\morphism F_i(A'')\morphism[\partial]\ldots\\
		\ldots\morphism F_{1}(A'')\morphism[\partial]F_0(A')\morphism F_0(A)\morphism F_0(A'')\morphism 0\;.
	\end{multline*}
	is exact whenever $0\morphism A'\morphism A\morphism A''\morphism 0$ is a short exact sequence in $\Aa$.
	
	A \defemph{morphism} $F_\bullet \morphism[\phi]G_\bullet $ of homological $\partial$-functors is a sequence $(\phi_n)_{n\geq0}$ of natural transformations $F_i\morphism[\phi_i]G_i$ such that for any short exact sequence $0\morphism A'\morphism A\morphism A''\morphism 0$ in $\Aa$ the diagram 
	\begin{diagram*}
		\node[ob] (F1A) at (0,1.5) {$F_{i+1}(A'')$};
		\node[ob] (G1A) at (0,0) {$G_{i+1}(A'')$};
		\node[ob] (FA) at (2.5,1.5) {$F_i(A')$};
		\node[ob] (GA) at (2.5,0) {$G_i(A')$};
		\scriptsize
		\draw[->] (F1A) -- (G1A) node[pos=0.5, left] {$\phi_{i+1}$};
		\draw[->] (FA) -- (GA) node[pos=0.5, right] {$\phi_{i}$};
		\draw[->] (F1A) -- (FA) node[pos=0.5, above] {$\partial_F$};
		\draw[->] (G1A) -- (GA) node[pos=0.5, above] {$\partial_G$};
	\end{diagram*}
	commutes.
	
	Similarly, a \defemph{cohomological $\partial$-functor} $F^\bullet \colon\Aa\morphism\Bb$ is a sequence $(F^n)_{n\geq 0}$ of additive functors $F^i\colon\Aa\morphism\Bb$ together with connecting morphism $\partial=\partial_F\colon F^i(A'')\morphism F^{i+1}(A')$ such that for a short exact sequence $0\morphism A'\morphism A\morphism A''\morphism 0$, the sequence 
	\begin{multline*}
		0\morphism F^0(A')\morphism F^0(A)\morphism F^0(A'')\morphism[\partial] F^1(A')\morphism\ldots\\
		\ldots\morphism[\partial]F^i(A')\morphism F^i(A)\morphism F^i(A'')\morphism[\partial]F^{i+1}(A')\morphism\ldots
	\end{multline*}
	 is required to be exact. And the notion of a \defemph{morphism} $F^\bullet \morphism[\phi]G^\bullet $ of cohomological $\partial$-functors is defined in the obvious way.
	
	Let $F\colon\Aa\morphism\Bb$ be a \emph{right-exact} functor, i.e., for any short exact sequence $0\morphism A'\morphism A\morphism A''\morphism 0$, the sequence $FA'\morphism FA\morphism FA''\morphism 0$ is exact (but that's not quite it, cf. Definition~\reff{def:leftrightexact}). A \defemph{left-derived functor} of $F$ is a homological functor $L_\bullet F$ from $\Aa$ to $\Bb$ with a natural isomorphism $L_0F\cong F$ such that for any homological functor $\Phi_\bullet \colon \Aa\morphism\Bb$, any natural transformation $\Phi_0\morphism L_0F$ extends in a unique way to a morphism $\Phi_\bullet \morphism L_\bullet F$ of homological functors.
	
	Similar, a functor $F\colon\Aa\morphism\Bb$ is \emph{right-exact} functor if $FA'\morphism FA\morphism FA''\morphism 0$ is exact for any short exact sequence $0\morphism A'\morphism A\morphism A''\morphism 0$ (and $F$ is \emph{additive}, cf. Definition~\reff{def:leftrightexact}). A \defemph{right-derived functor} of $F$ is a cohomological functor $R^\bullet F$ from $\Aa$ to $\Bb$ with a natural isomorphism $R^0F\cong F$ such that for any homological functor $\Psi^\bullet \colon \Aa\morphism\Bb$, any natural transformation $R^0F\morphism \Psi^0$ extends in a unique way to a morphism $R^\bullet F\morphism \Psi^\bullet $ of homological functors.
\end{defi}
\begin{rem}
	\begin{alphanumerate}
		\item It follows (by the usual Yoneda argument) that derived functors are unique up to unique isomorphism of (co)homological functors if they exist.
		\item If $F$ is left-exact in the above sense, it preserves monomorphisms and it can be shown that $0\morphism FX'\morphism FX\morphism FX''$ is exact even if only $0\morphism X'\morphism X\morphism X''$ is exact (a nasty technical proof which won't appear here). Similar for right-exact functors.
		\item A generalized definition drops the exactness assumptions and requires $F\morphism L_0F$ with the universal property that any diagram
		\begin{diagram*}
			\node[ob] (F) at (0,1.25) {$F$};
			\node[ob] (L) at (2.5,1.25) {$L_0F$};
			\node[ob] (Phi) at (1.25,0) {$\Phi_0$};
			\draw[->] (F) -- (L);
			\draw[->] (F) -- (Phi);
			\draw[->] (Phi) -- (L);
		\end{diagram*}
		can be uniquely extended to a morphism $\Phi_\bullet \morphism L_\bullet F$ of homological functors. Similar for right-derived functors.
	\end{alphanumerate}
\end{rem}
\begin{example}
	If $F$ is an exact functor, then left- and right-derived functors of $F$ are given by $L_0F=R^0F=F$ and $L_iF=R^iF=0$ for $i\geq 1$.
\end{example}
\begin{defi}\lbl{def:injective}
	An object $I$ in an abelian category $\Aa$ is \defemph{injective} iff the following equivalent conditions hold.
	\begin{alphanumerate}
		\item If $X\monomorphism[\xi] Y$ is a monomorphism, then any morphism $X\morphism[\iota] I$ extends to a morphism $Y\morphism I$ (i.e., $I$ is injective in the sense of Definition~\reff{def:injectiveModule}\itememph{b}).
		\item Any short exact sequence $0\morphism I\morphism X\morphism X''\morphism 0$ splits.
	\end{alphanumerate}
	The category $\Aa$ has \defemph{sufficiently many injective objects} if every object $X$ has a monomorphism $X\monomorphism I$ with $I$ injective.
\end{defi}
\begin{proof}
	To see \itememph{a} $\Rightarrow$ \itememph{b}, extend $\id_I$ to $X\morphism[\pi]I$, then $\pi$ gives a split of the exact sequence (the argument used in the case of $R$-modules still works in arbitrary abelian categories).
	
	For \itememph{b} $\Rightarrow$ \itememph{a} consider $C=\coker\Big(X\xrightarrow{\iota\times\xi}I\oplus Y\Big)$ and let $I\oplus Y\morphism[p]C$ be the associated morphism. Let $i=\id_I\times 0$ and $j=0\times\id_Y$ be the canonical inclusions $I\monomorphism I\oplus Y$ and $Y\monomorphism I\oplus Y$. We claim that the composition 
	\begin{align*}
		\alpha\colon I\morphism[i] I\oplus Y\morphism[p] C
	\end{align*}
	is a monomorphism. First note that $X\xrightarrow{\iota\times\xi}I\oplus Y$ is a monomorphism (since its composition with the projection to $Y$ equals $\xi$, which was supposed to be monic), hence it's the kernel of its own cokernel as we are working in an abelian category and thus every monomorphism is an \emph{effective monomorphism}, cf. \cite[Definition~A.1.3\itememph{d} and Definition~A.1.4]{alggeo2}. That is, $X=\ker(p)$ since $i$ is the kernel of its own cokernel. Suppose now that $T\morphism[\tau]I$ is a morphism satisfying $pi\tau=0$, then $i\tau$ factors over $X=\ker(p)$. We thus have a diagram
	\begin{diagram}[baseline=0.75cm-0.5ex][\lbl{diag:kernelStuff}]
		\node[ob] (t) at (0,1.5) {$T$};
		\node[ob] (x) at (0,0) {$X$};
		\node[ob] (i) at (2.5,1.5) {$I$};
		\node[ob] (iy) at (2.5,0) {$I\oplus Y$};
		\scriptsize
		\draw[->, dashed] (t) -- (x) node[pos=0.5, left] {$!\exists\ \vartheta$};
		\draw[->] (t) -- (i) node[pos=0.5, above] {$\tau$};
		\draw[->] (i)-- (iy) node[pos=0.5, right] {$i$};
		\draw[->] (x) -- (iy) node[pos=0.5, above] {$\iota\times\xi$};
		\tag{$*$}
	\end{diagram}
	Postcomposing with the canonical projection $I\oplus Y\epimorphism[\pi] Y$ we see that $\pi i\tau=0\circ\tau=0$, hence also
	$\xi\vartheta=0$ as \eqreff{diag:kernelStuff} commutes and $\pi\circ(\iota\times\xi)=\xi$. But $\xi$ is a monomorphism, hence $\vartheta=0$. By \eqreff{diag:kernelStuff}, this implies $\tau=0$ as $i$ is a monomorphism. This shows that $\alpha$ is indeed a monomorphism.
	
	We thus obtain a short exact sequence
	\begin{align*}
		0\morphism I\morphism C\morphism\coker(\alpha)\morphism 0
	\end{align*}
	which splits due to \itememph{b}, i.e., $C\cong I\oplus \coker(\alpha)$. Let $C\epimorphism[q] I$ be the associated projection. Consider the composition
	\begin{align*}
		Y\morphism[j] I\oplus Y\morphism[p] C\epimorphism[q] I\;.
	\end{align*}
	We claim that $\upsilon=-qpj$ is a morphism $Y\morphism[\upsilon] I$ extending $X\morphism[\iota]I$. We have $qp\circ(\iota\times\xi)=q\circ0=0$ since $C$ is precisely the cokernel of $\iota\times\xi$. Also $qp\circ (\iota\times0)=\iota$ as $qpi=\id_I$ by construction of $q$. Then 
	\begin{align*}
		\upsilon\xi=-qpj\xi=-qp\circ(0\times\xi)=qp\circ\big((\iota\times 0)-(\iota\times\xi)\big)=\iota-0=\iota\;,
	\end{align*}
	hence $\upsilon$ has indeed the required property.
\end{proof}
\begin{thm}\lbl{thm:DerivedFunctors}
	Let $\Aa,\Bb$ be an abelian categories where $\Bb$ has sufficiently many injective objects.
	\begin{alphanumerate}
		\item Any left-exact functor $\Aa\morphism[F]\Bb$ has a right-derived functor $R^\bullet F$.
		\item Let $\Phi^\bullet \colon \Aa\morphism\Bb$ be a cohomological functor, then $\Phi^\bullet $ is a right-derived functor of $\Phi^0$ iff $\Phi^pI=0$ for any injective object $I\in\Ob(\Aa)$ and all $p>0$.
		\item Let $\Ff\colon 0\morphism F'\morphism F\morphism F''\morphism0$ be a sequence of left-exact functors $\Aa\morphism\Bb$ and functor morphisms between them such that $0\morphism F'I\morphism F I\morphism F'' I\morphism 0$ is exact when $I$ is an injective object of $\Aa$. Then there is a unique sequence of natural transformations $R^iF''\morphism[d_\Ff]R^{i+1}F'$ such that
		\begin{multline*}
			0\morphism F'X\morphism F X\morphism F''X\morphism[d_\Ff]R^1 F'X\morphism\ldots\\
			\ldots\morphism R^{i-1} F''X\morphism[d_\Ff]R^i F'X\morphism R^i F X\morphism R^i F''X\morphism[d_\Ff]R^{i+1} F'X\morphism\ldots
		\end{multline*}
		is exact for arbitrary $X\in\Ob(\Aa)$ and such that the diagram
		\begin{diagram*}
			\node[ob] (F1A) at (0,1.5) {$R^i F''(X'')$};
			\node[ob] (G1A) at (0,0) {$R^{i+1} F''(X')$};
			\node[ob] (FA) at (3,1.5) {$R^{i+1} F'(X'')$};
			\node[ob] (GA) at (3,0) {$R^{i+2} F'(X')$};
			\scriptsize
			\draw[->] (F1A) -- (G1A) node[pos=0.5, left] {$\partial_{R^\bullet  F''}$};
			\draw[->] (FA) -- (GA) node[pos=0.5, right] {$-\partial_{R^\bullet  F'}$};
			\draw[->] (F1A) -- (FA) node[pos=0.5, above] {$d_\Ff$};
			\draw[->] (G1A) -- (GA) node[pos=0.5, above] {$d_\Ff$};
		\end{diagram*}
		commutes when $0\morphism X'\morphism X\morphism X''\morphism 0$ is a short exact sequence in $\Aa$ (note the minus sign on the right vertical arrow!).
	\end{alphanumerate}
\end{thm}
\begin{proof}
	We start by proving the \emph{if} part of \itememph{b}. Assume that $\Phi^pI=0$ for any injective $I$ and all $p>0$. Let $\alpha^0\colon\Phi^0\morphism\Psi^0$ be given. By induction on $n$, we construct $\alpha^k\colon\Phi^k\morphism\Psi^k$ for $k\leq n$ such that $\alpha^k\partial_\Phi=\partial_\Psi\alpha^{k-1}$ for $k=1,\ldots n$. For $ n=0$, this is trivial. Let $ n>0$ and $\alpha^k$ be constructed for $k< n$. To construct $\alpha^ n$, we consider any object $X$ of $\Aa$ and choose a monomorphism $X\monomorphism[\iota]I$ where $I$ is injective. When $ n>1$, we have a part of the long exact cohomology sequence for $0\morphism X\morphism[\iota]I\morphism X'=\coker(\iota)\morphism 0$,
	\begin{align*}
		0=\Phi^{ n-1}I\morphism\Phi^{ n-1}X'\morphism[\partial_\Phi]\Phi^ n X\morphism\Phi^ n I=0\;,
	\end{align*}
	giving an isomorphism $\partial_\Phi=\partial_{X,\iota}\colon\Phi^{ n-1}X'\isomorphism\Phi^ n X$. When $ n=1$, we still have $\Phi^1I=0$ and thus an isomorphism $\partial_{X,\iota}\colon\coker\big(\Phi^0I\morphism\Phi^0X'\big)\isomorphism\Phi^1X$. 
	
	We have $\partial_\Psi\colon\Psi^{ n-1}X'\morphism\Psi^ n X$ and put $\alpha_{X,\iota}^ n=\partial_\Psi\alpha_{X'}^{n-1}\partial_{X,\iota}^{-1}$ when $ n>1$. In the case $ n=1$, $\alpha^0$ induces a morphism
	\begin{align*}
		\coker\big(\Phi^0I\morphism\Phi^0X'\big)&\morphism[\ov{\alpha}^0]\coker\big(\Psi^0I\morphism\Psi^0X'\big)
	\end{align*}
	and we put $\alpha_{X,\iota}^1=\ov{\partial}_\Psi\ov{\alpha}^0\partial_{X,\iota}^{-1}$, where $\ov{\partial}_\Psi\colon \coker\big(\Psi^0I\morphism\Psi^0X'\big)\morphism\Psi^1X$ is obtained from $\partial_\Psi\colon\Psi^0X'\morphism\Psi^1X$ using the universal property of cokernels.
	
	We want to show that $\alpha_{X,\iota}^ n$ does not depend on $\iota$ and that $\alpha_X\coloneqq \alpha_{X,\iota}^n$ induces a natural transformation $\alpha^n\colon\Phi^n\morphism\Psi^n$. We can show both assertions at once by considering monomorphisms $X\monomorphism[\iota]I$ and $Y\monomorphism[\kappa]K$ into injective objects $I,K$ and any morphism $\xi\in\Hom_\Aa(X,Y)$ and showing $\Psi^n(\xi)\alpha_{X,\iota}^n=\alpha_{Y,\kappa}^n\Phi^n(\xi)$. When $X=Y$ and $\xi=\id_X$, this shows that $\alpha_{X,\iota}^n$ is independent of $\iota$ and the general case implies that $\alpha^n$ is a natural transformation. 
	
	Now let's do this! By injectivity of $K$ there exists some morphism $\hat{\xi}\colon I\morphism K$ such that $\hat{\xi}\iota=\kappa\xi$. We have an induced morphism $\xi'\colon X'\morphism Y'$ on the cokernels $X'=\coker(\iota)$ and $Y'=\coker(\kappa)$. This gives a commutative diagram 
	\begin{diagram*}
		\node[ob] at (-0.75,1.5) {$\Xx\colon$};
		\node[ob] at (-0.75,0) {$\Yy\colon$};
		\node[ob] (A) at (0,1.5) {$0$};
		\node[ob] (B) at (1.5,1.5) {$X$};
		\node[ob] (C) at (3,1.5) {$I$};
		\node[ob] (D) at (4.5,1.5) {$X'$};
		\node[ob] (E) at (6,1.5) {$0$};
		\node[ob] (A') at (0,0) {$0$};
		\node[ob] (B') at (1.5,0) {$Y$};
		\node[ob] (C') at (3,0) {$K$};
		\node[ob] (D') at (4.5,0) {$Y'$};
		\node[ob] (E') at (6,0) {$0$};
		\scriptsize
		\draw[->] (A) -- (B);
		\draw[->] (B) -- (C) node[pos=0.5, above] {$\iota$};
		\draw[->] (C) -- (D);
		\draw[->] (D) -- (E);
		\draw[->] (A') -- (B');
		\draw[->] (B') -- (C') node[pos=0.5, above] {$\kappa$};
		\draw[->] (C') -- (D');
		\draw[->] (D') -- (E');
		\draw[->] (B) -- (B') node[pos=0.5,left] {$\xi$};
		\draw[->,dashed] (C) -- (C') node[pos=0.5, left] {$\smash{\hat{\xi}}\vphantom{\xi}$};
		\draw[->,dotted] (D) -- (D') node[pos=0.5, left] {$\xi'$};
	\end{diagram*}
	with exact rows $\Xx,\Yy$. Let $n>1$. Our goal $\Psi^n(\xi)\alpha_{X,\iota}^n=\alpha_{Y,\kappa}^n\Phi^n(\xi)$ is precisely that the right face in the following cute (or cube?) little diagram commutes.
	\begin{diagram*}
		\node[ob] (A) at (0,3) {$\Phi^{n-1}X'$};
		\node[ob] (B) at (4,3) {$\Phi^nX$};
		\node[ob] (E) at (0,0) {$\Psi^{n-1}X'$};
		\node[ob] (F) at (4,0) {$\Psi^nX$};
		\node[ob] (D) at (2,4.5) {$\Phi^{n-1}Y'$};
		\node[ob] (C) at (6,4.5) {$\Phi^nY$};
		\node[ob] (G) at (6,1.5) {$\Psi^nY'$};
		\node[ob] (H) at (2,1.5) {$\Psi^{n-1}Y'$};
		\scriptsize
		\draw[->] (E) -- (H) node[pos=0.6, below right] {$\Psi^{n-1}(\xi')$};
		\draw[->] (A) -- (D) node[pos=0.5, above left] {$\Phi^{n-1}(\xi')$};
		\draw[->] (D) -- (H) node[pos=0.7, left] {$\alpha_{Y'}^{n-1}$};
		\draw[->] (A) -- (E) node[pos=0.7, left] {$\alpha_{X'}^{n-1}$};
		\draw[->] (H) -- (G) node[pos=0.3, below] {$\partial_\Psi$};
		\draw[->] (E) -- (F) node[pos=0.5, below] {$\partial_\Psi$};
		\draw[->] (D) -- (C) node[pos=0.5, above] {$\partial_\Phi=\partial_{Y,\kappa}$};
		\draw[line width=1.5ex, white] (A) -- (B);
		\draw[->] (A) -- (B) node[pos=0.5, above, fill=white] {$\partial_\Phi=\partial_{X,\iota}$};
		\draw[->] (B) -- (C) node[pos=0.4, above left] {$\Phi^n(\xi)$};
		\draw[->] (F) -- (G) node[pos=0.5, below right] {$\Psi^n(\xi)$};		
		\draw[line width=1.5ex, white] (B) -- (F);
		\draw[->] (B) -- (F) node[pos=0.7, right, fill=white] {$\alpha_{X,\iota}^n$};
		\draw[->] (C) -- (G) node[pos=0.7, right] {$\alpha_{Y,\kappa}^n$};
	\end{diagram*}
	
	 Indeed, the front and back faces commute by definition of $\alpha_{X,\iota}^n$ and $\alpha_{Y,\kappa}^n$. The top and bottom face commute since the connecting homomorphisms $\partial_\Phi$ and $\partial_\Psi$ are natural, i.e., compatible with morphisms of short exact sequences by Definition~\reff{def:homologicalfunctor}. The left face commutes by the induction assumption. As $\partial_{X,\iota}$ and $\partial_{Y,\kappa}$ are isomorphisms, this implies commutativity of the right face, as required. For $n=1$, a slight modification of the argument works again.
	
	We have seen that $\alpha^n$ is a well-defined natural transformation. It remains to show $\alpha^n\partial_\Phi=\partial_\Psi\alpha^{n-1}$. Let $0\morphism X'\morphism X\morphism X''\morphism 0$ be a short exact sequence. We choose an embedding $X'\monomorphism[\iota]I$ into some injective object $\iota$. This gives a commutative diagram with exact rows
		\begin{diagram*}
			\node[ob] at (-0.75,1.5) {$\Xx\colon$};
			\node[ob] at (-0.75,0) {$\Yy\colon$};
			\node[ob] (A) at (0,1.5) {$0$};
			\node[ob] (B) at (1.5,1.5) {$X'$};
			\node[ob] (C) at (3,1.5) {$X$};
			\node[ob] (D) at (4.5,1.5) {$X''$};
			\node[ob] (E) at (6,1.5) {$0$};
			\node[ob] (A') at (0,0) {$0$};
			\node[ob] (B') at (1.5,0) {$X'$};
			\node[ob] (C') at (3,0) {$I$};
			\node[ob] (D') at (4.5,0) {$\coker(\iota)$};
			\node[ob] (E') at (6,0) {$0$};
			\scriptsize
			\draw[->] (A) -- (B);
			\draw[->] (B) -- (C);
			\draw[->] (C) -- (D);
			\draw[->] (D) -- (E);
			\draw[->] (A') -- (B');
			\draw[->] (B') -- (C') node[pos=0.5, above] {$\iota$};
			\draw[->] (C') -- (D');
			\draw[->] (D') -- (E');
			\draw[transform canvas={xshift=1pt}] (B) -- (B');
			\draw[transform canvas={xshift=-1pt}] (B) -- (B');
			\draw[->,dashed] (C) -- (C') node[pos=0.5, left] {$i$};
			\draw[->,dotted] (D) -- (D') node[pos=0.5, left] {$i''$};
		\end{diagram*}
		where $i$ exists by injectivity of $I$ and $i''$ is the induced morphism on cokernels. Now the claim $\alpha^n\partial_\Phi=\partial_\Psi\alpha^{n-1}$ follows by another cubic diagram chase. We have
		\begin{diagram*}
			\node[ob] (A) at (0,3) {$\Phi^{n-1}X''$};
			\node[ob] (B) at (4,3) {$\Phi^nX'$};
			\node[ob] (E) at (0,0) {$\Psi^{n-1}X''$};
			\node[ob] (F) at (4,0) {$\Psi^nX'$};
			\node[ob] (D) at (2,4.5) {$\Phi^{n-1}\big(\coker(\iota)\big)$};
			\node[ob] (C) at (6,4.5) {$\Phi^nX'$};
			\node[ob] (G) at (6,1.5) {$\Psi^nX'$};
			\node[ob] (H) at (2,1.5) {$\Psi^{n-1}\big(\coker(\iota)\big)$};
			\scriptsize
			\draw[->] (E) -- (H) node[pos=0.6, below right] {$\Psi^{n-1}(i'')$};
			\draw[->] (A) -- (D) node[pos=0.5, above left] {$\Phi^{n-1}(i'')$};
			\draw[->] (D) -- (H) node[pos=0.7, left] {$\alpha_{\coker(\iota)}^{n-1}$};
			\draw[->] (A) -- (E) node[pos=0.7, left] {$\alpha_{X''}^{n-1}$};
			\draw[->] (H) -- (G) node[pos=0.6, above] {$\partial_\Psi$};
			\draw[->] (E) -- (F) node[pos=0.5, below] {$\partial_\Psi$};
			\draw[->] (D) -- (C) node[pos=0.5, above] {$\partial_\Phi$};
			\draw[line width=1.5ex, white] (A) -- (B);
			\draw[->] (A) -- (B) node[pos=0.7, above, fill=white] {$\partial_\Phi$};
			\draw[transform canvas={xshift=-0.6pt, yshift=0.8pt}] (B) -- (C);
			\draw[transform canvas={xshift=0.6pt, yshift=-0.8pt}] (B) -- (C);
			\draw[transform canvas={xshift=-0.6pt, yshift=0.8pt}] (F) -- (G);
			\draw[transform canvas={xshift=0.6pt, yshift=-0.8pt}] (F) -- (G);
			\draw[line width=1.5ex, white] (B) -- (F);
			\draw[->] (B) -- (F) node[pos=0.7, right, fill=white] {$\alpha_{X'}^n$};
			\draw[->] (C) -- (G) node[pos=0.7, right] {$\alpha_{X'}^n$};
		\end{diagram*}
		The top and bottom face commute by naturality of $\partial_\Phi$ and $\partial_\Psi$. The left face commutes because $\alpha^{n-1}$ is a natural transformation. The back face commutes by Definition of $\alpha_{X'}^n$ and on the right face nothing really happens. Hence the front face commutes as well. This shows the desired equality, thus completing the inductive construction of the $\alpha^n$ and showing the existence part of the universal property of a right-derived functor for $\Phi^0$.
		
		For uniqueness, let $\alpha\colon \Phi^\bullet \morphism\Psi^\bullet $ be any morphism of cohomological functors. Let $X$ be any object and $0\morphism X\morphism[\iota]I\morphism X''\morphism 0$ any short exact sequence with $I$ injective. As $\alpha$ is a morphism of cohomological functors, it is compatible with $\partial_\Phi$ and $\partial_\Psi$ for this short exact sequence. That is,
		\begin{align*}
		 \alpha_X^n\partial_\Phi=\partial_\Psi\alpha_{X'}^{n-1}\;.
		\end{align*}
		Again, for $n>1$ the connecting morphism $\partial_\Phi=\partial_{X,\iota}$ is an isomorphism by vanishing of $\Phi^{n-1}I$ and $\Phi^nI$, hence $\alpha_X^n=\partial_\Psi\alpha_{X'}^{n-1}\partial_{X,\iota}^{-1}$. For $n=1$, we need to make the same modification as above. In either case, this shows that the above construction of $\alpha^n$ from $\alpha^0$ is the only possible one. This shows the uniqueness part and thus the \emph{if} part of \itememph{b}.
		
		Before we can pursue the proof, we need some homological algebra, namely, the horseshoe lemma.
		
		\begin{defi}
			An \defemph{injective resolution} of an object $X$ of an abelian category $\Aa$ is a long exact sequence
			\begin{align*}
				0\morphism X\morphism[\xi]I^0\morphism[d^0]I^ 1\morphism[d^1]\ldots
			\end{align*}
			with $I^0,I^1,\ldots$ injective.
		\end{defi}
		\begin{fact}\lbl{fact:injectiveResolutions}
			In an abelian category $\Aa$ with sufficiently many injective objects, injective resolutions exist for any object.
		\end{fact}
		\begin{proof}
			Indeed, for $X\in\Ob(\Aa)$ choose a monomorphism $X\monomorphism[\xi]I^0$, then a monomorphism $\coker(\xi)\monomorphism I^1$, then a monomorphism $\coker\big(I^0\morphism I^1\big)\monomorphism I^2$ and so on.
		\end{proof}
		\begin{prop}[Horseshoe lemma]\lbl{prop:Hufeisenlemma}
			Let $X\monomorphism[\xi]I^\bullet $ and $Y\monomorphism[\upsilon]J^\bullet $ be injective resolutions of $X$ and $Y$. 
			\begin{alphanumerate}
				\item If $f\colon X\morphism Y$ is any morphism, then there is a morphism $\phi\colon I^\bullet \morphism J^\bullet $ compatible with $f$ in the sense that $\upsilon f=\phi^0\xi$. 
				\item The extension from \itememph{a} is unique up to cochain homotopy. If $\psi$ is a different morphism of cochain complexes with the same property then there is a cochain homotopy $s$, where $s^n\colon I^n\morphism J^{n-1}$, between $\phi $ and $\psi $. That is,
				\begin{align*}
					d_{J }^{n-1}s^n+s^{n+1}d_{I }^{n}=\psi^n-\phi^n
				\end{align*}
				and $s^0=0$.
				\item If $0\morphism X\morphism[\alpha] Z\morphism[\beta] Y\morphism 0$ is a short exact sequence, there exists an injective resolution $Z\monomorphism[\zeta]K^\bullet $ of $Z$ such that 
				\begin{diagram}[baseline=-2.25cm-0.5ex]{\lbl{diag:resolution}}
					\node[ob] (0lO) at (-4,0) {$0$};
					\node[ob] (X) at (-2,0) {$X$};
					\node[ob] (Z) at (0,0) {$Z$};
					\node[ob] (Y) at (2,0) {$Y$};
					\node[ob] (0rO) at (4,0) {$0$};
					\node[ob] (0l0) at (-4,-1.5) {$0$};
					\node[ob] (I0) at (-2,-1.5) {$I^0$};
					\node[ob] (K0) at (0,-1.5) {$K^0$};
					\node[ob] (J0) at (2,-1.5) {$J^0$};
					\node[ob] (0r0) at (4,-1.5) {$0$};
					\node[ob] (0l1) at (-4,-3) {$0$};
					\node[ob] (I1) at (-2,-3) {$I^1$};
					\node[ob] (K1) at (0,-3) {$K^1$};
					\node[ob] (J1) at (2,-3) {$J^1$};
					\node[ob] (0r1) at (4,-3) {$0$};
					\node[ob] (Idots) at (-2,-4.5) {$\vdots$};
					\node[ob] (Kdots) at (0,-4.5) {$\vdots$};
					\node[ob] (Jdots) at (2,-4.5) {$\vdots$};
					\scriptsize
					\draw[->] (0lO) -- (X);
					\draw[->] (X) -- (Z) node[pos=0.5, above] {$\alpha$};
					\draw[->] (Z) -- (Y) node[pos=0.5, above] {$\beta$};
					\draw[->] (Y) -- (0rO);
					\draw[->] (0l0) -- (I0);
					\draw[->] (I0) -- (K0);
					\draw[->] (K0) -- (J0);
					\draw[->] (J0) -- (0r0);
					\draw[->] (0l1) -- (I1);
					\draw[->] (I1) -- (K1);
					\draw[->] (K1) -- (J1);
					\draw[->] (J1) -- (0r1);
					\draw[->] (X) -- (I0) node[pos=0.5, left] {$\xi$};
					\draw[->] (I0) -- (I1);
					\draw[->] (I1) -- (Idots);
					\draw[->] (Z) -- (K0) node[pos=0.5, left] {$\zeta$};
					\draw[->] (K0) -- (K1);
					\draw[->] (K1) -- (Kdots);
					\draw[->] (Y) -- (J0) node[pos=0.5, left] {$\upsilon$};
					\draw[->] (J0) -- (J1);
					\draw[->] (J1) -- (Jdots);
					\tag{\S}
				\end{diagram}
				is a commutative diagram whose rows are short exact sequences which are split save for the first one.
			\end{alphanumerate}
		\end{prop}
		\begin{rem}
			\begin{alphanumerate}
				\item \lbl{rem:Hufeisen}Let $Z^n(I^\bullet )=\ker(d_{I }^n)$ and $Z^n(J^\bullet )=\ker(d_{J }^n)$. Then $\phi$ and $\psi$ induce morphisms $\phi,\psi\colon Z^n(I^\bullet )\morphism Z^n(J^\bullet )$ and Proposition~\reff{prop:Hufeisenlemma}\itememph{b} shows that $\psi-\phi=d_{J }^{n-1}s^n$ on $Z^n(I^\bullet )$, that is, they differ by a coboundary and thus induce the same morphisms in cohomology.
				\item The assumption that $\Aa$ has sufficiently many injective objects is not required. As the proof will show, it also suffices to have $0\morphism Y\morphism[\upsilon]J^\bullet $ a cochain complex with injective $J^n$ (thus dropping exactness) and 
				\begin{align*}
					0\morphism X\morphism[\xi]I^0\morphism[d_I^0]I^1\morphism[d_I^1]\ldots 
				\end{align*}
				a long exact sequence in which the $I^n$ may fail to be injective. 
			\end{alphanumerate}
		\end{rem}
		Before we prove Proposition~\reff{prop:Hufeisenlemma}, let's see how the rest of Theorem~\reff{thm:DerivedFunctors} follows from it. We first prove \itememph{a}. Let $F\colon\Aa\morphism \Bb$ be left-exact. For every object $X$ of $\Aa$, chose an injective resolution $X\monomorphism I_X^\bullet $ of $X$ (and we need the axiom of choice -- for \emph{classes!} -- to do this). For every morphism $f\colon X\morphism Y$ choose an extension $f^*\colon I_X^\bullet \morphism I_Y^\bullet $ of $f$. Let
		\begin{align*}
			R^pF(X)=H^p(FI_X^\bullet )\quad\text{and}\quad R^pF(f)=H^p\Big(FI_X^\bullet \morphism[Ff^* ]FI_Y^\bullet \Big)\;.
		\end{align*}
		We need to show that the $R^pF$ are functors. That $R^pF(\id_X)=\id_{R^pF(X)}$ (even when $\id_X^* \neq \id_{I_X^\bullet }$) follows from Proposition~\reff{prop:Hufeisenlemma}\itememph{b} and Remark~\reff{rem:Hufeisen}\itememph{a}. When $X\morphism[f]Y\morphism[g]Z$, the morphisms 
		\begin{align*}
			I_X^\bullet \xdoublemorphism[g^* f^* ][(gf)^* ]I_Z^\bullet 
		\end{align*}
		are cochain homotopic by Proposition~\reff{prop:Hufeisenlemma}\itememph{b}. Applying the additive functor\footnote{This got me really confused in the lecture, because we never explicitly required $F$ to be additive (that was back then -- now we do in Definition~\reff{def:homologicalfunctor}). The reason is that \emph{left-exact} means more than it seems; cf. Definition~\reff{def:leftrightexact} and Remark~\reff{rem:left-exactAdditive}.} $F$ gives cochain homotopic morphisms $F(g^* f^* )$ and $F(g^* )F(f^*)$, showing that the induced morphisms in cohomology coincide, i.e., $R^pF(gf)=R^pF(g)\circ R^pF(f)$. Thus, $R^pF$ is indeed a functor.
		
		To construct the long exact cohomology sequence for $R^pF$, consider a short exact sequence $0\morphism X\morphism[\alpha]Z\morphism[\beta]Y\morphism 0$ and construct a short exact sequence $0\morphism I_X^\bullet \morphism[a ] K^\bullet \morphism[b ] I_Y^\bullet \morphism 0$ as in Proposition~\reff{prop:Hufeisenlemma}\itememph{c}. We obtain a short exact sequence $0\morphism FI_X^\bullet \morphism FK^\bullet \morphism FI_Y^\bullet \morphism 0$ (using Proposition~\reff{prop:injectiveSeqsStayExact}) and a long exact sequence 
		\begin{diagram}[baseline=0.75cm-0.5ex]{\lbl{diag:derivedCohoSeq}}
			\node[ob] (HpFK) at (0,1.5) {$H^p(FK^\bullet )$};
			\node[ob] (RpFX) [left=0.575 of HpFK] {$R^pF(X)$};			
			\node[ob] (RpFY) [right=0.575 of HpFK] {$R^pF(Y)$};
			\node[ob] (Rp1FY) [left=0.575 of RpFX] {$R^{p-1}F(Y)$};
			\node[ob] (Rp1FX) [right=0.575 of RpFY] {$R^{p+1}F(X)$};
			\node[ob] (ldots) [left=0.575 of Rp1FY] {$\ldots$};
			\node[ob] (rdots) [right=0.575 of Rp1FX] {$\ldots$};
			\node[ob] (RpFZ) at (0,0) {$R^pF(Z)$};
			\scriptsize
			\draw[->] (ldots) -- (Rp1FY);
			\draw[->] (Rp1FY) -- (RpFX) node[pos=0.5, above] {$\partial$};
			\draw[->] (RpFX) -- (HpFK);
			\draw[->] (HpFK) -- (RpFY);
			\draw[->] (RpFY) -- (Rp1FX) node[pos=0.5, above] {$\partial$};
			\draw[->] (Rp1FX) -- (rdots);
			\draw[->] (HpFK) -- (RpFZ) node[pos=0.5, above=-0.25ex, sloped] {$\sim$};
			\draw[->, dashed] (RpFX) -- (RpFZ);
			\draw[->, dashed] (RpFZ) -- (RpFY);
			\tag{\#}
		\end{diagram}
		The vertical arrow is obtained by choosing morphisms $\kappa_1\colon K^\bullet \morphism I_Z^\bullet $ and $\kappa_2\colon I_Z^\bullet \morphism K^\bullet $ of cochain complexes. They exist by Proposition~\reff{prop:Hufeisenlemma}\itememph{a}; and Proposition~\reff{prop:Hufeisenlemma}\itememph{b} shows that $\kappa_1$ and $\kappa_2$ are cochain homotopy equivalences. Applying $F$ gives $FK^\bullet \xrightarrow{F\kappa_1 }FI_Z^\bullet $ and $FI_Z^\bullet \xrightarrow{F\kappa_2 }FK^\bullet $ such that $F(\kappa_1 )F(\kappa_2 )$ and $F(\kappa_2 )F(\kappa_1 )$ are cochain homotopic to $\id_{FI_Z^\bullet }$ and $\id_{FK^\bullet }$ respectively. It follows that $F(\kappa_1 )$ and $F(\kappa_2 )$ induce isomorphisms on cohomology which are inverse to each other, resulting in the vertical arrow of \eqreff{diag:derivedCohoSeq}.
		
		Also, to verify commutativity of \eqreff{diag:derivedCohoSeq}, one notes that $\alpha $ and $\kappa_1a $, and hence $F(\alpha )$ and $F(\kappa_1a )$, are cochain homotopic by Proposition~\reff{prop:Hufeisenlemma}\itememph{a}. Same for $\beta $ and $b \kappa_2$.
		
		This shows that $R^pF$ has the required long exact cohomology sequence. In a similar fashion one can show its functoriality on the category of short exact sequences in $\Aa$.
		
		If $X$ is injective, one can choose $I^\bullet \colon X\morphism 0\morphism 0\morphism\ldots$ and $X\monomorphism[\id_X]I^\bullet $ as injective resolution. Applying Proposition~\reff{prop:Hufeisenlemma}\itememph{b}, we get 
		\begin{align*}
			R^pF(X)=H^p(FI_X^\bullet )=H^p(FI^\bullet )=0\quad\text{when }p>0
		\end{align*}
		and, for arbitrary $X\in\Ob(\Aa)$ (injective or not), a canonical isomorphism
		\begin{align*}
			R^0F(X)=\ker(FI_X^0\morphism FI_X^1)\cong F\big(\ker(I_X^0\morphism I_X^1)\big)\cong F(X)\;.
		\end{align*}
		(using that $F$ is left-exact, hence commutes with kernels). By the \emph{if} part of \itememph{b} that was already proved, $R^\bullet F$ is a right-derived functor of $F$.
		
		The \emph{only if} part of \itememph{b} is an immediate consequence. Let $\Phi^\bullet $ be the right-derived functor of $F=\Phi^0$, then $\Phi^\bullet \cong R^\bullet F$ by the universal property of derived functors. By the above, $\Phi^pI=R^pF(I)=0$ when $I$ is injective.
		
		Part \itememph{c}. Let $0\morphism F'\morphism F\morphism F''\morphism 0$ be a sequence of left-exact functors which is exact on injective objects. Choosing $I_X^\bullet $ as in the above construction, we get a short exact sequence
		\begin{align}\lbl{eq:shortExactFunctorSequence}
			0\morphism F'I_X^\bullet \morphism FI_X^\bullet \morphism F''I_X^\bullet \morphism 0\tag{$*$}
		\end{align}
		and this gives a long exact cohomology sequence which is functorial in $X$ as \eqreff{eq:shortExactFunctorSequence} is. The anti-commutativity of connecting morphisms (with $0\morphism X\morphism Z\morphism Y\morphism 0$ a short exact sequence) comes from the analogous (and well-known) assertion for the connecting morphisms in the diagram 
		\begin{diagram*}
			\node[ob] (0Xo) at (-2, 3) {$0$};
			\node[ob] (0Zo) at (0, 3) {$0$};
			\node[ob] (0Yo) at (2, 3) {$0$};
			\node[ob] (0Xu) at (-2, -3) {$0$};
			\node[ob] (0Zu) at (0, -3) {$0$};
			\node[ob] (0Yu) at (2, -3) {$0$};
			\node[ob] (0'l) at (-4, 1.5) {$0$};
			\node[ob] (0l) at (-4, 0) {$0$};
			\node[ob] (0''l) at (-4, -1.5) {$0$};
			\node[ob] (0'r) at (4, 1.5) {$0$};
			\node[ob] (0r) at (4, 0) {$0$};
			\node[ob] (0''r) at (4, -1.5) {$0$};
			\node[ob] (F'X) at (-2, 1.5) {$F'I_X^\bullet $};
			\node[ob] (FX) at (-2, 0) {$FI_X^\bullet $};
			\node[ob] (F''X) at (-2, -1.5) {$F''I_X^\bullet $};
			\node[ob] (F'Z) at (0, 1.5) {$F'K^\bullet $};
			\node[ob] (FZ) at (0, 0) {$FK^\bullet $};
			\node[ob] (F''Z) at (0, -1.5) {$F''K^\bullet $};
			\node[ob] (F'Y) at (2, 1.5) {$F'I_Y^\bullet $};
			\node[ob] (FY) at (2, 0) {$FI_Y^\bullet $};
			\node[ob] (F''Y) at (2, -1.5) {$F''I_Y^\bullet $};
			\draw[->] (0Xo) -- (F'X);
			\draw[->] (F'X) -- (FX);
			\draw[->] (FX) -- (F''X);
			\draw[->] (F''X) -- (0Xu);
			\draw[->] (0Zo) -- (F'Z);
			\draw[->] (F'Z) -- (FZ);
			\draw[->] (FZ) -- (F''Z);
			\draw[->] (F''Z) -- (0Zu);
			\draw[->] (0Yo) -- (F'Y);
			\draw[->] (F'Y) -- (FY);
			\draw[->] (FY) -- (F''Y);
			\draw[->] (F''Y) -- (0Yu);
			\draw[->] (0'l) -- (F'X);
			\draw[->] (F'X) -- (F'Z);
			\draw[->] (F'Z) -- (F'Y);
			\draw[->] (F'Y) -- (0'r);
			\draw[->] (0l) -- (FX);
			\draw[->] (FX) -- (FZ);
			\draw[->] (FZ) -- (FY);
			\draw[->] (FY) -- (0r);
			\draw[->] (0''l) -- (F''X);
			\draw[->] (F''X) -- (F''Z);
			\draw[->] (F''Z) -- (F''Y);
			\draw[->] (F''Y) -- (0''r);
		\end{diagram*}
		(where $K^\bullet $ is the same as in the proof of \itememph{a}).
\end{proof}
\begin{proof}[Proof of Proposition~\reff{prop:Hufeisenlemma}]
	Part \itememph{a}. For $n\geq 1$ denote the image of $d_{I }^{n-1}\colon I^{n-1}\morphism I^n$ by $B^n\subseteq I^n$ and let $B^0\subseteq I^0$ be the image of $\xi$. As $B^0\cong X$ we have a morphism $f^0\colon B^0\morphism J^0$ such that $\upsilon f=f^0\xi$.
	
	We now construct the required morphisms $\phi $ inductively. Let $n\geq 0$ and suppose that $\phi^k\colon I^k\morphism J^k$ have already been constructed for $k=-1,\ldots,n-1$ (where $\phi^{-1}=f$) as well as $f^n\colon B^n\morphism J^n$ such that
	\begin{align}\lbl{eq:Horseshoe1}
		d_{J }^{k-1}\phi^{k-1}=\phi^kd_{I }^{k-1}\quad\text{ for }k< n\quad\text{ and }\quad d_{J  }^{n-1}\phi^{n-1}=f^nd_{I }^n\tag{\&}
	\end{align}
	(where we set $d_{I }^{-1}=\xi$ and $d_{J }^{-1}=\upsilon$). Let $\phi^n\colon I^n\morphism J^n$ be any extension of $f^n$ using that $J^n$ is injective and $B^n\monomorphism I^n$ a monomorphism. We have
	\begin{align*}
		d_{J }^{n}\phi ^nd_{I }^{n-1}=d_{J }^{n}f^nd_{I }^{n-1}=d_{J }^nd_{J }^{n-1}\phi^{n-1}=0\;,
	\end{align*}
	hence $d_{J }^n\phi^n\colon I^n\morphism J^{n+1}$ factors over $\coker(d_{I }^{n-1})\cong I^n/B^n=I^n/Z^n(I^\bullet )\cong B^{n+1}$ by exactness of the resolution, which gives $f^{n+1}\colon B^{n+1}\morphism J^{n+1}$. Then $\phi^n$ and $f^{n+1}$ satisfy \eqreff{eq:Horseshoe1} again, which completes the induction.
	
	Part \itememph{b}. Professor Franke suggests the horseshoe lemma is best understood if you work out the proof for yourself, so you might want to do just that instead. However, for the sake of completeness of these notes I will now include the proof I obediently worked out for myself.
	
	Let $\psi $ be another lift of $f$. Then $(\psi^0-\phi^0)\xi=\upsilon f-\upsilon f=0$, hence $\psi^0-\phi^0$ factors over $\coker(\xi)=I^0/B^0\cong B^1$, hence we get a morphism $\sigma^1\colon B^1\morphism J^0$ such that $\sigma^1d_{I }^0=\psi^0-\phi^0$. Let $s^1\colon I^1\morphism J^0$ be any extension of $\sigma^1$ using injectivity of $J^0$. We now construct the required cochain homotopy $s^\bullet $ inductively, letting $s^0=0$. Let $n\geq 1$ and suppose that $s^k\colon I^k\morphism J^{k-1}$ has already been constructed for $k\leq n$ such that
	\begin{align}\lbl{eq:Horseshoe2}
		 d_{J }^{k-1}s^k+s^{k+1}d_{I }^k=\psi^k-\phi^k\quad\text{ for }k<n\;.\tag{\%}
	\end{align}
	Then
	\begin{align*}
		\left(\psi^n-\phi^n-d_{J }^{n-1}s^n\right)d_{I }^{n-1}&=d_{J }^{n-1}\left(\psi^{n-1}-\phi^{n-1}\right)-d_{J }^{n-1}s^nd_{I }^{n-1}\\
		&=d_{J }^{n-1}\left(d_{J }^{n-2}s^{n-1}+s^nd_{I }^{n-1}\right)-d_{J }^{n-1}s^nd_{I }^{n-1}\\
		&=d_{J }^{n-1}d_{J }^{n-2}s^{n-1}\\
		&=0\;,
	\end{align*}
	hence $\psi^n-\phi^n-d_{J }^{n-1}s^n$ factors over $\coker(d_{I }^{n-1})=I^n/B^n\cong B^{n+1}$, giving a morphism $\sigma^{n+1}\colon B^{n+1}\morphism J^n$, which we extend to some $s^{n+1}\colon I^{n+1}\morphism J^n$ with the required property \eqreff{eq:Horseshoe2} for $k=n$, using that $J^n$ is injective. This finishes the induction step.
	
	Part \itememph{c}. By Definition~\reff{def:injective}\itememph{b}, the rows of \eqreff{diag:resolution} except the first are automatically split, so we have no choice but $K^n=I^n\oplus J^n$ for all $n\geq 0$. By Definition~\reff{def:injective}\itememph{a} it is clear that the $K^n$ are injective again. Let $i^n\colon I^n\morphism K^n$ denote the canonical inclusion and $j^n\colon K^n\morphism J^n$ the canonical projection. We need to construct the $d_{K }^n$ and $\zeta$, which will be yet another inductive lifting argument.
	 
	 As $\alpha$ is a monomorphism, we can extend $\xi$ to some $\hat{\xi}\colon Z\morphism I^0$. Let $\zeta=\hat{\xi}\times \upsilon\beta$. Then $d_{I }^0\hat{\xi}\alpha=d_{I }^0\xi=0$, hence $d_{I }^0\hat{\xi}$ factors over $\coker(\alpha)=Y$. This gives $\delta^0\colon Y\morphism I^1$ such that $d_{I }^0\hat{\xi}=\delta^0\beta$. Since $\upsilon$ is a monomorphism and $I^1$ injective, we can extend $-\delta^0$ to some $d^0\colon J^0\morphism I^1$. We define $d_{K }^0=(d_{I }^0+d^0)\times d_{J }^0$. By construction, this satisfies $d_{K }^0\zeta=0$.
	 
	 Let $n\geq 0$ and suppose we have already constructed $d_{K }^k=(d_{I }^k+d^k)\times d_{J }^k$ for $k\leq n$, where $d^k\colon J^k\morphism I^{k+1}$ satisfies
	 \begin{align}\lbl{eq:Horseshoe3}
	 	 d_{I }^kd^{k-1}+d^kd_{J }^{k-1}=0\quad\text{ for }k=1,\ldots,n\;.\tag{\$}
	 \end{align}
	  In particular, we have $d_{K }^kd_{K }^{k-1}=0$ and $d_{K }^0\zeta=0$. Then
	 \begin{align*}
	 	d_{I }^{n+1}d^nd_{J }^{n-1}=d_{I }^{n+1}\left(-d_{I }^nd^{n-1}\right)=0\;,
	 \end{align*}
	 hence $d_{I }^{n+1}d^n$ factors over $\coker(d_{J }^{n-1})=\Im(d_{J }^n)$. This gives $\delta^{n+1}\colon \Im(d_{J }^n)\morphism I^{n+2}$, and $-\delta^{n+1}$ can be extended to some $d^{n+1}\colon J^{n+1}\morphism I^{n+2}$ (by injectivity of $I^{n+2}$) which satisfies $d_{I }^{n+1}d^{n}+d^{n+1}d_{J }^n=0$, i.e., \eqreff{eq:Horseshoe3} for $k=n+1$. Then $d_{K }^{n+1}=(d_{I }^{n+1}+d^{n+1})\times d_{J }^{n+1}$ fulfills $d_{K }^{n+1}d_{K }^n=0$ and the induction is complete.
	
	 It remains to verify that $Z\morphism[\zeta]K^\bullet $ is indeed a resolution, i.e., acyclic. But this is an immediate consequence of the long exact cohomology sequence for short exact sequences of chain complexes, since both $H^\bullet (I^\bullet )$ and $H^\bullet (J^\bullet )$ vanish.
\end{proof}
Left-derived functors of right-exact functors can be constructed by dualizing everything.
\begin{defi}\lbl{def:projective}
	An object $P$ in an abelian category $\Aa$ is \defemph{projective} iff the following equivalent conditions hold.
	\begin{alphanumerate}
		\item If $X\epimorphism[\xi] Y$ is an epimorphism, then any morphism $P\morphism[\pi] Y$ extends to a morphism $P\morphism X$ (i.e., $P$ is projective in the sense of Definition~\reff{def:projectiveModule}\itememph{b}).
		\item Any short exact sequence $0\morphism X'\morphism X\morphism P\morphism 0$ splits.
	\end{alphanumerate}
	The category $\Aa$ has \defemph{sufficiently many projective objects} if every object $X$ has an epimorphism $P\epimorphism X$ with $P$ injective.
\end{defi}
\begin{proof}
	Equivalence of \itememph{a} and \itememph{b} follows by dualizing the proof of Definition~\reff{def:injective}.
\end{proof}
\begin{defi}
	A \defemph{projective resolution} of an object $Y$ of an abelian category $\Aa$ is a long exact sequence
	\begin{align*}
		\ldots\morphism[d_1]P_1\morphism[d_0] P_0\morphism[\upsilon] Y\morphism 0
	\end{align*}
	with $P_0,P_1,\ldots$ projective.
\end{defi}
\begin{thm}\lbl{thm:LeftDerivedFunctors}
	Let $\Aa,\Bb$ be abelian categories where $\Aa$ has sufficiently many projective objects.
	\begin{alphanumerate}
		\item Any left-exact functor $\Aa\morphism[F]\Bb$ has a left-derived functor $L_\bullet F$.
		\item Let $\Phi_\bullet \colon \Aa\morphism\Bb$ be a homological functor, then $\Phi_\bullet $ is a right-derived functor of $\Phi_0$ iff $\Phi_pP=0$ for any projective object $P\in\Ob(\Aa)$ and all $p>0$.
		\item For a short sequence $\Ff\colon 0\morphism F'\morphism F\morphism F''\morphism0$ which is exact on projectives there is a long exact sequence
		\begin{multline*}
		\ldots\morphism L_{i+1} F''X\morphism[d_\Ff]L_i F'X\morphism L_i F X\morphism L_i F''X\morphism[d_\Ff]L_{i-1} F'X\morphism\ldots\\
		\ldots\morphism L_1 F'X\morphism[d_\Ff]\morphism F'X\morphism F X\morphism F''X\morphism 0
		\end{multline*}
		functorial in $X\in\Ob(\Aa)$ and such that the diagram
		\begin{diagram*}
			\node[ob] (F1A) at (0,1.5) {$L_i F''(X'')$};
			\node[ob] (G1A) at (0,0) {$L_{i-1} F''(X')$};
			\node[ob] (FA) at (3,1.5) {$L_{i-1} F'(X'')$};
			\node[ob] (GA) at (3,0) {$L_{i-2} F'(X')$};
			\scriptsize
			\draw[->] (F1A) -- (G1A) node[pos=0.5, left] {$\partial_{L_\bullet  F''}$};
			\draw[->] (FA) -- (GA) node[pos=0.5, right] {$-\partial_{L_\bullet  F'}$};
			\draw[->] (F1A) -- (FA) node[pos=0.5, above] {$d_\Ff$};
			\draw[->] (G1A) -- (GA) node[pos=0.5, above] {$d_\Ff$};
		\end{diagram*}
		commutes when $0\morphism X'\morphism X\morphism X''\morphism 0$ is a short exact sequence in $\Aa$ (again, note the minus!).
	\end{alphanumerate}
\end{thm}
\begin{proof}
	Dualize the proof of Theorem~\reff{thm:DerivedFunctors} and prove the dual analogues of Fact~\reff{fact:injectiveResolutions} and the Proposition~\reff{prop:Hufeisenlemma} on the way.
\end{proof}
\subsection{Construction of \texorpdfstring{$\Ext_\Aa^\bullet$}{Ext}}\lbl{subsec:ConstructionOfExt}
If the category $\Aa$ has sufficiently many injective objects, then, for fixed objects $X$, one has a right-derived functor $\Ext_\Aa^\bullet(X,-)$ of $\Hom_\Aa(X,-)\colon \Aa\morphism\cat{Ab}$. As $\Hom_\Aa(X,-)$ is functorial in $X$, so are the $\Ext_\Aa^\bullet(X,-)$. For a short exact sequence $0\morphism X''\morphism X\morphism X'\morphism 0$ and $I$ injective, one has a short exact sequence $0\morphism\Hom_\Aa(X',I)\morphism\Hom_\Aa(X,I)\morphism\Hom_\Aa(X'',I)\morphism 0$. One thus has a long exact cohomology sequence
\begin{multline}\lbl{eq:ExtSeq1}
	0\morphism\Ext_\Aa^0(X'',Y)\morphism\Ext_\Aa^0(X,Y)\morphism\Ext_\Aa^0(X',Y)\morphism\Ext_\Aa^1(X'',Y)\morphism\ldots\\
	\ldots\morphism\Ext_\Aa^p(X'',Y)\morphism\Ext_\Aa^p(X,Y)\morphism\Ext_\Aa^p(X',Y)\morphism\Ext_\Aa^{p+1}(X'',Y)\morphism\ldots\tag{$*$}
\end{multline}
for every $Y\in\Ob(\Aa)$ coming from Theorem~\reff{thm:DerivedFunctors}\itememph{c} (somewhere we have to take contravariance into account, i.e., we consider the opposite category somewhere). Moreover, if $0\morphism Y'\morphism Y\morphism Y''\morphism 0$ is  a short exact sequence, we have a long exact sequence
\begin{multline}\lbl{eq:ExtSeq2}
0\morphism\Ext_\Aa^0(X,Y')\morphism\Ext_\Aa^0(X,Y)\morphism\Ext_\Aa^0(X,Y'')\morphism\Ext_\Aa^1(X,Y')\morphism\ldots\\
\ldots\morphism\Ext_\Aa^p(X,Y')\morphism\Ext_\Aa^p(X,Y)\morphism\Ext_\Aa^p(X,Y'')\morphism\Ext_\Aa^{p+1}(X,Y')\morphism\ldots\tag{\#}
\end{multline}
since $\Ext_\Aa^\bullet(X,-)$ is a cohomological functor; and the squares formed by the connecting morphisms of  \eqreff{eq:ExtSeq1} and \eqreff{eq:ExtSeq2} anticommute.

If $P\in\Ob(\Aa)$ is projective, then $\Hom_\Aa(P,-)$ is exact, thus
\begin{align*}
	\Ext_\Aa^p(P,Y)=H^p\big(\Hom_\Aa(P,I^\bullet)\big)=\Hom_\Aa\big(P,H^p(I^\bullet)\big)=0
\end{align*}
for $p>0$ (where $Y\monomorphism I^\bullet$ is any injective resolution). If $\Aa$ also has sufficiently many projective objects, then, for fixed $Y$, the functor $\Ext_\Aa^\bullet(-,Y)\colon \Aa^\op\morphism\cat{Ab}$ annihilates the injective objects of $\Aa^\op$ (the projectives of $\Aa$) in positive degrees, hence is a right-derived functor of $\Hom_\Aa(-,Y)$. Using the right-derived functors of $\Hom_\Aa(-,Y)\colon \Aa ^\op\morphism\cat{Ab}$ one also obtains $\Ext_\Aa^\bullet$ groups with \eqreff{eq:ExtSeq1} as part of the derived functor structure and \eqreff{eq:ExtSeq2} from Theorem~\reff{thm:DerivedFunctors}\itememph{c}; and when $\Aa$ also has sufficiently many injective objects, then, by the previous arguments, the $\Ext_\Aa^\bullet$ groups are canonically isomorphic to the ones obtained using injective resolutions of $Y$. To cut a long story short: For all $p\geq 0$,
\begin{align*}
	\Ext_\Aa^p(X,Y)=H^p\big(\Hom(X,I^\bullet)\big)=H^p\big(\Hom(P_\bullet,Y)\big)
\end{align*}
when $Y\monomorphism I^\bullet$ is an injective resolution of $Y$ and $P_\bullet\epimorphism X$ a projective resolution of $X$.

An alternative construction of $\Ext_\Aa^1(-,-)$ is as follows. Let $\Ext_\Aa^1(X,Y)$ be the ``class of isomorphism classes'' of short exact sequences $\Ee\colon 0\morphism Y\morphism E\morphism X\morphism 0$. Two such extensions $\Ee,\Ee'$ are isomorphic iff there is a commutative diagram 
\begin{diagram*}
	\node[ob] at (-0.75,1.5) {$\Ee\colon$};
	\node[ob] at (-0.75,0) {$\Ee'\colon$};
	\node[ob] (A) at (0,1.5) {$0$};
	\node[ob] (B) at (1.5,1.5) {$Y$};
	\node[ob] (C) at (3,1.5) {$E$};
	\node[ob] (D) at (4.5,1.5) {$X$};
	\node[ob] (E) at (6,1.5) {$0$};
	\node[ob] (A') at (0,0) {$0$};
	\node[ob] (B') at (1.5,0) {$Y$};
	\node[ob] (C') at (3,0) {$E'$};
	\node[ob] (D') at (4.5,0) {$Y$};
	\node[ob] (E') at (6,0) {$0$};
	\scriptsize
	\draw[->] (A) -- (B);
	\draw[->] (B) -- (C);
	\draw[->] (C) -- (D);
	\draw[->] (D) -- (E);
	\draw[->] (A') -- (B');
	\draw[->] (B') -- (C') node[pos=0.5, above] {$\iota$};
	\draw[->] (C') -- (D');
	\draw[->] (D') -- (E');
	\draw[transform canvas={xshift=1pt}] (B) -- (B');
	\draw[transform canvas={xshift=-1pt}] (B) -- (B');
	\draw[->] (C) -- (C');
	\draw[transform canvas={xshift=1pt}] (D) -- (D');
	\draw[transform canvas={xshift=-1pt}] (D) -- (D');
\end{diagram*}
(in which the middle vertical arrow is necessarily an isomorphism, e.g., by the five lemma). 
To such a short exact sequence one may associate $c_\Ee$, the image of $\id_X$ under $\Hom_\Aa(X,X)\morphism\Ext_\Aa^1(X,Y)$, or $_\Ee c$, the image of $\id_Y$ under $\Hom_\Aa(Y,Y)\morphism\Ext_\Aa^1(X,Y)$.
\begin{prop}\lbl{prop:ExtExtends}
	If $\Aa$ has sufficiently many injective or projective objects, then $_\Ee c=c_\Ee$ and one has a bijection between the isomorphism classes of extensions and $\Ext_\Aa^1(X,Y)$.
\end{prop}
\begin{proof}
	\sout{Omitted} Left as an exercise.
\end{proof}
\begin{rem}
	\begin{alphanumerate}
		\item \lbl{rem:YonedaExt}The construction may have set theoretic difficulties, e.g., if $\Aa=\left\{(X,S,f)\right\}$ where $X$ is an abelian group, $S$ a set and $f\colon S\morphism\End(X)$ any function such that two elements in the image of $f$ commute; and $\Hom_\Aa((X,S,f),(Y,T,g))$ are the set of homomorphisms $\xi\colon X\morphism Y$ of abelian groups such that $\xi f(s)=g(s)\xi$ when $s\in S\cap T$, $\xi f(s)=0$ when $s\in S\setminus T$, $g(t)\xi=0$ when $t\in T\setminus S$. Then there is no set of extensions of $(\IZ,\emptyset,\emptyset)$ by itself intersecting all isomorphism classes of such extensions.
		\item The higher order versions of the construction of $\Ext_\Aa^1$ by extensions involves longer exact sequences. This is called \emph{Yoneda}-$\Ext_\Aa^\bullet$ and allows to construct $\Ext_\Aa^\bullet$ groups even when there aren't sufficiently many injective or projective objects.
	\end{alphanumerate}
\end{rem}
\begin{cor}
	If $\Ext_\Aa^1(X,Y)=0$, then every short exact sequence $0\morphism Y\morphism E\morphism X\morphism 0$ splits.
\end{cor}
\begin{proof}
	This follows immediately from Proposition~\reff{prop:ExtExtends}, but it's also easy to prove without. From the long exact cohomology sequence \eqreff{eq:ExtSeq1} we get that
	\begin{align*}
		0\morphism\Hom_\Aa(X,Y)\morphism\Hom_\Aa(E,Y)\morphism\Hom_\Aa(Y,Y)\morphism \Ext_\Aa^1(X,Y)=0
	\end{align*}
	is exact, hence $\Hom_\Aa(E,Y)\morphism\Hom_\Aa(Y,Y)$ is surjective. Choosing a preimage of $\id_Y$ gives a split of the sequence (cf. the proof of Definition~\reff{def:injective}).
\end{proof}
\begin{prop}
	Let $F\colon \Aa\morphism\Bb$ be a left-exact functor between abelian categories where $\Aa$ has sufficiently many injective objects. Let $\XX$ be a class of objects in $\Aa$ with the following properties.
	\begin{alphanumerate}
		\item Let $X\cong Y\oplus Z$, then $X\in\XX$ if and only if $Y,Z\in\XX$.
		\item Every object of $\Aa$ has a monomorphism into some element of $\XX$.
		\item If $0\morphism X\morphism Y\morphism Z\morphism 0$ is exact and $X,Y\in\XX$, then $Z\in\XX$ and $0\morphism FX\morphism FY\morphism FZ\morphism 0$  is exact.
	\end{alphanumerate}
	Then $\XX$ contains all injective objects, and $R^pF(X)=0$ when $X\in\XX$.
\end{prop}
\begin{proof}
	When $I$ is injective, there is a monomorphism $I\monomorphism X$ with $X\in \XX$. By injectivity of $I$, $\id_I$ extends to a projection $X\morphism[\pi]I$ yielding an isomorphism $X\cong I\oplus\ker(\pi)$. Then $I\in\XX$ by condition \itememph{a}.
	
	If $X\in\XX$ and $X\monomorphism I^\bullet$ is an injective resolution of $X$, let $B^p=\ker\left(I^p\morphism I^{p+1}\right)$ (thus $B^0\cong X$ and $B^{p+1}\cong \Im\left(I^p\morphism I^{p+1}\right)$ for $p\geq 0$). Applying \itememph{c} to the short exact sequence $0\morphism B^p\morphism I^p\morphism B^{p+1}\morphism 0$ inductively shows $B^p\in \XX$ and gives short exact sequences $0\morphism FB^p\morphism FI^p\morphism FB^{p+1}\morphism 0$ which may be spliced together to show exactness of the complex $FX\morphism FI^\bullet$ Then $R^pF(X)=H^p(FI^\bullet)=0$.
\end{proof}

\section{Some notes on additive categories and additive functors}
The following lists and proves some first properties of additive categories and additive functors that Professor Franke assumed known in the lecture without explicitly mentioning them.
\begin{defi}
	\begin{alphanumerate}
		\item \lbl{def:additiveCategory}A \defemph{preadditive} category $\Aa$ is a category in which each $\Hom_\Aa(X,Y)$ for $X,Y\in\Ob(\Aa)$ is given a group structure behaving bilinearly under compositions.
		\item An \defemph{additive category} is a preadditive category which has finite products and coproducts such that the canonical morphism $\coprod_{k=1}^nX_k\morphism[c] \prod_{k=1}^{n}X_k$ is an isomorphism for all objects $X_1,\ldots,X_n\in\Ob(\Aa)$.
	\end{alphanumerate}
\end{defi}
\begin{rem*}
	\begin{alphanumerate}
		\item When $\Aa$ is additive, letting $n=0$ in Definition~\reff{def:additiveCategory}\itememph{b} gives an object $*\in\Ob(\Aa)$ which is both an initial and a final object. For $X,Y\in\Ob(\Aa)$, let the \emph{zero morphism} (which we denote $0$) $X\morphism[0]Y$ be defined by $X\morphism *\morphism Y$.
		\item We will construct the canonical morphism $\coprod_{k=1}^nX_k\morphism[c] \prod_{k=1}^{n}X_k$ from Definition~\reff{def:additiveCategory}\itememph{b}. Let $X_k\morphism[i_k]\coprod_{k=1}X_k$ and $\prod_{k=1}^nX_k\morphism[p_k]X_k$ be the associated inclusion and projection morphisms.
		
		Using the universal property of $\prod_{k=1}^{n}X_k$, we get unique morphisms $X_j\morphism[\alpha_j]\prod_{k=1}^{n}X_k$ such that $p_k\alpha_j=\id_X$ if $k=j$ and $0$ else. Then 
		\begin{align*}
		c\colon \coprod_{k=1}^nX_k\xrightarrow{\coprod\alpha_k}\prod_{k=1}^{n}X_k
		\end{align*}
		is the morphism we are looking for. It is unique with the property that $p_k c i_j=\id_X$, if $k=j$ and $0$ else.
		\item The isomorphism $c$ is usually suppressed in the notation and one denotes both products and coproducts $\bigoplus_{k=1}^nX_k$.
	\end{alphanumerate}
\end{rem*}
\begin{prop}\lbl{prop:AdditiveStructureUnique}
	Suppose that $\Aa$ is additive. The group structure on $\Hom_\Aa(X,Y)$ for $X,Y\in\Ob(\Aa)$ is automatically abelian and given as follows. For a pair of morphisms $X\doublemorphism[a][b]Y$, their sum $a+b$ is the composition
	\begin{align*}
	X\xrightarrow{\id_X\times\id_X}X\oplus X\xrightarrow{a\amalg b}Y
	\end{align*}
	and $0$ is the neutral element.
\end{prop}
\begin{proof}
	We first show the characterization of the addition in $\Hom_\Aa(X,Y)$. First thing to check is that $0$ is indeed the neutral element. As $*$ is a final object, $\Hom_\Aa(X,*)$ has only one element $\pi$ and is thus the zero group. In particular, $\pi+\pi=\pi$ and if $\iota$ denotes $*\morphism Y$, then $0=\iota\pi=\iota(\pi+\pi)=0+0$, hence $0$ is indeed the neutral element.
	
	Now let $\Delta=\id_X\times \id_X$ be the diagonal and denote $i_1,i_2$ the inclusions of $X$ in $X\oplus X$ and $p_1,p_2$ the projections of $X\oplus X$ to $X$. We show $\Delta=i_1+i_2$. Indeed, we have $p_1(i_1+i_2)=p_1i_1+p_1i_2=\id_X+0=\id_X$ and similarly $p_2(i_1+i_2)j_2=\id_X$, which is exactly how $\Delta$ is characterized. Hence 
	\begin{align*}
		(a\amalg b)\circ \Delta=(a\amalg b)\circ (i_1+i_2)=(a\amalg b)\circ i_1+(a\amalg b)\circ i_2=a+b\;.
	\end{align*}
	
	For commutativity, we need to show $(a\amalg b)\circ\Delta=(b\amalg a)\circ\Delta$. The universal property of coproducts gives a unique $X\oplus X\morphism[\sigma]X\oplus X$ such that
	\begin{diagram*}
		\node (XX2) at (0,0) {$X\oplus X$};
		\node (X1) at (-1,1.25) {$X$};
		\node (X2) at (-1,-1.25) {$X$};
		\node (XX1) at (-2,0) {$X\oplus X$};
		\node (Y) at (2.5,0) {$Y$};
		\scriptsize
		\draw[<-] (XX2) -- (X1) node[pos=0.5, above right] {$i_1$};
		\draw[<-] (XX2) -- (X2) node[pos=0.5, below right] {$i_2$};
		\draw[->] (XX2) -- (Y) node[pos = 0.5, above] {$a\amalg b$};
		\draw[<-, bend right] (Y) to node[pos=0.5,below left] {$a$} (X1);
		\draw[<-, bend left] (Y) to node[pos=0.5,above left] {$b$} (X2);
		\draw[<-] (XX1) -- (X1) node[pos=0.5, above left] {$i_2$};
		\draw[<-] (XX1) -- (X2) node[pos=0.5, below left] {$i_1$};
		\draw[->, dashed] (XX1) -- (XX2) node[pos=0.5, above] {$\exists!\ \sigma$};
	\end{diagram*}
	commutes. Then $\sigma$ is easily seen to be an isomorphism and $b\amalg a=(a\amalg b)\circ \sigma$ by the uniqueness of $b\amalg a$. It thus suffices to show $\sigma\Delta=\Delta$. By the uniqueness of $\Delta$, this is equivalent to $p_1\sigma\Delta=\id_X$ and $p_2\sigma\Delta=\id_X$. We claim that $p_1\sigma=p_2$ and vice versa, which would finish the proof. To see this, note that $p_1\sigma=p_2$ is equivalent to $p_1\sigma i_1=p_2i_1=0$ and $p_1\sigma i_2=p_2i_2=\id_X$ by the universal property of the coproduct $X\oplus X$. This follows from $\sigma i_1=i_2$ and $\sigma i_2=i_1$ by definition of $\sigma$.
\end{proof}
\begin{defi}\lbl{def:additiveFunctor}
	A functor between preadditive categories (cf. \cite[Definition~A.1.1\itememph{b}]{alggeo2}) is \defemph{additive} if it preserves finite biproducts together with the canonical inclusion and projection morphism to and from them.
\end{defi}
\begin{rem*}
	Definition~\reff{def:additiveFunctor} seems kind of counterintuitive, as one would rather expect an additive functor to induce group homomorphisms on $\Hom$ sets. For additive categories, this alternative definition turns out to be equivalent.
\end{rem*}
\begin{prop}
	Let $F\colon \Aa\morphism\Bb$ be a functor between additive categories. Then $F$ is additive iff $F$ induces a group homomorphism $\Hom_\Aa(X,Y)\morphism[F]\Hom_\Bb(FX,FY)$ for every $X,Y\in\Ob(\Aa)$.
\end{prop}
\begin{proof}
	If $F$ is an additive functor, i.e., preserves finite biproducts and the associated structure morphisms, then it is clear that $F$ is compatible with the addition as in constructed Proposition~\reff{prop:AdditiveStructureUnique}.
	
	Conversely, suppose that $F$ is compatible with the addition. Let $X,Y\in\Ob(\Aa)$. Let $i_X,i_Y$ be the inclusions of $X,Y$ in $X\oplus Y$ and $p_X,p_Y$ the projections of $X\oplus Y$ onto $X,Y$. Define $j_X,j_Y$ and $q_X,q_Y$ analogously for $FX\oplus FY$. By the two universal properties of the biproduct $FX\oplus FY$ we get morphisms $F(X\oplus Y)\morphism[q]FX\oplus FY$ and $FX\oplus FY\morphism[j]F(X\oplus Y)$ such that 
	\begin{center}
		\begin{minipage}{0.4\textwidth}
			\centering				
			\begin{diagram*}
				\node (XY) at (0,0) {$FX\oplus FY$};
				\node (X) at (1,1.25) {$FX$};
				\node (Y) at (1,-1.25) {$FY$};
				\node (T) at (-3,0) {$F(X\oplus Y)$};
				\scriptsize
				\draw[->] (XY) -- (X) node[pos=0.5, above left] {$q_X$};
				\draw[->] (XY) -- (Y) node[pos=0.5, below left] {$q_Y$};
				\draw[->, dashed] (T) -- (XY) node[pos = 0.5, above] {$\exists!\ q$};
				\draw[->, bend left] (T) to node[pos=0.5,below right] {$F(p_X)$} (X);
				\draw[->, bend right] (T) to node[pos=0.5,above right] {$F(p_Y)$} (Y);
			\end{diagram*}
		\end{minipage}and
		\begin{minipage}{0.4\textwidth}
			\centering				
			\begin{diagram*}
				\node (XY) at (0,0) {$FX\oplus FY$};
				\node (X) at (-1,1.25) {$FX$};
				\node (Y) at (-1,-1.25) {$FY$};
				\node (T) at (3,0) {$F(X\oplus Y)$};
				\scriptsize
				\draw[<-] (XY) -- (X) node[pos=0.5, above right] {$j_X$};
				\draw[<-] (XY) -- (Y) node[pos=0.5, below right] {$j_Y$};
				\draw[->, dashed] (XY) -- (T) node[pos = 0.5, above] {$\exists!\ j$};
				\draw[<-, bend right] (T) to node[pos=0.5,below left] {$F(i_X)$} (X);
				\draw[<-, bend left] (T) to node[pos=0.5,above left] {$F(i_Y)$} (Y);
			\end{diagram*}
		\end{minipage}
	\end{center}
	are commutative diagrams.
	
	Then $qj=\id_{FX\oplus FY}$ holds since $q_X(qj)i_X=F(p_X)F(i_X)=F(\id_X)=\id_{FX}$ and $q_Y(qj)i_X=F(p_Y)F(i_X)=F(0)=0$ and similar conditions hold when $X$ and $Y$ switch roles, which precisely characterize $\id_{FX\oplus FY}$. To show $jq=\id_{F(X\oplus Y)}$, write $\id_{FX\oplus FX}=j_Xq_X+j_Yq_Y$ to get
	\begin{align*}
		jq=j(j_Xq_X+j_Yq_Y) q=F(i_X)F(p_X)+F(i_Y)F(p_Y)
		=F(i_Xp_X+i_Yp_Y)
	\end{align*}
	using that $F$ is a group homomorphism. Now $i_Xp_X+i_Yp_Y=\id_{X\oplus Y}$, so we can further deduce $jq=F(\id_{X\oplus Y})=\id_{F(X\oplus Y)}$. This shows that $j$ and $q$ are inverse to each other, hence $F(X\oplus Y)\cong FX\oplus FY$ and this is compatible with the structure morphisms.
\end{proof}
\begin{defi}\lbl{def:leftrightexact}
	A functor is called \defemph{left-exact} if it preserves finite limits, and \defemph{right-exact} if it preserves finite colimits.
\end{defi}
\begin{rem}\lbl{rem:left-exactAdditive}
	Again, this is not quite what one would expect, and again, it turns out to be essentially equivalent to the expected definition under the right circumstances. A left-exact functor in the sense of Definition~\reff{def:leftrightexact} between abelian categories preserves, in particular, kernels, and thus short left-exact sequences. Also, it preserves finite products and their projection morphisms (as certain limits) and hence direct sums, i.e., is additive (one easily checks that the inclusion morphisms are then preserved as well). Conversely, an additive functor between abelian categories that preserves kernels is already left-exact, since every finite limit can be built from finite products and equalizers (which we have, since there are kernels).
\end{rem}
\begin{prop}\lbl{prop:injectiveSeqsStayExact}
	If $F\colon \Aa\morphism\Bb$ is a left-exact functor between abelian categories $\Aa,\Bb$ and $0\morphism I\morphism X\morphism X''\morphism 0$ a short exact sequence in $\Aa$ with $I$ an injective object of $\Aa$, then $0\morphism FI\morphism FX\morphism FX''\morphism 0$ is a short exact sequence in $\Bb$.
\end{prop}
\begin{proof}
	Since $I$ is injective, the sequence $0\morphism I\morphism X\morphism X''\morphism 0$ splits due to Definition~\reff{def:injective}\itememph{b}, i.e., $X\cong I\oplus X''$. Since $F$ is additive, $FX\cong FI\oplus FX''$, and $FI\morphism FX$ and $FX\morphism FX''$ correspond to the inclusion of $FI$ respectively projection onto $FX''$.
\end{proof}
\section{Associated primes}\lbl{sec:AssociatedPrimes}
Professor Franke recalled some facts about associated primes which he considered well-known at this level. However, I somehow managed to dodge every associated prime thrown at me till now, so I will include this here. Also, the proofs are my own so this might not be the most elegant presentation.
\begin{defi}
	Let $R$ be a ring and $M$ an $R$-module. The set of \defemph{associated primes} of $M$ is defined as
	\begin{align*}
		\Ass_R(M)=\left\{\pp\in\Spec R\st\text{there is an }m\in M\text{ such that }\pp=\Ann_R(m)\right\}\;.
	\end{align*}
\end{defi}
\begin{example}\lbl{ex:AssR/p}
	When $\pp\in\Spec R$, we have $\Ass_R(R/\pp)=\left\{\pp\right\}$. Indeed, since $R/\pp$ is a domain, every element of $R$ annullating it must be in $\pp$.
\end{example}
\begin{prop}\lbl{prop:AssExactSeqs}
	If $0\morphism M'\morphism M\morphism M''\morphism 0$ is an exact sequence, then
	\begin{align*}
		\Ass_R(M')\subseteq \Ass_R(M)\subseteq \Ass_R(M')\cup\Ass_R(M'')\;.
	\end{align*}
\end{prop}
\begin{proof}
	The first inclusion is obvious. For the second, let $\pp\in\Ass_R(M)$ and $m\in M$ such that $\pp=\Ann_R(m)$. Then $1\mapsto m$ gives an embedding of $R/\pp$ into $M$. Let $R/\pp\cong P\subseteq M$ be its image. If $P\cap M'=0$, then $P\cong (P+M')/M'\subseteq M/M'\cong M''$ shows that $M''$ has a submodule isomorphic to $R/\pp$ as well, hence $\pp\in\Ass_R(M'')$ by Example~\reff{ex:AssR/p}. If $P\cap M'\neq 0$, take a non-zero element $p$ in their intersection. By Example~\reff{ex:AssR/p}, $\Ann_R(p)=\pp$, hence $\pp\in\Ass_R(M')$.
\end{proof}
\begin{cor}\lbl{cor:AssFinite}
	When $R$ is Noetherian and $M$ is finitely generated, $\Ass_R(M)$ is a finite set, and non-empty unless $M=0$.
\end{cor}
\begin{proof}
	Apply Proposition~\reff{prop:AssExactSeqs} and Example~\reff{ex:AssR/p} to a filtration $0=M_0\subseteq\ldots\subseteq M_k=M$ such that $M_i/M_{i-1}\cong R/\pp_i$ for some $\pp_i\in\Spec R$ (which exists by \cite[Proposition~3.1.2]{alg2}). This pretty much shows both assertions.
\end{proof}
Now we prove that taking associated prime ideals commutes with localizations -- in the following sense. 
\begin{prop}\lbl{prop:AssLocalization}
	Let $R$ be a Noetherian ring and $M$ an arbitrary $R$-module. If $S\subseteq R$ is a multiplicative subset, then
	\begin{align*}
		\Ass_{R_S}(M_S)=\left\{\pp R_S\st \pp\in\Ass_R(M)\text{ and }\pp\cap S=\emptyset\right\}\;.
	\end{align*}
\end{prop}
\begin{proof}
	We will simply check the assertion in a straightforward way. First let $\pp\in\Ass_R(M)$ such that $\pp\cap S=\emptyset$. Choose $m\in M$ such that $\pp=\Ann_R(m)$. Then $\pp R_S$ clearly annullates $m$ over $R_S$. Conversely, if $\frac{r}{s}\cdot m=0$ in $M_S$, then there is a $t\in S$ such that $trm=0$ in $M$. Hence $tr\in\pp$ and thus $\frac{r}{s}\in\pp R_S$. This proves $\Ass_{R_S}(m)=\pp R_S$, hence $\pp R_S\in\Ass_{R_S}(M_S)$.
	
	Now let $\qq\in\Spec R_S$ be an associated prime ideal of $M_S$. Then $\qq=\pp R_S$ for some prime ideal $\pp\in\Spec R$, $\pp\cap S=\emptyset$ (cf.\ \cite[Corollary~2.3.1\itememph{e}]{alg1}) and there is an element $\mu=\frac{m}{s}\in M_S$ such that $\qq=\Ann_{R_S}(\mu)$. Our goal is to modify $m$ such that $\Ann_R(m)=\pp$. Clearly, $\Ann_R(M)\subseteq \qq\cap R=\pp$. Moreover, since every element of $\pp$ anullates $m$ in $M_S$ we see that for every $p\in\pp$ there is a $t\in S$ such that $tp\in\Ann_R(m)$. Choose generators $p_1,\ldots,p_n$ of $\pp$ and such $t_1,\ldots,t_n$. Replacing $m$ by $t_1\cdots t_nm$ doesn't change $\Ann_{R_S}(m)$, as the $t_i$ are units in $R_S$, but gives $p_1,\ldots,p_n\in\Ann_R(m)$, hence $\pp=\Ann_R(m)$.
\end{proof}
\begin{prop}\lbl{prop:AssProperties}
	Let $R$ be a Noetherian and $M$ any $R$-module.
	\begin{alphanumerate}
		\item We have
		\begin{align*}
			\left\{r\in R\st M\morphism[r\cdot ]M\text{ is injective}\right\}=R\setminus\bigcup_{\pp\in \Ass_R(M)}\pp\;.
		\end{align*}
		\item If $M$ is in addition finitely generated, then every prime ideal which is minimal over $\Ann_R(M)$ is an associated prime ideal of $M$.
	\end{alphanumerate}
\end{prop}
\begin{proof}
	Part \itememph{a}. Clearly, every element $r\in \bigcup_{\pp\in \Ass_R(M)}\pp$ annullates some element of $M$. Conversely, assume that $M\morphism[\smash{r\cdot}]M$ is not injective for some $r\in R$. Consider the set
	\begin{align*}
		\MM=\left\{\Ann_R(m)\st m\in M\text{ satisfies }rm=0\right\}\;.
	\end{align*}
	of ideals of $R$. Since $R$ is Noetherian and $\MM$ is non-empty by assumption, $\MM$ has a maximal element $\Ann_R(\mu)$ for some $\mu\in M\setminus\{0\}$ satisfying $r\mu=0$. We claim that $\Ann_R(\mu)$ is prime. Indeed, let $a,b\in R$ such that $ab\in \Ann_R(\mu)$. If neither $a$ nor $b$ are in $\Ann_R(\mu)$, we find that $\Ann_R(a\mu)\in\MM$ (since $a\mu\neq 0$) and $\Ann_R(m)$ is properly contained in $\Ann_R(a\mu)$ (since $b\notin\Ann_R(m)$), contradiction.
	
	Part \itememph{b}. Let $\pp\in\Spec R$ be minimal above $\Ann_R(M)$. By \cite[Lemma~3.4.1]{alg2}, $\pp\in\supp(M)$, i.e., $M_\pp\neq 0$. Hence $\Ass_{R_\pp}(M_\pp)\neq\emptyset$ by Corollary~\reff{cor:AssFinite}. Clearly, every $\qq\in\Ass_R(M)$ contains $\Ann_R(M)$, and since $\pp$ is minimal above $\Ann_R(M)$, Proposition~\reff{prop:AssLocalization} shows that no prime ideal of $R_\pp$ except $\pp R_\pp$ can be contained in $\Ass_{R_\pp}(M_\pp)$. Therefore, $\Ass_{R_\pp}(M_\pp)=\{\pp R_\pp\}$, hence $\pp\in\Ass_R(M)$ by Proposition~\reff{prop:AssLocalization} again.
\end{proof}
\begin{fact}\lbl{fact:dimsuppM}
	Let $R$ be a Noetherian ring (not necessarily local) and $M$ a finitely generated $R$-module. Then the irreducible components of $\supp M=\left\{\pp\in\Spec R\st M_\pp\neq 0\right\}$ are precisely given by the \defemph{non-embedded} primes of $M$ (i.e., the associated primes not containing any other associated prime).
\end{fact}
\begin{proof}
	By Corollary~\reff{cor:AssFinite}, $M_\pp\neq 0$ iff $\Ass_{R_\pp}(M_\pp)\neq\emptyset$. By Proposition~\reff{prop:AssLocalization}, this is the case iff there is an associated prime $\qq\in \Ass_R(M)$ such that $\qq R_\pp$ is a prime ideal of $R_\pp$, i.e., $\pp\supseteq \qq$. Thus
	\begin{align*}
		\supp M=\bigcup_{\qq\in\Ass_R(M)}V(\qq)\;.
	\end{align*}
	In particular, $\supp M$ is closed since $\Ass_R(M)$ is finite. Thus all irreducible components of $\supp M$(which must be closed)  have the form $V(\pp)$ for some prime ideal $\pp\in\Spec R$. Then $\pp\in\supp M$, hence $V(\pp)\subseteq V(\qq)$ for some non-embedded prime of $M$. This shows that the $V(\qq)$ with $\qq$ running over the non-embedded primes are indeed the maximal irreducible subsets of $\supp M$, hence the irreducible components.
\end{proof}


\printbibliography

\end{document}          
